define("common:widget/ui/MapTest/MapTest.js",function(t,a,o){function n(){T.ajax("/wolfman/static/common/images/transparent.gif?t="+Math.floor(1e6*Math.random()),{success:function(t,a){a.slow?ErrorMonitor("web","req_slow"+a.slow,"",!0,{xhr:a,type:"slow",url:"/wolfman/static/common/images/transparent.gif"}):ErrorMonitor("web","succ","",!0,{xhr:a,type:"succ",url:"/wolfman/static/common/images/transparent.gif"})},error:function(t){ErrorMonitor("web","req_fail",t.status,!0,{xhr:t,type:"fail",url:"/wolfman/static/common/images/transparent.gif"})}})}function r(){var t=new Image,a=(new Date).getTime(),o={timeStart:a};t.onerror=function(){o.timeEnd=(new Date).getTime(),ErrorMonitor("cdn","req_fail","",!0,{url:"http://webmap1.map.bdstatic.com/wolfman/static/common/images/transparent_cdn_3254726.gif",type:"fail",xhr:o})},t.onload=function(){o.timeEnd=(new Date).getTime();var t=o.timeEnd-a,n=!1;t>6e3?n=6:t>3e3?n=3:t>2e3&&(n=2),n?ErrorMonitor("cdn","req_slow"+n,"",!0,{url:"http://webmap1.map.bdstatic.com/wolfman/static/common/images/transparent_cdn_3254726.gif",type:"slow",xhr:o}):ErrorMonitor("cdn","succ","",!0,{url:"http://webmap1.map.bdstatic.com/wolfman/static/common/images/transparent_cdn_3254726.gif",type:"succ",xhr:o})},t.src="http://webmap1.map.bdstatic.com/wolfman/static/common/images/transparent_cdn_3254726.gif?t="+Math.floor(1e6*Math.random())}o.exports={testCDN:r,testWeb:n}});
;define("common:widget/ui/loadCtrls/LoadCtrls.js",function(o,n,t){function e(){}function i(){try{w.pvstat();var n=Math.random();.2>n?v.testWeb():.4>n&&v.testCDN(),ErrorMonitor("load","BASE","");var t=window._OLR&&baidu.json.parse(window._OLR.index);t&&t.content&&1==t.content.code?ErrorMonitor("load","loccity_fail","",void 0,{url:"",xhr:{startTime:0,endTime:0},type:"fail"}):ErrorMonitor("load","succ","",void 0,{url:"",xhr:{startTime:0,endTime:0},type:"succ"})}catch(e){console.log("init stat fail")}map.addEventListener("movestart",function(){window.firstbounds=u.formatBounds()}),map.addEventListener("moveend",function(){window.lastbounds=u.formatBounds(),window.useraction="move"}),map.addEventListener("zoomstart",function(){window.firstbounds=u.formatBounds()}),map.addEventListener("zoomend",function(){window.lastbounds=u.formatBounds(),window.useraction="zoom"}),map.addEventListener("clickex",function(o){o.overlay&&o.overlay instanceof BMap.Circle&&this.getInfoWindow()&&this.closeInfoWindow()}),map.addEventListener("click",function(){T(".search_box input").blur()}),o.async("common:widget/ui/changeMap/ChangeMap.js",function(o){o(map)})}function a(){var o=baidu.url.queryToJson(location.href);o&&o.hb&&o.hb==BMAP_TYPE_HYBIRD&&o.tn&&o.tn==BMAP_SATELLITE_MAP&&map.showStreetLayer(!0),f.processUrlQuery(),f.handleUrlExt()}function c(){}function r(){g.init(),baidu("#imgLogo").on("click",function(o){b.setQuery(),T("#clearMapArea").css("display","none"),m.go("cur&wd="+encodeURIComponent(h.cityName),{cinfo:{from:"home_btn"}}),window.poi2RouteSearchName=void 0,o.preventDefault()});var n=window.isSupportHttps=!!navigator.userAgent.match(/chrome|firefox|safari|msie 10|rsv:11|msie [89]/gi);n&&T(".logo_nav .nav a").eq(1).mouseover(function(){var o=new Image;o.onload=o.onerror=o.onabort=function(){o=null},o.src=" https://www.baidu.com/con?from=pcmap"}).attr("href","https://www.baidu.com"),baidu(".logo_nav .nav a").bind("click",function(){var o=parseInt(baidu(this).data("index"));addStat("indexheader.nav."+o,"click",{da_e_name:"pcmap3"},!0),l.switchUrl(this,o)}),baidu(".search_box a.mo_dl").on("click",function(n){o.async("common:widget/ui/Pc2Mobile/Pc2Mobile.js",function(o){o.open("IMG","搜索框链接")}),n.preventDefault()}),T("#user_info").delegate("[data-stat-code]","click",function(){var o="index"===T(this).attr("data-stat-code")?!0:!1;addStat("indexheader.nav."+T(this).attr("data-stat-code"),"click",{da_e_name:"pcmap3"},o)}),T("#searchWrapper").on("click",".return-old-link",function(){T.cookie.set("force","oldsample",{expires:6048e5}),addStat("indexheader.searchbox.returnold","click",{da_e_name:"pcmap3"}),location.href="/"})}function d(){T.browser.isWebkit&&console.log("%c        %c\n如果你勤于关注LBS的发展，乐于关注定位技术，善于思考身边本地生活信息与技术融合的未来；\n  那么百度LBS研发部热忱欢迎你加入我们，共同探索LBS的技术、产品与商业模式的创新；一起定位百度地图与你我的未来。\n  期待您的加盟。http://map.baidu.com/zt/hr/20131122/\n  %c邮件请注明来自：console","background:url(http://map.baidu.com/zt/hr/logo-map-console.png) no-repeat;font-size:33px","background:none","color:red")}function s(){o.async("common:widget/ui/Pc2Mobile/Pc2Mobile.js",function(){}),o.async("common:widget/ui/MapCenter/MapCenter.js",function(o){o.init()}),o.async("common:widget/ui/clickcity/ClickCity.js",function(o){window.MPC_Mgr=o}),o.async("common:widget/ui/contextMenu/ContextMenu.js",function(o){window.contextMenu=o.init()}),componentManager.loadPlaceAsync()}var m=o("common:widget/com/componentManager.js"),u=(o("common:widget/ui/areaCfg/areaCfg.js"),o("common:widget/ui/util/util.js")),l=o("common:widget/ui/indexUtil/IndexUtil.js"),f=o("common:widget/ui/urlQueryProcessor/UrlQueryProcessor.js"),p=o("common:widget/ui/config/config.js"),w=(o("common:widget/ui/constant/Constant.js"),o("common:widget/ui/stat/CodeStat.js")),g=o("common:widget/ui/mapInfo/mapInfo.js"),h=p.modelConfig,v=o("common:widget/ui/MapTest/MapTest.js"),b=o("common:widget/ui/ui3SearchBox/ui3SearchBox.js");t.exports={init:function(){e(),i(),s(),a(),r(),c(),d(),document.fmHistory&&(document.fmHistory.action="/wolfman/static/common/newhistory_e7da5f4.html")}}});
;define("common:widget/ui/dataCopyRight/dataCopyRight.js",function(a,t){{var p=a("common:widget/ui/areaCfg/areaCfg.js"),n=a("common:widget/ui/config/config.js"),o=n.modelConfig;n.mapConfig}t.setCopyRight=function(){if(!window.isPrint){var a,t=o.cityCode,n=map.mapType,e=[p["常州"],p["南昌"],p["乌鲁木齐"],p["无锡"],p["福州"],p["泉州"],p["珠海"],p["贵阳"]],i=[p["北京"],p["上海"],p["广州"],p["深圳"],p["宁波"],p["石家庄"],p["沈阳"],p["长春"],p["青岛"],p["温州"],p["台州"],p["金华"],p["佛山"],p["中山"],p["昆明"],p["南宁"],p["苏州"],p["西安"],p["济南"],p["郑州"],p["合肥"],p["呼和浩特"],p["杭州"],p["成都"],p["武汉"],p["长沙"],p["天津"],p["南京"],p["重庆"],p["大连"],p["东莞"],p["厦门"]],r=[p["香港特别行政区"]],w=T.array.indexOf(e,""+t)>-1,m=T.array.indexOf(i,""+t)>-1,h=T.array.indexOf(r,""+t)>-1,c=t>=9e3&&9378>=t;if(a=c?["&copy; #{0} Baidu - GS(2014)6081号&nbsp;- Data &copy; "]:["&copy; #{0} Baidu - GS(2012)6003号&nbsp;- Data &copy; "],n===BMAP_SATELLITE_MAP||n===BMAP_EARTH_MAP?(a.push('<a target="_blank" href="http://www.navinfo.com/">NavInfo</a>'),w&&a.push(' &amp; <a target="_blank" href="http://www.palmcity.cn/palmcity/">PalmCity</a>'),m&&a.push(' &amp; <a target="_blank" href="http://www.cennavi.com.cn/">CenNavi</a>'),h&&a.push(' &amp; <a target="_blank" href="http://www.mapking.com/HongKong/eng/home/MapKing_Webmap.html">MapKing</a>'),c&&(a.push(' &amp; <a target="_blank" href="http://corporate.navteq.com/supplier_terms.html">HERE</a>'),a.push(' &amp; <a target="_blank" href="http://www.localking.com.tw/about/localking.aspx">樂客LocalKing</a>')),a.push('&nbsp;,&nbsp;Image &copy; GF-1 &amp; <a target="_blank" href="http://www.chinasiwei.com/">Chinasiwei</a>'),n===BMAP_EARTH_MAP&&a.push(' &amp; <a target="_blank" href="http://www.eso.org/public/">ESO</a>')):(a.push('<a target="_blank" href="http://www.navinfo.com/">NavInfo</a>'),w&&a.push(' &amp; <a target="_blank" href="http://www.palmcity.cn/palmcity/">PalmCity</a>'),m&&a.push(' &amp; <a target="_blank" href="http://www.cennavi.com.cn/">CenNavi</a>'),h&&a.push(' &amp; <a target="_blank" href="http://www.mapking.com/HongKong/eng/home/MapKing_Webmap.html">MapKing</a>'),c&&(a.push(' &amp; <a target="_blank" href="http://corporate.navteq.com/supplier_terms.html">HERE</a>'),a.push(' &amp; <a target="_blank" href="http://www.localking.com.tw/about/localking.aspx">樂客LocalKing</a>'))),!window.copyCtrl){window.copyCtrl=new BMap.CopyrightControl,map.addControl(window.copyCtrl);var n=map.getMapType();n===BMAP_SATELLITE_MAP||n===BMAP_EARTH_MAP?window.copyCtrl&&window.copyCtrl.addSateMapStyle():n===BMAP_NORMAL_MAP&&window.copyCtrl&&window.copyCtrl.removeSateMapStyle()}var l=(new Date).getFullYear();window.copyCtrl.addCopyright({content:baidu.string.format(a.join(""),[l]),id:1})}}});
;define("common:widget/ui/urlQueryProcessor/UrlQueryProcessor.js",function(n,o,e){function t(n){if(!n.data||!n.data[0].result){var o=a.getParam(location.href),e=o.latlng.split(",")[1],t=o.latlng.split(",")[0],c=BMap.Project.convertLL2MC(new BMap.Point(e,t)),d=new BMap.Marker(c);map.addOverlay(d),map.centerAndZoom(c,17),o.autoOpen&&"true"==o.autoOpen&&i(d,c),d.addEventListener("click",function(){r.iw&&r.iw.isOpen()||i(d,c)})}}function i(o,e){n.async("common:widget/ui/searchInfoWindow/searchInfoWindow.js",function(n){r.iw=n.createSearchInfoWnd({title:T.encodeHTML(t.tit),mingpian:T.encodeHTML(t.content)},{cityCode:s.cityCode,x:e.lng,y:e.lat}),n.openSearchInfoWndPOI(r.iw,o)})}function r(){var n=a.getParam(location.href),o=n&&n.title||"",e=n&&n.content||"";n&&n.latlng&&(o||""==o)&&(e||""==e)&&(t.tit=a.filtQuery(decodeURIComponent(o)),t.content=a.filtQuery(decodeURIComponent(e)),c({confilterWords:[t.tit+t.content]}))}function c(n){for(var o=n.confilterWords,e=(n.callback,"http://map.baidu.com/maps/transformers/confilter?"),i=[],r=0;r<o.length;r++)i.push("q[]="+encodeURIComponent(o[r]));baidu.jsonp(e+"&"+i.join("&"),function(n){t(n)},{cbtype:"cb"})}var a=n("common:widget/ui/util/util.js"),d=n("common:widget/com/componentManager.js"),l=n("common:widget/ui/config/config.js"),s=l.modelConfig,f=(l.mapConfig,{processUrlQuery:function(){var n=window.location.search?window.location.search.substr(1):"";if(n){for(var o=n.split("&"),e={},t=0,i=o.length;i>t;t++){var r=o[t].split("=");try{e[r[0]]=decodeURIComponent(r[1])}catch(c){continue}}var l=e.saddr||e.daddr,f=a.filtQuery(e.saddr)||a.filtQuery(e.daddr);if(l)if(f){var u=e.ccode||s.cityCode;if(a.filtQuery(e.saddr)&&a.filtQuery(e.daddr)){var m="t"==e.dirflag?"bs":"nav",p=encodeURIComponent("2$$$$$$"+e.saddr+"$$0$$$$"),$=encodeURIComponent("2$$$$$$"+e.daddr+"$$0$$$$");d.go("bs"==m?"bt&c="+u+"&sn="+p+"&en="+$:"nav&c="+u+"&sc="+u+"&ec="+u+"&sn="+p+"&en="+$+"&version=4&mrs=1&route_traffic=1")}else d.go("s&wd="+encodeURIComponent(f)+"&c="+u,{onload:function(){}})}else{"d"==e.dirflag?3:2}}},handleUrlExt:r});e.exports=f});
;define("common:widget/ui/changeMap/ChangeMap.js",function(e,a,t){function n(e){e.addEventListener("beforesetmaptype",function(){e.closeInfoWindow()});e.addEventListener("maptypechange",function(e){var a=e.mapType;if(i.setDataCopyRight(),a===BMAP_SATELLITE_MAP||a===BMAP_EARTH_MAP?(window.copyCtrl&&window.copyCtrl.addSateMapStyle(),window.scaleCtrl&&window.scaleCtrl.addSateMapStyle()):a===BMAP_NORMAL_MAP&&(window.copyCtrl&&window.copyCtrl.removeSateMapStyle(),window.scaleCtrl&&window.scaleCtrl.removeSateMapStyle()),"B_NORMAL_MAP"===a)addStat("basemap.maptypechange.normalmap");else if("B_SATELLITE_MAP"===a)addStat("basemap.maptypechange.satellitetype");else if("B_EARTH_MAP"===a){var t={};t.da_e_name="pcmapearth",addStat("basemap.maptypechange.earthtype","show",t)}})}{var o=e("common:widget/ui/config/config.js"),i=e("common:widget/ui/indexUtil/IndexUtil.js");o.modelConfig,o.mapConfig}t.exports=n});
;define("common:widget/ui/MapCenter/MapCenter.js",function(t,e,n){function i(){T.lang.Class.call(this),this._map=map,this.startPoint=map.getCenter(),this.unit=1e4,this.url=m.MAP_CENTER_URL+"?newmap=1&qt=cen",this._cbks=[],this.aqiEl=baidu("#weather_menu span.aqi-text")}function a(){var t=map.getBounds(),e=function(t){return 1e3*parseInt(t/1e3)};return e(t.minX)+","+e(t.minY)+";"+e(t.maxX)+","+e(t.maxY)}var s=t("common:widget/ui/config/config.js"),o=t("common:widget/ui/Traffic/Traffic.js"),c=t("common:widget/ui/Weather/Weather.js"),r=t("common:widget/ui/indexUtil/IndexUtil.js"),u=t("common:widget/ui/AQIMgr/AQIMgr.js"),l=s.modelConfig,m=(s.mapConfig,s.urlConfig);T.extend(i.prototype,{init:function(){var t=this,e=map;l.enableMapMove=!0,e.addEventListener("load",function(e){t.request(e),o.setHighLevel()}),e.addEventListener("moveend",function(e){t.request(e)}),e.addEventListener("centerandzoom",function(e){t.request(e)}),e.addEventListener("zoomend",function(e){t.request(e),o.setHighLevel()}),map.getMapType()===BMAP_EARTH_MAP&&t.request()},request:function(){if(c.active||l.enableMapMove!==!1){var t=map.getZoom(),e=window.currentComponent;if((!e||"AQIMap"!=e._className)&&4>=t)return window.temp.map_level=t,r.setCurCity({name:"全国",code:"1",type:0}),void this.aqiEl.html("");var n=map.getCenter(),i=this.startPoint,s=Math.sqrt((i.lng-n.lng)*(i.lng-n.lng)+(i.lat-n.lat)*(i.lat-n.lat)),o=this;if(s>this.unit||window.temp.map_level!=t||c.active){window.temp.map_level=t,this.startPoint=n;var m=this.url+"&b="+a()+"&l="+t;m+=u.isActive()?"&dtype=2":"&dtype=1",baidu.jsonp(m,function(t){t&&t.content&&o.curCity(t)})}}},curCity:function(t){if(t&&(c.add(t.weather),u.set(t.aqi,t.current_city,"mapcenter")),0!=l.enableMapMove){try{{var e=t,n=e.content,i=e.current_city;i.code,i.type}n.sup=i.sup,r.setCurCity(i,{from:"mapcenter"}),null!=n.sup_bus&&r.setSupBus(n.sup_bus),e.hot_city&&window._OLR&&(window._OLR.hot_city=e.hot_city)}catch(a){}for(var s=0,o=this._cbks.length;o>s;s++)this._cbks[s]&&"function"==typeof this._cbks[s]&&this._cbks[s]()}},addCallback:function(t){this._cbks.push(t)},removeCallback:function(t){for(var e=0,n=this._cbks.length;n>e;e++)this._cbks[e]===t&&(this._cbks.splice(e,1),e--)},clearCallbacks:function(){this._cbks.length=0}}),n.exports=new i});
;define("common:widget/ui/contextMenu/ContextMenu.js",function(e,n,t){function o(e,n){n=n||0,1==l.curSelIndex?m.load("BusTrans",{cinfo:{isPos:!0,destFlag:n,point:e},record:!1,isMainRequest:"no",isFromContextMenu:!0}):2==l.curSelIndex&&m.load("NavTrans",{cinfo:{isPos:!0,destFlag:n,point:e},record:!1,isMainRequest:"no",isFromContextMenu:!0})}function i(e,n){n=n||0,l.curSelIndex=1,m.load("BusTrans",{cinfo:{isPos:!0,destFlag:n,point:e},record:!1,isMainRequest:"no",isFromContextMenu:!0})}function a(e,n){n=n||0,m.load("NavTrans",{cinfo:{isPos:!0,destFlag:n,point:e},record:!1,isMainRequest:"no",isFromContextMenu:!0})}function r(e,n){n=n||0,m.load("NavWalk",{cinfo:{isPos:!0,destFlag:n,point:e},record:!1,isMainRequest:"no",isFromContextMenu:!0})}function d(e,n){n=n||0,m.load("NavBike",{cinfo:{isPos:!0,destFlag:n,point:e},record:!1,isMainRequest:"no",isFromContextMenu:!0})}function s(){function n(e){T(".route-op-banner").remove();var n=T('<div class="route-op-banner"></div>').appendTo("#RouteHeadWrapper"),t=[{bannerWrap:n,opid:"op"+e}];p.initOpBanner(t)}var t=function(e){T("#history_bus_walk").css("display","none"),"RouteAddr"==window.currentComponent._className?o(e):m.loadRoute(function(){1===l.curSelIndex?i(e,0):2===l.curSelIndex?a(e,0):3===l.curSelIndex?r(e,0):d(e,0),n(l.curSelIndex+2)}),addStat("poiinfowin.rightmenu.starthere")},s=function(e){addStat("poiinfowin.rightmenu.passthroughhere"),u.addTPointByPoint(e)},g=function(e){T("#history_bus_walk").css("display","none"),"RouteAddr"==window.currentComponent._className?o(e):m.loadRoute(function(){1===l.curSelIndex?i(e,1):2===l.curSelIndex?a(e,1):3===l.curSelIndex?r(e,1):d(e,1),n(l.curSelIndex+2)}),addStat("poiinfowin.rightmenu.goinghere")},f=function(n){e.async("common:widget/ui/searchInfoWindow/searchInfoWindow.js",function(e){var t=n,o=e.addRangeSearchCenterPoi(t),i=e.createRangeInfoWnd(t);i.addEventListener("close",function(){e.exitRangeSearch(),i.overlay&&i.overlay.remove()}),i.addEventListener("open",function(){window.GRControll&&window.GRControll.setGRequestFlg(1500),map.addEventListener("moveend",function(){setTimeout(function(){if(T.g("rangekw"))try{T.g("rangekw").focus()}catch(e){}},100),map.removeEventListener("moveend",arguments.callee)})}),e.openSearchInfoWnd(i,o,{pano:!0,panoPoint:t})}),addStat("poiinfowin.rightmenu.searchnb")},h=function(e){var n=window.map.mercatorToLnglat(e.lng,e.lat),t={x:e.lng,y:e.lat,lat:n[1],lng:n[0]};window.open("http://tousu.baidu.com/map/add?new_poi=1&"+baidu.url.jsonToQuery(t,encodeURIComponent))},w=function(e){map.zoomIn(e),addStat("poiinfowin.rightmenu.zoomin")},I=function(e){map.zoomOut(e),addStat("poiinfowin.rightmenu.zoomout")},x=function(e){map.panTo(e),addStat("poiinfowin.rightmenu.centrehere")},v=c([{text:"<span id='cmitem_start'> 以此为起点</span>",callback:t,width:90},{text:"<span id='cmitem_pass'> 以此为途经点</span>",callback:s,width:90},{text:"<span id='cmitem_end'> 以此为终点</span>",callback:g,width:90},{separator:!0},{text:"<span id='cmitem_nsearch'> 在此点附近找...</span>",callback:f,width:90},{text:'<span id="cmitem_add"> 添加新地点</span>',callback:h,width:90},{separator:!0},{text:"<span id='cmitem_zoomin'>放大</span>",callback:w,width:70},{text:"<span id='cmitem_zoomout'>缩小</span>",callback:I,width:70},{text:"<span id='cmitem_center'>居中</span>",callback:x,width:70}]);return map.addEventListener("maptypechange",function(){this.getMapType()==BMAP_NORMAL_MAP&&v.enable()}),v.addEventListener("open",function(){if(window.currentComponent&&"RouteAddr"==window.currentComponent._className&&window.startPoi!==!1&&window.endPoi!==!1)return this.getItem(0).disable(),this.getItem(1).disable(),void this.getItem(2).disable();var e=this;this.getItem(0)&&this.getItem(0).enable(),this.getItem(2)&&this.getItem(2).enable(),map.getZoom()<10?this.getItem(3).disable():this.getItem(3).enable(),map.getZoom()==map.config.zoomLevelMax?this.getItem(5).disable():this.getItem(5).enable(),map.getZoom()==map.config.zoomLevelMin?this.getItem(6).disable():this.getItem(6).enable(),2===l.curSelIndex&&u.getTpCount()<5?e.getItem(1).enable():e.getItem(1).disable(),3===l.curSelIndex&&e.getItem(1).disable()}),v}function c(e,n,t){var o=new BMap.ContextMenu({container:n});n&&n!==map?o.initialize(map):map.addContextMenu(o);for(var i=0,a=e.length;a>i;i++){var r=e[i];r.separator?o.addSeparator():o.addItem(new BMap.MenuItem(r.text,r.callback||function(){},{width:r.width||100,id:r.id}))}return o.setCursor(t),o}var m=e("common:widget/com/componentManager.js"),u=(e("common:widget/ui/mapInfo/mapInfo.js"),e("common:widget/com/RouteSearch/DriveSearchTab.js")),l=e("common:widget/com/RouteSearch/RouteSearch.js"),p=e("common:widget/ui/operateMediator/operateMediator.js"),g={init:function(){var e=s();return e},create:function(e,n,t){var o=c(e,n,t);return o},destroy:function(e){e&&e.destroy&&(e.destroy(),e=null)}};t.exports=g});
;define("common:widget/ui/Storage/Storage.js",function(e,t,a){baidu.storage={},baidu.storage._isValidKey=function(e){return new RegExp('^[^\\x00-\\x20\\x7f\\(\\)<>@,;:\\\\\\"\\[\\]\\?=\\{\\}\\/\\u0080-\\uffff]+$').test(e)},baidu.storage.userData=function(){var e="_BAIDU.ALL.KEY_",t=function(){var e=null;return e=document.createElement("input"),e.type="hidden",e.addBehavior("#default#userData"),document.body.appendChild(e),e},a=function(e,a){try{var r=t(),o=a||{};if(o.expires){var u;"number"==typeof o.expires&&(u=new Date,u.setTime(u.getTime()+o.expires)),r.expires=u.toUTCString()}o.expires=null,r.setAttribute(o.key,o.value),r.save(o.key)}catch(i){}},r=function(t,r){a(t,r),result=o({key:e}),result=result?{value:result}:{key:e,value:""},new RegExp("(^||)"+t+"(||$)").test(result.value)||(result.value+="|"+t,a(e,result))},o=function(e){try{var a=t();return a.load(e.key),a.getAttribute(e.key)||null}catch(r){return null}},u=function(e){try{var a=t();a.load(e.key),a.removeAttribute(e.key);var r=new Date;r.setTime(r.getTime()-1),a.expires=r.toUTCString(),a.save(e.key)}catch(o){}},i=function(){if(result=o({key:e})){result={value:result};for(var t=(result.value||"").split("|"),a=t.length,r=0;a>r;r++)u({key:t[r]})}};return{getItem:o,setItem:r,removeItem:u,clearAll:i}}(),baidu.storage._isSupportLocalStorage=function(){return"localStorage"in window&&null!==window.localStorage},baidu.storage.isSupportStorage=function(){return"localStorage"in window&&null!==window.localStorage||document.all},baidu.storage.set=function(e){if(baidu.storage._isValidKey(e.key)){var t=e||{};baidu.storage._isSupportLocalStorage()?(window.localStorage.setItem(t.key,t.value),e.expires&&window.localStorage.setItem(t.key+".expires",t.expires)):baidu.storage.userData.setItem(e.key,t)}},baidu.storage.get=function(e){var t=null;if(!baidu.storage._isValidKey(e.key))return t;if(baidu.storage._isSupportLocalStorage()){if(t=window.localStorage.getItem(e.key)){var a=window.localStorage.getItem(e.key+".expires");t={value:t,expires:a?new Date(a):null},t&&t.expires&&t.expires<new Date&&(t=null,window.localStorage.removeItem(e.key))}}else t=baidu.storage.userData.getItem(e),t&&(t={value:t});return t?t.value:null},baidu.storage.remove=function(e){baidu.storage._isSupportLocalStorage()?(window.localStorage.removeItem(e.key),window.localStorage.removeItem(e.key+".expires")):baidu.storage.userData.removeItem(e)},baidu.storage.clearAll=function(){baidu.storage._isSupportLocalStorage()?window.localStorage.clear():baidu.storage.userData.clearAll()},a.exports=baidu.storage});
;define("common:widget/ui/searchInfoWindow/searchInfoWindow.js",function(e,i,a){function t(e){var i=e.ext,a=i.detail_info,t=i.src_name,n=(t.toUpperCase()+"_",e.uid),o=e.poiType,s=e.cityCode,r=[],d="hotel"==i.src_name&&parseInt(a.pc_bookable),l=/^(hospital|house|education|scope|shopping)$/,c=/^(hospital|house|education|shopping)$/;if("cater"!=i.src_name&&a&&a.homepage&&r.push('<div class="url"><a href="'+a.homepage+'" target="_blank" >'+a.homepage+"</a></div>"),a&&(a.overall_rating||a.price)&&!d&&"090300"!=e.catId){if(r.push('<div class="hotel_iw">'),a.overall_rating){var p=Math.round(1*a.overall_rating*12.2);p=isNaN(p)?0:p,p>0&&(l.test(t)||r.push('<span class="score"><b style="width:'+p+'px">评分</b></span><span tid="iw_poi_score" class="starNum">'+a.overall_rating+"</span>"))}if(a.price){var u=parseFloat(a.price),h=place.placeConfig.basicInfoCN[i.src_name],_=h.price,f=h.priceUnit,m=parseFloat(a.realPrice);c.test(t)||(!isNaN(m)&&m>0?r.push('<span tid="iw_poi_price" class="price">报价：<span style="color:red">'+m+"元起</span></span>"):!isNaN(u)&&u>0&&_&&f&&r.push('<span tid="iw_poi_price" class="price">'+_+"：&nbsp;"+u+f+"</span>"))}a.venue_flag&&r.push(['<a class="no-underline" onclick="place.showDetail(\''+n+"', "+o+", "+s+", '"+t+"','venue','Iw');return false\" href=\"javascript:void(0)\">","价格表&gt;&gt;","</a>"].join("")),r.push("</div>")}return r.join("")}function n(e){var i=e.ext,a=this,t=i.detail_info,n=i.src_name||"",o=e.uid,s=e.poiType,r=e.cityCode,d=(n.toUpperCase()+"_",{action:"open_iw"}),l=[],c=0,p="hotel"==i.src_name&&parseInt(t.pc_bookable),u="cater"==i.src_name&&parseInt(i.detail_info.pc_bookable),h=("scope"==i.src_name&&parseInt(t.ticket_book_flag),S.getParams());if(u&&l.push(a.generateCaterBookPrice(e)),t.premium2&&T.isArray(t.premium2)&&t.premium2.length&&"hotel"!=n){var _,f,m=t.premium2;if(c=1,m.length>1)for(var w=0;(_=m[w])&&"lbc-claim"!=_.name;w++);_=_||t.premium2[0],f=_.discount_title,f.length>20&&(f=f.substr(0,20)+"..."),l.push(['<p class="place-preferential">',"<a onclick=\"place.showDetail('"+o+"', '"+s+"', '"+r+"', '"+n+"','page_discount','Iw');\" href=\"javascript:void(0)\">","<em></em><strong>"+f+"</strong><i></i>","</a></p>"].join("")),d.discount=1}if(t.groupon&&T.isArray(t.groupon)&&"hotel"!=n){var g,v=t.groupon_num||t.groupon.length;g="cater"==n?'<p class="place-preferential groupon" '+("090300"==e.categoryId?'style="margin-top: 3px;"':"")+"><a onclick=\"place.showDetail('"+o+"', '"+s+"', '"+r+"', '"+n+"','groupon','Iw');\" href=\"javascript:void(0)\"> <em></em><strong>"+v+"条团购信息</strong></a></p>":'<p class="place-preferential groupon" '+("090300"==e.categoryId?'style="margin-top: 3px;"':"")+">                    <a onclick=\"place.showDetail('"+o+"', '"+s+"', '"+r+"', '"+n+"','groupon','Iw');\" href=\"javascript:void(0)\">                    <em></em><strong>"+v+"条团购信息</strong>                    </a></p>",l.push(g),d.groupon=1}if(t.announcement&&t.announcement.title){var b=t.announcement.title;b.length>20&&(b=b.substr(0,20)+"..."),l.push(['<p class="place-preferential announcement">',"<a onclick=\"place.showDetail('"+o+"', '"+s+"', '"+r+"', '"+n+"','announcement','Iw');\" href=\"javascript:void(0)\">","<em></em><strong>"+b+"</strong>","</a></p>"].join(""))}if(t.other_opera_num&&(l.push(['<p class="link"><span>近期上演'+t.other_opera_num+"个剧目，</span>","<a onclick=\"place.showDetail('"+o+"', '"+s+"', '"+r+"', '"+i.src_name+"','other_opera','Iw');return false\" href=\"javascript:void(0)\">","查看演出信息&gt;&gt;","</a></p>"].join("")),d.other_opera=1),"090300"!=e.categoryId&&(t.link=t.link||[])){var y=[];y.push(p?'<p tid="iw_poi_detail" class="link link-gray"><em>详情：</em>':'<p tid="iw_poi_detail" class="link"><em>详情：</em>');for(var I=0;I<t.link.length;I++)if(t.link&&t.link[I].url&&"DAODAO"!=t.link[I].name.toUpperCase()){var C=t.link[I].name,k=t.link[I].url,x=T.url.getQueryValue(k,"qt"),P="",R="",M={from:"map",category:n.toLowerCase(),fun:C,area:"iw"};if(x?(P=k,R=decodeURIComponent(T.url.getQueryValue(k,"url"))):(P="http://map.baidu.com/detail?qt=ur",R=k),"kuxun"==C&&(R+="?fromid=Khslmapbaidu-S1168731-T1183261&est=marketing"),"elong"==C){var B=/^http:\/\/www\.elong\.com.*?(_|-)(\d*)(\.html|\-photos.*|_index_1\.html)$/,O="http://hotel.elong.com/search/$2",E="?semid=baidumap";R=R.replace(B,O+"-hotel/"+E)}"shenbian"==C&&-1==C.indexOf("bd=baidu_map")&&(/\?/.test(R)?R=R.replace(/(\?)(.*)$/,"$1bd=baidu_map&$2"):/\#/.test(R)?R=R.replace(/(\#)(.*)$/,"?bd=baidu_map#$2"):R+="?bd=baidu_map"),x?P=P.replace(/(&|\?|#)(url=)([^&#]*)(&|$|#)/,"$1$2"+encodeURIComponent(R)+"$4"):M.url=R,P=P+"&"+T.url.jsonToQuery(M,function(e){return encodeURIComponent(e)}),y.push('<span ><a href="'+P+'" target="_blank">'+t.link[I].cn_name+"</a></span>")}y.push("</p>"),l.push(y.join(""))}return t.movie_film_count&&"090300"==e.categoryId&&(h.pl_business_id&&t.timetable.length?(l.push('<div class="movie-info-newest" style="width:208px;_width:204px;">'),l.push(baidu.string.format("<a href=\"javascript:void(0);\" onclick=\"place.showDetail('#{0}','#{1}','#{2}','#{3}','#{4}','Iw','#{5}');return false;\"><span>近期场次<i class=\"arrow\"></i></span><em class=\"light\">"+t.timetable.slice(0,4).join('</em><em class="light">')+"</em></a>",[o,s,r,n,"movie_info",h.pl_business_id]))):(l.push('<div class="movie-info-newest">'),l.push(baidu.string.format("<a href=\"javascript:void(0);\" onclick=\"place.showDetail('#{0}','#{1}','#{2}','#{3}','#{4}','Iw');return false;\"><span>实时影讯<i class=\"arrow\"></i></span>目前<em>"+t.movie_film_count+"</em>部影片<em>正在上映!</em></a>",[o,s,r,n,"movie_info"]))),l.push("</div>"),d.other_movie=1),l.join("")}function o(e){var i=!!e;if(i)switch(e.src_name){case"ctrip_hotel":break;case"ctrip_site":i=!1;break;case"dianping":i=!1;break;case"house_new":break;case"house_ershou":break;case"biaozhu_data":}return i}function s(e){var i=e.ext?e.ext.detail_info:{},a=[],t="",n="";switch(e.status){case 1:case 2:case 4:case 8:case 10:break;case 5:t="该店即将开业，建议确认后再去 ";break;case 3:case 9:case 11:t="可能已搬迁或关闭，建议确认后再去 "}return n=i&&i.point?"http://tousu.baidu.com/map/add?place="+encodeURIComponent(e.name)+"&lat="+i.point.y+"&lng="+i.point.x+"#1":"http://tousu.baidu.com/map/add?place="+encodeURIComponent(e.name)+"#1",t&&(a.push('<div class="msgBox inbub">'),a.push('<span class="alrt"></span>'),a.push(t),a.push('<a target="_blank" href="'+n+"\" onclick=\"addStat('7000',{area:'iw_page',item:'bub_alrt_clk',from:'map'})\">欢迎报错</a>"),a.push("</div>")),a.join("")}function r(i,a){e.async("common:widget/ui/ui3MapSuggest/ui3MapSuggest.js",function(e){e.initialize({input:T("#iw_ssn"),isAutoWidth:!1,adjustTop:3,hasHistory:!0,showMyPlace:!0,from:"infowindow",width:270,onSelect:function(e,i){T.isObject(e)||(a.wd2=i)}}),e.initialize({input:T("#iw_esn"),isAutoWidth:!0,adjustTop:3,hasHistory:!0,showMyPlace:!0,onSelect:function(e,i){T.isObject(e)||(a.wd2=i)}})})}var d=e("common:widget/com/componentManager.js"),l=e("common:widget/ui/util/util.js"),c=e("common:widget/ui/constant/Constant.js"),p=e("common:widget/ui/signMgr/signMgr.js"),u=e("common:widget/ui/fav/favMgr.js"),h=(e("common:widget/ui/mapInfo/mapInfo.js"),e("common:widget/ui/mapUtil/mapUtil.js")),_=e("common:widget/ui/indexUtil/IndexUtil.js"),f=e("common:widget/ui/sms/sms.js"),m=e("common:widget/ui/config/config.js"),w=e("pano:widget/PanoInterface/PanoInterface.js"),g=e("common:widget/ui/FilterStatus/FilterStatus.js"),v=m.modelConfig,b=(m.mapConfig,m.urlConfig),S=e("common:widget/search/SearchUrlParam.js"),y=function(){var e,i=0,a=null;return function(t,n,o,s,r,d){var l,c,p,u;if(100>r-i)return!0;500>r-i&&a?(l=a.mainMenuPosition,c=a.subMenuPosition,p=a.mainMenuStyle,u=a.subMenuStyle):(a={},l=a.mainMenuPosition=T.dom.getPosition(n),c=a.subMenuPosition=T.dom.getPosition(o),p=a.mainMenuStyle={width:parseInt(T.dom.getComputedStyle(n,"width")||n.currentStyle.width),height:parseInt(T.dom.getComputedStyle(n,"height")||n.currentStyle.height)},u=a.subMenuStyle={width:parseInt(T.dom.getComputedStyle(o,"width")||o.currentStyle.width),height:parseInt(T.dom.getComputedStyle(o,"height")||o.currentStyle.height)});var h,_,f,m=function(){e=setTimeout(function(){d&&d()},500)};if(i=r,clearTimeout(e),c.left<=0||c.top<=0)return a=null,!1;if(s);else{if(t.y>=c.top)return!0;if(t.x<l.left)h=t.x-c.left,_=c.top-t.y,f=p.height/(l.left-c.left),m();else{if(!(t>l.left+p.width))return!0;h=c.left+u.width-t.x,_=c.top-t.y,f=p.height/(c.left+u.width-c.left-u.width),m()}}var w=f>=_/h;return w||clearTimeout(e),w}}(),I={content:null,opts:null,queryWd:"",iwExt:null,iwOpts:null,rangeSearchCenterMarker:null,addRangeSearchCenterPoi:function(e,i,a,t){this.rangeSearchCenterMarker&&(this.rangeSearchCenterMarker.remove(),this.rangeSearchCenterMarker=null);var n=l.getPoiPoint(e);if(n){var o=new BMap.Icon(c.A_J_MARKER_IMG_NEW,c.A_J_MARKER_CENTERBLUE_SIZE,{offset:c.A_J_MARKER_CENTERBLUE_OFFSET,imageOffset:new BMap.Size(-75,-233),infoWindowOffset:c.A_J_MARKER_INFOWND_OFFSET,imageSize:new BMap.Size(c.A_J_MARKER_IMG_NEW_WIDTH,c.A_J_MARKER_IMG_NEW_HEIGHT),srcSet:c.A_J_MARKER_IMG_NEW2X_SRCSET}),s=t||25e5,r=new BMap.Marker(n,{icon:o,zIndexFixed:!0,baseZIndex:s,startAnimation:"marker-raise"});return map.addOverlay(r),r._stCode=c.OVERLAY_STYLE.MKR_RCTR,a||(this.rangeSearchCenterMarker=r),i&&r.setTitle(i),r}},createSearchInfoWnd:function(e,i){this.content=e,this.opts=i||{},i=i||{},window.addStat("search.info.win","show",{da_e_name:"pcmap3"});var a=e.title,r="null"===e.addr?"":e.addr,d=e.desc,l=e.blinfo,u=e.tel&&e.tel.replace(/(,|;)/gi,", "),h=e.uid||"",_=e.poiType||c.POI_TYPE_NORMAL,f=e.hasDetail,m=e.ext,w=e.transUid,g=e.mingpian,S=m&&m.pic_info?m.pic_info:[],y=e.userSign||0,I=e.fav||0,C=e.content,k=(e.bizType,window.place?window.place.placeRe:""),x=(window.place?window.place.placeConfig:"",window.place?!!m&&m.src_name:""),P="cater"===x,R=e.origin_id&&e.origin_id.overview_guid?e.origin_id.overview_guid:"",M=e.catId,B="",O="",E="",N=this,G=e.pano||0,U=e.indoor_pano||0,j=("undefined"==typeof e.pano_index?-1:e.pano_index,e.wd||"",e.street_id||"");S.length>0&&S[0].pics&&(S=m.pic_info[0].pics);var A=i.cityCode||v.cityCode;if(!a)return null;var F=o(m);this.hasDetailPage=k?!(!m||!k.test(x)):"";var L=a;_==c.POI_TYPE_BUSSTOP?L+="-公交车站":_==c.POI_TYPE_SUBSTOP&&(L+="-地铁站"),B=L,L.replace(/[\u0100-\uffff]/g,"##").length>30&&(L=L.substring(0,14)+"...");var D=0;if(m&&m.detail_info){var $=m.detail_info;$.premium2&&baidu.isArray($.premium2)&&$.premium2.length&&(D=1)}var W="<p class='iw_poi_title "+(P?"cater_title":"")+"' title='"+a+"'>";if(W+="<span class='susIconSetFlag'></span>",P||f&&_!==c.POI_TYPE_BUSSTOP&&_!==c.POI_TYPE_BUSLINE&&_!==c.POI_TYPE_SUBSTOP&&_!==c.POI_TYPE_SUBLINE||!i.hideDetail&&(_===c.POI_TYPE_BUSLINE||_===c.POI_TYPE_SUBLINE)){var Y=P?20:25,q=P?9:11;L.replace(/[\u0100-\uffff]/g,"##").length>Y&&(L=L.substring(0,q)+"...");var H="";if(k&&m&&("biaozhu_data"==m.src_name||k.test(x))){var z="详情",J=m.detail_info,V=J&&(J.pc_bookable||J.di_review_keyword||J.groupon_num||J.premium_flag);if(W+="cater"==m.src_name?"<a  href='javascript:void(0)' class='title' onclick='addStat(\"poiinfowin.poi.title\");place.showDetail(\""+h+'", '+_+", "+A+', "'+m.src_name+'","Page","Iw");return false;\'>'+L+"</a>":"<a  href='javascript:void(0)' class='title' onclick='place.showDetail(\""+h+'", '+_+", "+A+', "'+m.src_name+'","Page","Iw");return false;\'>'+L+"</a>",k.test(x)){var X=(x.toUpperCase()+"_","");"hospital"==x&&e.business_id&&(X=e.business_id),"cater"==x?V&&(W+='<a class="iw_poi_detail" href="javascript:void(0)" onclick="place.showDetail(\''+h+"', "+_+", "+A+", '"+m.src_name+"','Page','Iw'"+(X?",false,'"+X+"'":"")+");addStat('poiinfowin.poi.detail');return false;\">"+z+"&raquo;</a>"):W+='<a class="iw_poi_detail" href="javascript:void(0)" onclick="place.showDetail(\''+h+"', "+_+", "+A+", '"+m.src_name+"','Page','Iw'"+(X?",false,'"+X+"'":"")+');return false;">'+z+"&raquo;</a>"}else W+='<a class="iw_poi_detail" href="javascript:void(0)" onclick="place.showDetail(\''+h+"', "+_+", "+A+", '"+m.src_name+"','Page','Iw');"+H+'return false;">'+z+"&raquo;</a>"}else W+="<a href='javascript:void(0)' class='title' onclick='place.showDetail(\""+h+'", '+_+", "+A+");return false;'>"+L+"</a>",W+='<a class="iw_poi_detail" href="javascript:void(0)" onclick="place.showDetail(\''+h+"', "+_+", "+A+");"+H+'return false;">详情&raquo;</a>'}else i.smp&&(W+="<span class='iw_icon_"+i.smp+"'></span>"),W+='<span class="title">'+L+"</span>";W+="</p>";var K=[],Q="";if(y&&(Q='style="display:none;"'),P)K.push("<div class='cater_poi_conTop'"+Q+">"),K.push(place.caterPopInner.contentHtml(e,A)),K.push("</div>");else{if(K.push("<div class='iw_poi_conTop'"+Q+">"),G){var Z=i&&i.isFromMPC?j:h;if(U){var ei=U.match(/sid=([\d\w]*)/);ei=ei?ei[1]:Z,K.push("<div class='panoInfoBox_hasInAndOut'>");var ii=b.PANO_URL+"/pr/?qt=poiprv&uid="+Z+"&width=107&height=101&quality=80&fovx=50",ai=b.PANO_3DIMAGE_URL+"/?qt=pr3d&panoid="+ei+"&width=212&height=101&quality=80&fovx=180";K.push("<div class='indoor_pano_box' title='"+a+"内部环境'><img class='pano_thumnail_img' width=212 height=101 border='0' alt='"+a+"内部环境' src='"+ai+"' id='pano_"+h+"'/>"),K.push("<div class='panoInfoBoxTitleBg'></div><a href='javascript:void(0)' class='panoInfoBoxTitleContent'>内部环境&gt;&gt;</a></div>"),K.push("<div class='pano_box' title='"+a+"街道全景'><img class='pano_thumnail_img' width=107 height=101 border='0' alt='"+a+"街道全景' src='"+ii+"' id='indoor_pano"+h+"'/>"),K.push("<div class='panoInfoBoxTitleBg'></div><a href='javascript:void(0)' class='panoInfoBoxTitleContent' >街道全景&gt;&gt;</a></div>"),K.push("</div>")}else{K.push("<div class='panoInfoBox' title='"+a+"街道全景' title='查看全景' >");var ii=b.PANO_URL+"/pr/?qt=poiprv&uid="+Z+"&width=323&height=101&quality=80&fovx=250";K.push("<img class='pano_thumnail_img' width=323 height=101 border='0' alt='"+a+"街道全景' src='"+ii+"' id='pano_"+h+"'/>"),K.push("<div class='panoInfoBoxTitleBg'></div><a href='javascript:void(0)' class='panoInfoBoxTitleContent' >街道全景&gt;&gt;</a>"),K.push("</div>")}}if(!G&&U){var ei=U.match(/sid=([\d\w]*)/);ei=ei?ei[1]:Z;var ai=b.PANO_URL+"/?qt=pr3d&panoid="+ei+"&width=212&height=101&quality=80&fovx=250";K.push("<div class='panoInfoBox' title='"+a+"内部环境' title='查看内景' >"),K.push("<img class='pano_thumnail_img' width=323 height=101 border='0' alt='"+a+"内部环境' src='"+ai+"' id='pano_"+h+"'/>"),K.push("<div class='panoInfoBoxTitleBg'></div><a href='javascript:void(0)' class='panoInfoBoxTitleContent' >内部环境&gt;&gt;</a>"),K.push("</div>")}if(K.push(s(e)),F&&m.pic&&m.pic.length>0&&m.pic[0]&&K.push("<div style='float:right;width:70px;height:70px;overflow:hidden;display:inline' title='"+a+"'><img border='0' alt='"+a+"' src='"+m.pic[0]+"'/></div>"),F&&m.src_name&&("biaozhu_data"==m.src_name&&"1"==m.yw_type&&S.length>0&&S[0].minurl||k&&k.test(m.src_name)&&m.detail_info&&m.detail_info.image)){var ti="",ni="",oi=106,si=104,ri=71,di=69,li="",ci="",pi="ISHOP_INFO_IMG",ui="";if(this.createSearchInfoWnd.iwImgLoading=1,ti=a,oi=106,si=104,ri=71,di=69,li=" style='border:#bdbdbd solid 1px'",ni=m.detail_info.image,pi=m.src_name,ui="Page_Pic",ci=";text-align:center",/sina|soufun/i.test(ni)&&(ni+="?"),!G&&!U){if(K.push("090300"==e.catId?"<div style='float:right;width:"+oi+"px;height:"+ri+"px;display:none"+ci+"' title='"+ti+"'>":"<div style='float:right;width:"+oi+"px;height:"+ri+"px;display:inline"+ci+"' title='"+ti+"'>"),k&&k.test(m.src_name)){{x.toUpperCase()+"_"}K.push("<a href='javascript:void(0)' onclick='place.showDetail(\""+h+'", '+_+", "+A+', "'+pi+'", "'+ui+'","Iw");return false;\'\'>')}else K.push("<a href='javascript:void(0)' onclick='place.showDetail(\""+h+'", '+_+", "+A+', "'+pi+'", "'+ui+'","Iw");return false;\'\'>');var hi="http://webmap3.map.bdimg.com/maps/services/thumbnails?width="+si+"&height="+di+"&align=center,center&src="+encodeURIComponent(ni);K.push("<img tid='iw_poi_img' width='"+si+"' height='"+di+"' border='0'"+li+" alt='"+ti+"' src='"+hi+"' id='detail_"+h+"'/>"),K.push("</a>"),K.push("</div>")}6==T.browser.ie&&(this.createSearchInfoWnd.iwImgLoadingSum=0,this.createSearchInfoWnd.iwImgLoadingTimer&&clearInterval(this.createSearchInfoWnd.iwImgLoadingTimer),this.createSearchInfoWnd.iwImgLoadingTimer=setInterval(function(){N.createSearchInfoWnd.iwImgLoadingSum>=100&&(clearInterval(N.createSearchInfoWnd.iwImgLoadingTimer),N.createSearchInfoWnd.iwImgLoadingSum=0),N.createSearchInfoWnd.iwImgLoading&&T.G("detail_"+h)&&(T.G("detail_"+h).src=ni,N.createSearchInfoWnd.iwImgLoadingSum++)},100))}var _i=25;if(F&&m&&m.title_link?K.push("<div class='iw_poi_content iw_poi_content_search' style='width:220px'>"):F&&m&&("biaozhu_data"==m.src_name&&S.length>0||k&&k.test(m.src_name)&&m.detail_info&&m.detail_info.image&&"090300"==!e.catId)?K.push("<div class='iw_poi_content iw_poi_content_search' style='width:214px;'>"):(K.push("<div class='iw_poi_content iw_poi_content_search'>"),_i=35),r)if(_==c.POI_TYPE_BUSSTOP||_==c.POI_TYPE_SUBSTOP){if(K.push("<p>车次："),l){for(var fi=[],mi=0,wi=l.length;wi-1>mi;mi++)if(!baidu.array.contains(fi,l[mi].addr)){var gi="s&wd="+l[mi].addr+"&c="+v.cityCode,vi=encodeURIComponent(gi.replace(/&b=\((-?\d+)(\.\d+),(-?\d+)(\.\d+);(-?\d+)(\.\d+),(-?\d+)(\.\d+)\)/gi,"")),bi="?newmap=1&shareurl=1&s="+vi;K.push('<a class="detail blueA" tid="poiDetail_'+mi+'" target="_blank" href="'+bi+'" >'+l[mi].addr+"; </a>"),fi.push(l[mi].addr)}if(!baidu.array.contains(fi,l[mi].addr)){var gi="s&wd="+l[wi-1].addr+"&c="+v.cityCode,vi=encodeURIComponent(gi.replace(/&b=\((-?\d+)(\.\d+),(-?\d+)(\.\d+);(-?\d+)(\.\d+),(-?\d+)(\.\d+)\)/gi,"")),bi="?newmap=1&shareurl=1&s="+vi;K.push('<a class="detail blueA" tid="poiDetail_'+wi+'" href="'+bi+'" >'+l[wi-1].addr+"</a>")}}else r&&K.push(r);K.push("</p>"),O=(_==c.POI_TYPE_BUSSTOP?"途经公交：":"途经地铁：")+r}else K.push('<table cellspacing="0" class="table_addr_tel"><tr tid="iw_poi_addr"><th>地址：&nbsp;</th><td>'),K.push(r+"&nbsp;</td></tr>"),O=r,u&&(K.push('<tr tid="iw_poi_tel"><th>电话：&nbsp;</th><td>'+u+"</td></tr>"),E=u),K.push("</table>");else u&&(K.push('<table cellspacing="0" class="table_addr_tel">'),r&&K.push('<tr tid="iw_poi_addr"><th>地址：&nbsp;</th><td>'+r+"</td></tr>"),K.push('<tr tid="iw_poi_tel"><th>电话：&nbsp;</th><td>'+u+"</td></tr>"),E=u,K.push("</table>"));if(d&&K.push("<p>"+d+"</p>"),window.place&&m&&k.test(m.src_name)&&(K.push(t({ext:m,uid:h,poiType:_,cityCode:A,catId:M})),u&&(u=u.replace("、","<br />"))),F&&m&&m.title_link){var Si=["<p style='margin-top:2px'>"];if(m.title_link)for(var mi=0,wi=m.title_link.length;wi>mi;mi++)Si.push("<a class='ns_link' href='"+m.title_link[mi].link+"' target='_blank' >"+m.title_link[mi].title+"</a>"),mi<m.title_link.length-1&&Si.push("&nbsp;&nbsp;");K.push(Si.join("")),K.push("</p>")}K.push("</div>"),g&&K.push("<p>"+g+"</p>"),window.place&&(m&&m.detail_info&&k.test(m.src_name)&&K.push(n({ext:m,uid:h,poiType:_,cityCode:A,categoryId:M})),m&&window.place&&k.test(m.src_name)&&K.push(window.place.generateAsyncBookPrice({ext:m,uid:h,poiType:_,cityCode:A})),window.place&&m&&m.detail_info&&m.detail_info.book_info&&"undefined"!=typeof m.detail_info.movie_film_count&&K.push(window.place.generateAsyncBookByMovie({uid:h,poiType:_,category:m.src_name,cityCode:A}))),K.push("<div class='iw_btn_con suspendContainer'></div>"),K.push("<div class='iw_btn_con'>"),"undefined"!=typeof e.ext_type&&1&e.ext_type&&K.push('<span class="inr_iw" onmouseover="this.className=\'inr_iw_on\'" onmouseout="this.className=\'inr_iw\'" onmousedown="this.className=\'inr_iw_down\'" onmouseup="this.className=\'inr_iw_on\'"  title="查看室内地图"></span>'),K.push("</div>"),K.push("</div>")}if(y||h||i.smp){if(y?(K.push('<div id="userSignContent">'+C+"</div>"),K.push('<div id="userSignCtrl" class="userShowCtrl" >')):K.push('<div id="userSignCtrl" class="userShowCtrl" data-nosign="true" >'),K.push('<div class="ctrl">'),e.jiucuofr){e.jiucuofr}else;y&&!I&&(K.push('<span class="edit"><b  class="sign_edit" title="修改"></b></span>'),K.push('<span class="delete"><b class="sign_del" title="删除此点"></b></span>'));var Ti="";if(p._USERSHARE||!y){var yi="",Ii="",Ci="shareBtn_u  fuck";y||(yi="onmouseover=\"T.ac(this,'span_focus')\" onmouseout=\"T.rc(this,'span_focus')\"",Ii="分享",Ci="shareBtn fuck");{i.x+" "+i.y}Ti='<span class="'+Ci+'" '+yi+' title="将此点在图区上的位置分享给好友"><b></b>'+Ii+"</span>",p._USERSHARE&&y&&K.push(Ti)}P&&G&&K.push('<span class="pano-box"><a class="panoBtn" href="javascript:;" title="全景"><b class="pano" title="全景" style="cursor:pointer;" onclick="addStat(\'poiinfowin.poi.pano\');"></b></a></span>');var ki,xi="";if(p._USERFAV){var Pi=a.replace(/\"/g,"&quot;"),Ri=[];r?Ri.push(_==c.POI_TYPE_BUSSTOP||_==c.POI_TYPE_SUBSTOP?"车次:"+r+"<br/>":"地址:"+r+"<br/>"):C&&Ri.push(C),u&&Ri.push("电话:"+u);var Mi=Ri.join("").replace(/\"/g,"&quot;"),Bi=parseFloat(i.x)+"|"+parseFloat(i.y),Oi={point:Bi,uid:h,cityCode:A,title:Pi,content:Mi,panoGuid:R},Ei=/'/g;Ei.test(r)&&(r=r.replace(Ei," "),Mi=Mi.replace(Ei," ")),y?(ki={userSign:y,isfav:I,json:Oi,uid:h},K.push('<span class="fav" id="JiwFav" data-title=\''+Pi+"' data-cont='"+Mi+'\' title="加入收藏夹"><b></b></span>')):(ki={uid:h},K.push('<span class="fav" id="JiwFav" data-title=\''+Pi+"' data-cont='"+Mi+"' uid=\""+h+'" title="加入收藏夹" onclick=\'addStat("poiinfowin.poi.fav");\'><b></b></span>'))}!y&&h&&K.push("<span class='send_telf'><b  title=\"免费发送到手机\"></b></span>"),!y&&h&&K.push('<span><a class="sms_jiucuo"  href="http://tousu.baidu.com/map/add?place='+encodeURIComponent(a)+"&lat="+i.y+"&lng="+i.x+"&uid="+h+'#1" target="_blank"><b class="jiucuo" title="纠错" style="cursor:pointer;"></b></a></span>'),y||(K.push("<span id='iw_tool_icon' class='box' onmouseover=\"this.className='box box_on';T.g('iw_tool_box').style.top=''\"><b></b>"),K.push('<div class="iw_tool_box" id="iw_tool_box" style="top:-2000px">'),xi='<span id="JiwFav" class="point"  data-title=\''+Pi+"' data-cont='"+Mi+'\' onmouseover="T.ac(this,\'span_focus\')" onmouseout="T.rc(this,\'span_focus\')" title="将此点的位置标记在地图上"><b></b>标记</span>',K.push(xi),i.smp||(K.push(Ti),K.push('<span class="sicon08 carIcon" onmouseover="T.ac(this,\'span_focus\')" onmouseout="T.rc(this,\'span_focus\')"  title="发至汽车"><b></b>发至汽车</span>')),K.push("</div></span>")),K.push("</div>"),K.push('<div class="share" id="iw_share_con" style="display:none">'),K.push("</div>"),K.push("</div>")}K.push(this.addBottomTabs(i,P,h,y)),K.push("<div id='userSignEdit' style='display:none;'></div>");var Ni=[0,-26];i.forBusLine&&(Ni[1]=-5),i.isMenu&&(Ni[1]=-30);var Gi=this.createInfWindow(W,K.join(""));return ki&&(Gi.favObj=ki),Gi._config.collisions=[[65,245],[233,39],[10,10],[10,10]],Gi._ext={uid:h,pt:new BMap.Point(i.x,i.y),name:a,c:A,poiType:_,geoloc:i.geoloc,placesrcname:x},Gi._transUid=w,window.place&&(window.place.iw=Gi),Gi},createAdInfWindow:function(e,i,a){this.opts=a||{},e='<div class="damoce-bubble-title">'+e+"</div>",i='<div class="damoce-bubble-content">'+i+"</div>",a.hideFrom=!0,a.hideNear=!0;var t=I.createInfWindow(e,i+this.addBottomTabs(a));return t._config.collisions=[[65,245],[233,39],[10,10],[10,10]],t._ext={pt:new BMap.Point(a.x,a.y),name:a.name,c:a.sCityCode},window.place&&(window.place.iw=t),t},addBottomTabs:function(e,i,a,t){e=e||{};var n="/wolfman/static/common/images/transparent.gif",o=e.tabIndex,s=["","",""],r=["none","none","none"],d=[];if(void 0!==o&&r[o]?(s[o]="hover",r[o]="block"):(s[1]="hover",r[1]="block"),d.push('<div class="iw_poi_inter" id="iw_poi_inter">'),d.push('<ul class="nav_tab '+(i?"cater_tab":"")+'">'),!e.hideTo){var l=e.hideFrom&&e.hideNear?"right-border":"";d.push('<li id="nav_tab0" data-tab="0" class="second blueA '+s[1]+" "+l+'" ><em class="to-icon"></em>到这去</li>')}if(!e.hideFrom){var l=e.hideNear?"right-border":"";d.push('<li id="nav_tab1" data-tab="1" class="first blueA '+s[2]+" "+l+'" ><em class="from-icon"></em>从这出发</li>')}e.hideNear||d.push('<li id="nav_tab2"  data-tab="2"  class="third blueA '+s[0]+'" ><img  class="search-nearby" src="'+n+'"></em>在附近找</li>'),d.push("</ul>"),e.hideTo||(d.push('<div id="iw_tab0" class="nav_tab_content" style="display:'+r[1]+'">'),d.push('<form id="iw_s_frm">'),d.push('<div style="white-space:nowrap;"><span id="iw_ssnSpan" class="iw_txt_wrap"><input id="iw_ssn" type="text" size="22" maxlength="100" autocomplete="off" placeholder="请输入起点"/></span>'),d.push('<input id="iw_ssb_btn" type="submit" value="公交" class="iw_bt" onmouseover="this.className=\'iw_bt_over\'" onmouseout="this.className=\'iw_bt\'" onmousedown="this.className=\'iw_bt_down\'" onmouseup="this.className=\'iw_bt_over\'" />'),d.push('<input id="iw_ssd_btn" type="button" class="iw_bt" value="驾车" onmouseover="this.className=\'iw_bt_over\'" onmouseout="this.className=\'iw_bt\'" onmousedown="this.className=\'iw_bt_down\'" onmouseup="this.className=\'iw_bt_over\'" /></div>'),d.push("</form></div>")),e.hideFrom||(d.push('<div id="iw_tab1" class="nav_tab_content" style="display:'+r[2]+'">'),d.push('<form id="iw_e_frm">'),d.push('<div style="white-space:nowrap;"><span id="iw_esnSpan" class="iw_txt_wrap"><input id="iw_esn" type="text" size="22" maxlength="100" autocomplete="off" placeholder="请输入终点"/></span>'),d.push('<input id="iw_esb_btn" type="submit" value="公交" class="iw_bt" onmouseover="this.className=\'iw_bt_over\'" onmouseout="this.className=\'iw_bt\'" onmousedown="this.className=\'iw_bt_down\'" onmouseup="this.className=\'iw_bt_over\'"/>'),d.push('<input id="iw_esd_btn" type="button" value="驾车" class="iw_bt" onmouseover="this.className=\'iw_bt_over\'" onmouseout="this.className=\'iw_bt\'" onmousedown="this.className=\'iw_bt_down\'" onmouseup="this.className=\'iw_bt_over\'" /></div>'),d.push("</form></div>")),e.hideNear||(d.push('<div id="iw_tab2" class="nav_tab_content" style="white-space:nowrap;display:'+r[0]+'">'),d.push('<div class="iw_cate_form">'),d.push('<form  class="info_form" >'),d.push('<input id="rangekw" type="text" size="19" maxLength="100" autocomplete="off" placeholder="搜索周边信息"/> '),d.push('<input id="iw_ns_btn" tid="iwNSBtn" type="submit" value="搜索" class="iw_bt" onmouseover="this.className=\'iw_bt_over\'" onmouseout="this.className=\'iw_bt\'" onmousedown="this.className=\'iw_bt_down\'" onmouseup="this.className=\'iw_bt_over\'" />'),d.push("</form></div>")),d.push('<div class="iw_cate_list">');var c=["酒店","餐馆","银行","医院","公交站"],p=e.isFromMPC?1:0,u=e.cityCode||v.cityCode;if(a)for(var h=0,_=c.length;_>h;h++){var f=this.generateSingleLink(c[h],a,"",u,0===h,e.x+", "+e.y,p);d.push(f)}else for(var h=0,_=c.length;_>h;h++){var f=this.generateSingleLinkForRange(c[h],e.x+","+e.y,"",u,0===h,null,e.statCode||0,p,t);d.push(f)}return d.push("</div></div>"),d.push("</div>"),d.join("")},createInfWindow:function(e,i){this.opts=this.opts||{};var a=this,t=345,n=new BMap.InfoWindow(i,{title:e,height:0,width:t,margin:[10,10,70,10]});return n.addEventListener("open",function(){var e=n.overlay.getLabel();e&&e._indoor&&e.hide(),map.infoWindow.closeButton&&!map.infoWindow.closeButton._statBinded&&(map.infoWindow.closeButton._statBinded=!0),a.bindInfoEvents(this)}),n.addEventListener("close",function(){var e=n.overlay.getLabel();e&&e._indoor&&e.show()}),n},bindInfoEvents:function(){var e=this,i=this.content||{},a=this.opts||{},t=(i.title,i.addr),n=(i.desc,i.tel&&i.tel.replace(/(,|;)/gi,", "),i.uid||""),o=i.poiType||c.POI_TYPE_NORMAL,s=(i.hasDetail,i.ext||{}),r=(i.transUid,i.fav||0),d=(i.content,i.bizType,a.tabIndex,a.cityCode||v.cityCode),l="",_="",m="",g=a.x+" "+a.y,b=parseFloat(a.x)+"|"+parseFloat(a.y),S=i.userSign||0,I=i.origin_id&&i.origin_id.overview_guid?i.origin_id.overview_guid:"",C=i.pano||0,k=i.indoor_pano||0,x="undefined"==typeof i.pano_index?-1:i.pano_index,P=i.wd||"",R=i.street_id||"",M=s.detail_info&&s.detail_info.tag,B="ktv"===M?"ktv":s.src_name;T(".BMap_bubble_content").delegate(".head-img img","click",function(){addStat("poiinfowin.headimg."+B)}).delegate(".panoInfoBox","click",function(){addStat("poiinfowin.pano."+B)}).delegate("[data-room-id]","click",function(){addStat("poiinfowin.book."+B)}).delegate(".async-book-link","click",function(){addStat("poiinfowin.morebook."+B)}).delegate("[tid=iw_poi_detail] a","click",function(){var e=T(this).text();"百度旅游"===e?addStat("poiinfowin.baidutravel."+B):"去哪儿"===e?addStat("poiinfowin.qunatravel."+B):"同程旅游"===e?addStat("poiinfowin.tongchengtravel."+B):"大众点评"===e&&addStat("poiinfowin.dazhongtravel."+B)}).delegate(".hotel-order-new","click",function(){addStat("poiinfowin.hotelorder."+B)}).delegate(".groupon","click",function(){addStat("poiinfowin.groupon."+B)}).delegate(".movie-info-newest","click",function(){addStat("poiinfowin.movienew."+B)}).delegate(".movieOrderBtn","click",function(){addStat("poiinfowin.moviebook."+B)}),(C||!C&&k)&&(baidu("#userSignCtrl .panoBtn").on("click",function(e){var i=a.isFromMPC?R:n;w.showPano({research:!0,panoType:!C&&k?"inter":"street",searchParam:{uid:i,index:x,addr:t,from:"infownd|poi",wd:P}}),addStat(STAT_CODE.STAT_STREETVIEW,{from:"infownd",catalog:"poi",uid:i}),e.preventDefault()}),baidu(".iw_poi_conTop .panoInfoBox").on("click",function(e){var i="street";addStat(STAT_CODE.STAT_PANORAMA,{catalog:"poi",from:"infownd",item:i});var t=a.isFromMPC?R:n;!C&&k&&(i="inter",t=n),w.showPano({research:!0,panoType:i,searchParam:{uid:t,index:x,from:"infownd|poi",wd:P}}),e.preventDefault(),s&&window.place.placeHookPano(s,"iw")}),baidu(".iw_poi_conTop .pano_box").on("click",function(e){var i="street";addStat(STAT_CODE.STAT_PANORAMA,{catalog:"poi",from:"infownd",item:i});var t=a.isFromMPC?R:n;!C&&k&&(i="inter",t=n),w.showPano({research:!0,panoType:i,searchParam:{uid:t,index:x,from:"infownd|poi",wd:P}}),e.preventDefault(),s&&window.place.placeHookPano(s,"iw")}),baidu(".iw_poi_conTop .indoor_pano_box").on("click",function(e){addStat(STAT_CODE.STAT_PANORAMA,{catalog:"poi",from:"infownd",item:"inter"});var i=a.isFromMPC?R:n;w.showPano({research:!0,panoType:"inter",searchParam:{uid:i,index:x,from:"infownd|poi",wd:P}}),e.preventDefault(),s&&window.place.placeHookPano(s,"iw")}),baidu(".iw_poi_conTop  .pano_thumnail_img").on("error",function(){Pano.PanoEntranceUtil&&Pano.PanoEntranceUtil.thumbnailNotFound(this,323,101)})),baidu(".userShowCtrl").on("mouseout",function(i){var a=baidu(this).data("nosign");a&&e.iwMenuMouseOut(this,i)}),baidu(".userShowCtrl").on("mousemove",function(){var e=baidu(this).data("nosign");e&&(y({x:event.clientX,y:event.clientY},T.g("iw_tool_icon"),T.g("iw_tool_box"),!1,event.timeStamp||(new Date).getTime(),function(){T.g("iw_tool_icon").className="box",T.g("iw_tool_box").style.top="-2000px"})||(T.g("iw_tool_icon").className="box",T.g("iw_tool_box").style.top="-2000px"))}),S&&!r&&(baidu(".userShowCtrl .sign_edit").on("click",function(){MapSignInst.editInfoWnd({type:"button"})}),baidu(".userShowCtrl .sign_del").on("click",function(){MapSignInst.deletePoint()})),baidu(".userShowCtrl .fuck").on("click",function(){addStat("poiinfowin.share.bubbleshare"),p.goShare({uid:n,cityCode:d,title:l,addr:_,tel:m,point:g})}),baidu(".userShowCtrl .fav").on("click",function(){addStat("poiinfowin.share.bubbleshare"),addStat(STAT_CODE.STAT_FAV_IW_BTN);var t=T(this),o=t.data("cont"),s=t.data("title");if(t.hasClass("has_fav")){if(i.sid)u.removeFav(i.sid);else if(n)u.removeFav(n,"uid");else{var r={name:e.content&&e.content.title,addr:e.content&&(e.content.addr||e.content.content),pointStr:e.opts.x+","+e.opts.y},d=u.getSidByData(r);d&&u.removeFav(d)}(S||a.smp)&&(l=T.g("JiwFav"),l.className="fav",l.title="收藏")}else{if(S||a.smp){u.addFav(2,{name:s,content:o,x:a.x,y:a.y});var l=T.g("JiwFav");l.className="has_fav",l.title="取消收藏"}else u.addFav(1,{uid:n,name:s,x:a.x,y:a.y});addStat("newfav.poi.addfrombubble","click",{da_e_name:"pcmap3"})}}),baidu(".iw_tool_box .point").on("click",function(){addStat("poiinfowin.toolbar.mark");var e=baidu(this).data("cont"),i=baidu(this).data("title");p("searchPoiSign",{point:b,uid:n,cityCode:d,title:i,content:e,panoGuid:I})}),baidu("span.send_telf").on("click",function(e){addStat("poiinfowin.toolbar.poibubbletomb"),addStat(STAT_CODE.STAT_SHOUJI_SEND,{ct:"iw"}),f.ready(this,n,o,d,"iw",this.hasDetailPage),e.preventDefault()}),baidu("a.sms_jiucuo").on("click",function(){i.jiucuofr||"";addStat("poiinfowin.revision.revisionbtn")}),baidu("span.carIcon").on("click",function(e){addStat("poiinfowin.toolbar.poibubbletocar"),f.ready(this,n,o,d,"iw"),e.preventDefault()
}),baidu("ul.nav_tab").delegate("li","click",function(){var i=e.opts.isFromMPC?1:0,a=parseInt(baidu(this).data("tab")),t=i?"rangekw":"";e.switchInfoWndTab(a,t,!1,!1,!0)}),baidu(".iw_cate_form .info_form").on("submit",function(t){window.addStat("search.nearby.sn_btn","click",{da_e_name:"pcmap3"});var o="rangekw",s=null,r=a.cityCode||v.cityCode,d=null,l=a.x,c=a.y,p=a.isFromMPC?!0:!1,u=p?1:0,h=i.userSign;n?e.roundSearchByInput(o,n,s,r,d,l,c,p):e.rangeSearchByInput(o,l,c,null,r,null,a.statCode||0,u,h),t.preventDefault()}),baidu("div.iw_cate_list").delegate("a","click",function(i){var t=(Boolean(baidu(this).data("fst")),""),o=a.cityCode||v.cityCode,s=a.isFromMPC?1:0,r=r?r:0,d=a.statCode||0;n?e.roundSearchByLink(this,n,t,o,0,a.x,a.y,s):e.rangeSearchByLink(this,a.x,a.y,t,o,null,d,s,r),i.preventDefault()}),I&&baidu("span.pano_iw").on("click",function(){h.show360FullViewMap(I,{wd:i.title,code:""})})},goCorrect:function(){},openSearchInfoWndPOI:function(e,i,a){if(window.GRControll){var t=window.GRControll.ifChangeMap();0!=t.f&&window.GRControll.setGRequestFlg(2e3)}this.openSearchInfoWnd(e,i,a)},openSearchInfoWnd:function(i,a,t){if(!window.isPrint){var n=this,o=i._ext||{};if(o&&o.uid){var s=map.getBounds(),d=Math.min(s.minX,s.maxX),c=Math.max(s.minX,s.maxX),p=Math.min(s.minY,s.maxY),h=Math.max(s.minY,s.maxY),_="("+d+","+p+";"+c+","+h+")",f=(window.currentComponent&&window.currentComponent._className,window.currentComponent&&window.currentComponent.curKw||""),m={uid:o.uid,wd:f,b:_};o.placesrcname&&(m.place=1,m.category=o.placesrcname),addStat(STAT_CODE.STAT_USER_BEHAVIOUR_MINMING,m)}if(!t)var t={};if(i){var w=0;if(o&&o.detail_info){var g=o.detail_info;g.premium2&&"[object Array]"==Object.prototype.toString.call(g.premium2)&&g.premium2.length&&(w=1)}i.addEventListener("open",function(){var e=this.favObj;!function(){if(e){var i={name:n.content&&n.content.title,addr:n.content&&(n.content.addr||n.content.content),pointStr:n.opts.x+","+n.opts.y};if(1===e.isfav||u.getModelByUid(e.uid)||u.getSidByData(i)){var a=T.g("JiwFav");a.className="has_fav",a.title="取消收藏"}n.removeFavHandler=function(i,t){for(var n=0;n<t.length;n++)if(t[n].uid===e.uid){a=T.g("JiwFav"),a.className="fav",a.title="收藏";break}},listener.on("fav.poi.model","remove",n.removeFavHandler),n.addFavHandler=function(i,t){for(var n=0;n<t.length;n++)if(t[n].uid===e.uid){a=T.g("JiwFav"),a.className="has_fav",a.title="取消收藏";break}},listener.on("fav.poi.model","add",n.addFavHandler),n.renameHandler=function(i,a){if(a.uid===e.uid){var t=a.name;t.replace(/[\u0100-\uffff]/g,"##").length>20&&(t=t.substring(0,9)+"..."),T(".iw_poi_title .title").text(t)}},listener.on("fav.poi.model","rename",n.renameHandler)}}(),r(this,o);var a="gr"==t.from||"poisearch"==t.from||"searchinview"==t.from;n.rangeSearchCenterMarker&&a&&l.getOverlayPoint(n.rangeSearchCenterMarker)!=l.getOverlayPoint(i)&&n.switchInfoWndTab(0,"iw_ssn"),n.iwExt=o,n.iwOpts=t,T.on(T.G("iw_s_frm"),"submit",function(e){window.addStat("search.goinghere.bus_bt","click",{da_e_name:"pcmap3"}),n.iwNavSubmit(e)}),T.on(T.G("iw_e_frm"),"submit",function(e){window.addStat("search.fromhere.bus_bt","click",{da_e_name:"pcmap3"}),n.iwNavSubmit(e)}),T.on(T.G("iw_ssd_btn"),"click",function(e){window.addStat("search.goinghere.driver_bt","click",{da_e_name:"pcmap3"}),n.iwNavSubmit(e)}),T.on(T.G("iw_esd_btn"),"click",function(e){window.addStat("search.fromhere.driver_bt","click",{da_e_name:"pcmap3"}),n.iwNavSubmit(e)}),i.removeEventListener("open",arguments.callee)}),i.addEventListener("close",function(){i.iw_sugg_0&&(i.iw_sugg_0.disposeSug(),i.iw_sugg_0=null),i.iw_sugg_1&&(i.iw_sugg_1.disposeSug(),i.iw_sugg_1=null),i.removeEventListener("close",arguments.callee),listener.off("fav.poi.model","add",n.addFavHandler),listener.off("fav.poi.model","remove",n.removeFavHandler),listener.off("fav.poi.model","rename",n.renameHandler),addStat("poiinfowin.toolbar.close")}),t&&t.notMove&&i.disableAutoPan(),t&&t.pano&&t.panoPoint?e.async("pano:widget/PanoEntranceUtil/PanoEntranceUtil.js",function(e){e.addPanoEntranceInInfoWindow(i,t.panoPoint,function(e){e&&e.length>0&&(i=e[0],a&&a.openInfoWindow(i,t))})}):a?a.openInfoWindow(i,t):map.openInfoWindow(i,t)}}},switchInfoWndTab:function(e,i,a,t,n){var o=[T.G("nav_tab0"),T.G("nav_tab1"),T.G("nav_tab2")],s=[T.G("iw_tab0"),T.G("iw_tab1"),T.G("iw_tab2")];if(!o[e]||!o[e].className.match(/hover/)||a){if(T.ac(o[e],"hover"),n)switch(e){case 0:addStat("poiinfowin.tabexchange.goinghere");break;case 1:addStat("poiinfowin.tabexchange.fromhere");break;case 2:addStat("poiinfowin.tabexchange.searchnb")}s[e]&&(s[e].style.display="block");for(var r=0,d=o.length;d>r;r++)r!=e&&(T.rc(o[r],"hover"),s[r].style.display="none");if(i&&T.G(i))try{T.G(i).focus()}catch(l){setTimeout(function(){try{T.G(i).focus()}catch(e){}},100)}}},generateSingleLink:function(e,i,a,t,n,o,s){return n?"<a href='javascript:void(0)' tid='iwNSLink' data-fst='"+n+"'  class='first'>"+e+"</a>":"<a href='javascript:void(0)' data-fst='"+n+"' >"+e+"</a>"},generateSingleLinkForRange:function(e,i,a,t,n,o,s,r,d){d=d?d:0;return n?"<a href='javascript:void(0)' class='first' >"+e+"</a>":"<a href='javascript:void(0)' >"+e+"</a>"},roundSearchByLink:function(e,i,a,t,n,o,s,r){var d=r?1:0;if("a"==e.nodeName.toLowerCase()){var l=e.innerHTML;if(l){var c=n||0;switch(this.roundSearchByValue(l,i,a,t,c,o,s,d),e.innerHTML){case"银行":addStat("poiinfowin.nbsearch.bank");break;case"酒店":addStat("poiinfowin.nbsearch.hotel");break;case"医院":addStat("poiinfowin.nbsearch.hospital");break;case"餐馆":addStat("poiinfowin.nbsearch.restaurant");break;case"公交站":addStat("poiinfowin.nbsearch.busstation");break;default:addStat("poiinfowin.nbsearch.userinput")}}}},roundSearchByInput:function(e,i,a,t,n,o,s,r){var d=r?1:0;if(T.G(e)){if(!T.G(e).value)return T.G(e).focus(),!1;var c=n||1;this.roundSearchByValue(l.filtQuery(T.G(e).value),i,a,t,c,o,s,d),addStat("poiinfowin.rangesearch.userinput")}},roundSearchByValue:function(e,i,a,t,n,o,s,r,d){var l=1e3;if(e){if(null!==r)var c=1e3;else var c=window.GRControll?window.GRControll.GRCircleRadius:l;a&&T.G(a)&&(c=T.G(a).value);var p={r:c,c:t,wd:encodeURIComponent(e),nbtp:n,nb_x:o,nb_y:s};if(r)p.spotclick=1;else for(var u in d)d.hasOwnProperty(u)&&(p[u]=encodeURIComponent(d[u]));this.roundSearch(i,p)}},roundSearch:function(e,i){var a="",i=i||{};i=statParamInterceptor(i),i.query&&(i.query=encodeURIComponent(i.query));for(var t in i)"undefined"!=typeof i[t]&&(a=a+"&"+t+"="+i[t]);var n="nb"+a+"&uid="+e,o=16;if(window.GRControll&&(window.GRControll.GRCircleRadius=i.r,window.GRControll.isGRCircleShow=!0,window.GRControll.setGRequestFlg(1500),window.GRControll.GRCircleRadius>1500&&(o=15),window.GRControll.GRCircleRadius>2500&&(o=14)),map.centerAndZoom(new BMap.Point(i.nb_x,i.nb_y),o),n.indexOf("b=")<0){var s=map.getBounds(),r=Math.min(s.minX,s.maxX),l=Math.max(s.minX,s.maxX),c=Math.min(s.minY,s.maxY),p=Math.max(s.minY,s.maxY);n+="&b=("+r+","+c+";"+l+","+p+")"}if(n.indexOf("l=")<0){var s=map.getBounds();n+="&l="+map.getZoom()}window.GRControll&&(window.GRControll.GRCircleRadius&&(n+="&gr_radius="+window.GRControll.GRCircleRadius),window.GRControll.openedMarker=null),g.active=!1,d.go(n+"&from=webmap",{cinfo:{oc:i.c,isnbSearch:!0}})},rangeSearchByInput:function(e,i,a,t,n,o,s,r,d){var c=r?1:0;if(T.G(e))if(T.G(e).value){var p=o||1;addStat("poiinfowin.rangesearch.userinput"),this.rangeSearchByValue(l.filtQuery(T.G(e).value),i,a,t,n,p,s,c,null,d)}else T.G(e).focus()},rangeSearchByLink:function(e,i,a,t,n,o,s,r,d){var l=r?1:0;if("a"==e.nodeName.toLowerCase()){var c=e.innerHTML;if(c){var p=o||0;switch(this.rangeSearchByValue(c,i,a,t,n,p,s,l,null,d),e.innerHTML){case"银行":addStat("poiinfowin.rangesearch.bank");break;case"酒店":addStat("poiinfowin.rangesearch.hotel");break;case"医院":addStat("poiinfowin.rangesearch.hospital");break;case"餐馆":addStat("poiinfowin.rangesearch.restaurant");break;case"公交站":addStat("poiinfowin.rangesearch.busstation");break;default:addStat("poiinfowin.rangesearch.userinput")}}}},rangeSearchByValue:function(e,i,a,t,n,o,s,r,d,l){if(n=v.cityCode,e){if(null!==r)var c=1e3;else var c=window.GRControll.GRCircleRadius;t&&T.G(t)&&(c=T.G(t).value),i=1*i,a=1*a,c=1*c;var p=i-c,u=a-c,h=i+c,_=a+c,f="("+p+","+u+";"+h+","+_+")",m={ar:f,wd:encodeURIComponent(e),c:n,bdtp:o,nb_x:i,nb_y:a,userSign:l};if(r)m.spotclick=1;else for(var w in d)d.hasOwnProperty(w)&&(m[w]=encodeURIComponent(d[w]));this.rangeSearch(m,new BMap.Point(i,a),c)}},rangeSearch:function(e,i,a){if(e){var t="";for(var n in e)"undefined"!=typeof e[n]&&(t=t+"&"+n+"="+e[n]);var o=16;window.GRControll&&(window.GRControll.GRCircleRadius=a,window.GRControll.isGRCircleShow=!0,window.GRControll.setGRequestFlg(1500),window.GRControll.GRCircleRadius>1500&&(o=15),window.GRControll.GRCircleRadius>2500&&(o=14)),map.centerAndZoom(i,o);var s="nb"+t;if(s.indexOf("b=")<0){var r=map.getBounds();s+="&b=("+r.minX+","+r.minY+";"+r.maxX+","+r.maxY+")"}if(s.indexOf("l=")<0){var r=map.getBounds();s+="&l="+map.getZoom()}var c="中心点";if(e.userSign){for(var u,h=p.mapSign.pointInfo.list,n=0;u=h[n];n++)if(u.point==i.lng+"|"+i.lat){c=u.title;break}}else if(this.rangeSearchCenterMarker)c=this.rangeSearchCenterMarker.getTitle();else for(var u,_=map.getOverlays(),n=0;u=_[n];n++){var f=l.getOverlayPoint(u);if(f&&f.lat==i.lat&&f.lng==i.lng){c=u.getTitle();break}}c||(c="中心点");var m=this.getCenterPoiNameCbk._uid?this.getCenterPoiNameCbk._uid:"";m&&(s+="&uid="+m),window.GRControll&&window.GRControll.GRCircleRadius&&(s+="&gr_radius="+window.GRControll.GRCircleRadius),g.active=!1,d.go(s+"&r="+a+"&from=webmap",{cinfo:{searchByContextMenu:!0,centerPoint:i,ctPoiName:c,radius:a,oc:e.c,uid:m,isnbSearch:!0}})}},getCenterPoiNameCbk:function(e){var i=this,a=map.getInfoWindow();if(a){var t=e.content;if(t&&t.address){var n=t.address;t.surround_poi&&t.surround_poi[0]&&(n=t.surround_poi[0].addr,this.getCenterPoiNameCbk._uid=t.surround_poi[0].uid);var o=a.getPoint?a.getPoint():a.GetPosition(),s=this.rangeSearchCenterMarker.getPoint?this.rangeSearchCenterMarker.getPoint():this.rangeSearchCenterMarker.GetPosition();if(o==s){var r="<p class='iw_poi_title' title='"+n+"'>"+n+"</p>";a.setTitle(r),this.rangeSearchCenterMarker.setTitle(n)}}}else window.setTimeout(function(){i.getCenterPoiNameCbk(e)},50)},createRangeInfoWnd:function(e){if(e){var i=this;return h.getGEORevertAddress(e,function(e){i.getCenterPoiNameCbk(e)}),this.createSearchInfoWnd({title:"未知地点",poiType:0},{x:e.lng,y:e.lat,statCode:"",tabIndex:0})}},exitRangeSearch:function(){this.rangeSearchCenterMarker&&(this.rangeSearchCenterMarker.remove(),this.rangeSearchCenterMarker=null)},iwNavSubmit:function(i){i=window.event||i;var a="",t="",n="sn",o="en",s="sc",r="ec",p="",u="",h={},f={},m=i.target||i.srcElement,w="",g=this.iwExt,b=this.iwOpts,S=g.c||v.cityCode,y="",I="",C="dep",k=_.getBusExpTime(),x=5,P=0;switch(m.id){case"iw_s_pano_frm":a="iw_pano_ssn",t="bt",n="en",o="sn",s="ec",r="sc",p="bus_end_input",u="bus_start_input",P=0,y="0",w="end";break;case"iw_ssd_pano_btn":a="iw_pano_ssn",t="nav",p="drive_end_input",u="drive_start_input",n="en",o="sn",s="ec",r="sc",P=0,I="0",w="end";break;case"iw_e_pano_frm":a="iw_pano_esn",t="bt",p="bus_start_input",u="bus_end_input",P=1,y=1,w="start";break;case"iw_esd_pano_btn":a="iw_pano_esn",t="nav",p="drive_start_input",u="drive_end_input",P=1,I=1,w="start";break;case"iw_s_frm":a="iw_ssn",t="bt",n="en",o="sn",s="ec",r="sc",p="bus_end_input",u="bus_start_input",P=0,y="0",w="end";break;case"iw_e_frm":a="iw_esn",t="bt",p="bus_start_input",u="bus_end_input",P=1,y=1,w="start";break;case"iw_ssd_btn":a="iw_ssn",t="nav",p="drive_end_input",u="drive_start_input",n="en",o="sn",s="ec",r="sc",P=0,I="0",w="end";break;case"iw_esd_btn":a="iw_esn",t="nav",p="drive_start_input",u="drive_end_input",P=1,I=1,w="start"}var R=T.g(a),M=T.string.trim(R.value),B=e("common:widget/com/RouteSearch/RouteSearch.js"),O=B.inputInfo[a];if(this.rangeSearchCenterMarker&&M==this.rangeSearchCenterMarker.getTitle()){var E=l.getOverlayPoint(this.rangeSearchCenterMarker);O.point=E.lng+","+E.lat,O.note=M,O.ccode=S}var N=O&&O.point&&O.note==M;if(R&&!/\S+/.test(M))return R.focus(),void(i.returnValue=!1);if(N){var G=g.name,U=O.note,j=encodeURIComponent(G),A=encodeURIComponent(U),F=g.pt.lng+","+g.pt.lat,L=O.point,D=g.c,$=O.ccode;h={c:S,pn:0,rn:5},h[n]="1$$$$"+F+"$$"+j+"$$$$$$",h[o]="1$$$$"+L+"$$"+A+"$$$$$$",h[s]=D,h[r]=$,B.inputInfo[p]={note:G,ccode:D,point:F},B.inputInfo[u]={note:U,ccode:$,point:L}}else{t="bt"==t?"bse":"nse";var W="pcmappg.routesrach.as"+w,Y=g.pt.lng+","+g.pt.lat,q=g.name||"",H=g.uid||"",z=g.wd2?1:0,J=g.wd2||"",V=M,X=g.poiType==c.POI_TYPE_BUSSTOP||g.poiType==c.POI_TYPE_SUBSTOP?0:1;h={c:S,da_src:W,poiType:g.poiType,ptx:g.pt.lng,pty:g.pt.lat,sug:z,wd:encodeURIComponent(V),wd2:encodeURIComponent(J),name:encodeURIComponent(q),isSingle:"true",nsetp:I,bsetp:y},h=statParamInterceptor(h),h.query&&(h.query=encodeURIComponent(h.query)),h[n]=X+"$$"+H+"$$"+Y+"$$"+encodeURIComponent(q)+"$$$$$$","bse"==t&&(h.exptype=C,h.exptime=k,h.version=x),f={cinfo:{q:t+"&"+l.jsonToQuery(h),c:S,t:P,isSingle:!0,kwn:{name:q,uid:H,pt:g.pt,poiType:g.poiType}},dom:T.g("MapInfo")};var K="iw_ssn"==a?p:u;B.inputInfo[K]={note:q,ccode:S,point:Y}}b&&b.isFromMPC&&(h.spotclick=1),window.GRControll&&window.GRControll.isGRequest&&(h.gr=5),1==g.geoloc&&(h.geoloc=1),("nav"==t||"nse"==t)&&(h.version=4,h.mrs=1,h.route_traffic=1);var Q=t+"&"+l.jsonToQuery(h),Z=h.poiType;d.go(Q,f),"start"==w?"bt"==t||"bse"==t?(Z==c.POI_TYPE_BUSSTOP?addStat("businfowin.tabexchange.fromhere",null,{da_attr:"bus"}):Z==c.POI_TYPE_SUBSTOP&&addStat("subinfowin.tabexchange.fromhere",null,{da_attr:"bus"}),addStat("poiinfowin.tabexchange.fromhere",null,{da_attr:"bus"})):("nav"==t||"nse"==t)&&(Z==c.POI_TYPE_BUSSTOP?addStat("businfowin.tabexchange.fromhere",null,{da_attr:"driving"}):Z==c.POI_TYPE_SUBSTOP&&addStat("subinfowin.tabexchange.fromhere",null,{da_attr:"driving"}),addStat("poiinfowin.tabexchange.fromhere",null,{da_attr:"driving"})):"end"==w&&("bt"==t||"bse"==t?(Z==c.POI_TYPE_BUSSTOP?addStat("businfowin.tabexchange.goinghere",null,{da_attr:"bus"}):Z==c.POI_TYPE_SUBSTOP&&addStat("subinfowin.tabexchange.goinghere",null,{da_attr:"bus"}),addStat("poiinfowin.tabexchange.goinghere",null,{da_attr:"bus"})):("nav"==t||"nse"==t)&&(Z==c.POI_TYPE_BUSSTOP?addStat("businfowin.tabexchange.goinghere",null,{da_attr:"driving"}):Z==c.POI_TYPE_SUBSTOP&&addStat("subinfowin.tabexchange.goinghere",null,{da_attr:"driving"}),addStat("poiinfowin.tabexchange.goinghere",null,{da_attr:"driving"}))),baidu.event.preventDefault(i)},iwMenuMouseOut:function(e,i){var a=T.g("iw_tool_box");i.relatedTarget=i.relatedTarget||i.toElement,i.target=i.target||i.fromElement,(i.relatedTarget!==e&&!baidu.dom.contains(e,i.relatedTarget)||(a===i.target||baidu.dom.contains(a,i.target))&&!baidu.dom.contains(a,i.relatedTarget))&&(T.g("iw_tool_icon").className="box",T.g("iw_tool_box").style.top="-2000px")}};a.exports=I});
;define("common:widget/ui/Pc2Mobile/Pc2Mobile.js",function(e,i,o){var t=(e("common:widget/ui/stat/CodeStat.js"),e("common:widget/ui/util/util.js")),n=e("common:widget/ui/ui3MobileDownload/ui3MobileDownload.js"),d={box:null,init:function(){var e=this;this.box=T.dom.create("div",{id:"pc2mobile_cover"}),this._innerFun=function(){e.resize()},T.on(window,"resize",this._innerFun)},show:function(){var e=this.box;document.body.appendChild(e),this.resize()},hide:function(){var e=this;e.box&&document.body.removeChild(e.box),e.clear()},resize:function(){if(this.box){var e=this.box,i=t.getClientSize();6==T.browser.ie&&(e.style.width=i.width+"px",e.style.height=i.height+"px")}},clear:function(){this._innerFun&&(T.un(window,"resize",this._innerFun),delete this._innerFun),delete this.box}},s={popup:null,component:null,open:function(e,i,o){switch(o=o||{},i){case"城市推广安卓按钮":addStat("sendtodevice.sendtomb.citylisttodevicebyand");break;case"城市推广ios按钮":addStat("sendtodevice.sendtomb.citylisttodevicebyios");break;case"公交安卓按钮":addStat("sendtodevice.sendtomb.bltodevicebyandroid");break;case"公交ios按钮":addStat("sendtodevice.sendtomb.bltodevicebyios");break;case"POI安卓按钮":addStat("sendtodevice.sendtomb.poitodevicebyandroid");break;case"POIios按钮":addStat("sendtodevice.sendtomb.poitodevicebyios");break;case"短信窗口安卓按钮":addStat("sendtodevice.sendtomb.smstodevicebyandroid");break;case"短信窗口ios按钮":addStat("sendtodevice.sendtomb.smstodevicebyios");break;case"下载页安卓按钮":addStat("sendtodevice.sendtomb.downpagetodevicebyandroid");break;case"下载页ios按钮":addStat("sendtodevice.sendtomb.downpagetodevicebyios");break;case"收藏栏":addStat("sendtodevice.sendtomb.favouritetodevice")}if(e){e=e.toUpperCase();var t={from:e,realfrom:i};o.qudao&&(t.qudao=o.qudao),o.pref&&(t.pref=o.pref),this._open(t)}},close:function(){this.popup&&this.popup.close()},_open:function(){n.openPop({backgroundImg:"http://webmap2.map.bdstatic.com/wolfman/static/common/images/ui3/luhan_23282dd.png",contentList:["1元拼车上下班，省时省力又环保","步行导航赢大奖，健康活力走起","出行赔付诚意邀您纠错","51元住酒店，疯狂比价疯狂返"],qudao:"1009177q",subTitle:"出门就靠百度地图！",tctitle:"下载百度手机地图",versionAndriodImg:"http://bcscdn.baidu.com/opnimg/281ca6a86f1210c5c1ffc67dac0e2af5.png",versionIphoneImg:"http://bcscdn.baidu.com/opnimg/4dfb025bdb6b07d97447d2ca9a92882e.png"})},clear:function(e){if(this._escFun){var i=T.browser.ie&&T.browser.ie<=7?"keypress":"keydown";T.un(window.document,i,this._escFun),this._escFun=null}d.hide(),e=null},addTip:function(){var e=this;"2"===T.cookie.get("Maptodowntip")||window.isPrint||baidu(document.body).insertHTML("beforeend",'<div id="MaptoDown_tip" class="search-tip"><i title="关闭" class="close">关闭</i><div class="inner"><div class="lk-btn1"><a  href="javascript:void(0)">离线使用，省90%流量！</a></div></div><a  href="javascript:void(0)" class="moIndexTip">立即下载</a></div>'),listener.on("fullScreen","inFullScreen",this.hide,this),listener.on("fullScreen","outFullScreen",this.show,this),baidu("#MaptoDown_tip").on("click",function(){e.open("IMG","检索框tip"),addStat("indexheader.clientdownpage.searchboxtip")}),baidu("#MaptoDown_tip i").on("click",function(i){e.removeTip(),i.stopPropagation(),i.preventDefault()})},removeTip:function(){listener.off("fullScreen","inFullScreen",this.hide,this),listener.off("fullScreen","outFullScreen",this.show,this);var e=T.g("MaptoDown_tip");baidu.dom.remove(e),T.cookie.set("Maptodowntip","2",{expires:6048e5})},show:function(){T("#MaptoDown_tip").css("display","block")},hide:function(){T("#MaptoDown_tip").css("display","none")}};o.exports=window.PcToMobile=s});
;define("common:widget/ui/BannerAds/BannerAds.js",function(a,n,e){var i=a("common:widget/ui/config/config.js"),t=i.mapConfig;e.exports={init:function(){{var a=window._OLR?baidu.json.parse(_OLR.index)||{}:{},n=a.special&&a.special.data,e=n.banner||[];n.top||[],n.bottom||[]}e.length>0&&this.createBanner(e),addStat("indexheader.pcads.pcads","show")},createBanner:function(a){var n=a.length,e=parseInt(Math.random()*n),i=a[e],r="",d="";"image"==i.type&&T.trim(i.pic_url).length>0&&(r='<a  href="#{0}" target="_blank" ><img src="http://webmap3.map.bdimg.com/maps/services/thumbnails?width=300&height=110&quality=100&align=center,center&src=#{1}" /></a>',d=encodeURIComponent(t.host(i.pic_url)),r=baidu.string.format(r,[i.href,d]),baidu("#mapBanner").html(r)),this.bind(i)},bind:function(a){baidu("#mapBanner a").click(function(){addStat("indexheader.pcads.pcads","click",{da_par:a.title})})}}});
;define("common:widget/ui/earthTools/earthTools.js",function(require,exports,module){function EarthTools(t){this._map=t.map||map,this.defaultCursor=this._map.config.defaultCursor,this.draggingCursor=this._map.config.draggingCursor,this.startTop=10,this.startRight=9,this.defaultAnchor=BMAP_ANCHOR_TOP_RIGHT,this.defaultOffset=new BMap.Size(this.startRight,this.startTop),this._curCount=0,this._clickCount=0,this._getCountURL="http://map.baidu.com/opn/revo/counter/BaiduEarthLikeit/get?counter=click",this._postCountURL="http://"+location.host+"/opn/revo/counter/BaiduEarthLikeit/incr/?counter=click",this._earthClockIsOpen=!1,this._isClosing=!1}var util=require("common:widget/ui/util/util.js"),EarthClock=require("common:widget/ui/earthTools/earthClock.js"),comMgr=require("common:widget/com/componentManager.js"),config=require("common:widget/ui/config/config.js"),searchBox=require("common:widget/ui/ui3SearchBox/ui3SearchBox.js"),style=".earth-control-wrap{visibility:'hidden'}.earth-control-wrap span{float:left;width:29px;height:28px;background:url(http://webmap2.map.bdstatic.com/wolfman/static/common/images/earth-tools_1d3caa2.png) no-repeat;cursor:pointer}.earth-control-wrap .toggle-earth{display:none;background-position:0 0}.earth-control-wrap .toggle-earth.active{background-position:0 -28px}.earth-control-wrap .share-it{background-position:-29px 0}.earth-control-wrap .share-it.active{background-position:-29px -28px}.earth-control-wrap .like-it{width:62px;background-position:-58px 0;color:#A0ADBF;line-height:28px;text-indent:25px}.earth-control-wrap .like-it.active{color:#fff;background-position:-58px -28px}.earth-control-wrap #likeItTip{position:absolute;height:25px;line-height:25px;right:20px;top:0;display:none;font-size:18px;color:red;opacity:1;transition:all 2s;-moz-transition:all 2s;-webkit-transition:all 2s;-o-transition:all 2s}.earth-control-wrap .earth-clock-container{position:absolute;visibility:hidden;width:80px;height:80px;left:-80px;top:0}.earth-control-wrap .earth-clock-container canvas{width:80px;height:80px}";require.loadCss({content:style,name:"earthTools"}),EarthTools.prototype=new BMap.Control,T.extend(EarthTools.prototype,{initialize:function(){try{var tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div class="earth-control-wrap" id="earth_control_wrap">    <span id="earthClockBtn" map-on-click="toggleEarth" class="toggle-earth" title="地球时钟"></span>    <span map-on-click="shareIt" class="share-it" title="分享"></span>    <span map-on-click="likeIt" class="like-it" title="点赞" id=\'likeItNum\'>2000</span>    <div id=\'likeItTip\'>+1</div>    <div class="earth-clock-container"><canvas id="cvsEarthClock"></canvas></div></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],container=this.container=T(tpl()).appendTo(this._map.getContainer());return this.initEnv(),this.bindEvent(),container[0]}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"common:widget/ui/earthTools/earthTools.js",ln:64})}},initEnv:function(){var t=this;T.jsonp(this._getCountURL,function(i){var e=i.data.click,o=t.formatNum(e);T("#likeItNum").text(o),t._curCount=parseInt(e,10)});var i=T(".earth-clock-container")[0];this._clockContainer=i;var e=T("#cvsEarthClock")[0],o=i.offsetWidth,a=i.offsetHeight;e.width=o,e.height=a,this._earthClock=new EarthClock(e)},formatNum:function(t){var i=1e4;if(i>t)return t.toString();var e=(t/i).toFixed(2).toString();return e.lastIndexOf(".00")>-1&&(e=e.replace(".00","")),e+"万"},bindEvent:function(){var t=this.container,i=t.find("span"),e=this;t.delegate("span","click",function(){var t=T(this),i=e[t.attr("map-on-click")];"function"==typeof i&&i.call(e,t)}).delegate("span","mouseover",function(){i.removeClass("active"),T(this).addClass("active")}).delegate("span","mouseout",function(){i.removeClass("active")}).delegate("span","dblclick",function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}).delegate("div","dblclick",function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0});var o=this._map;o.addEventListener("maptypechange",function(){e.stopEarth(!0);var t=window.temp.linkPop;t&&t.visible&&t.close()}),o.addEventListener("resize",function(){e.setEarthClockPosition()}),o.addEventListener("onsunlighttime_change",function(t){e._isClosing=!1;var i=t.timeForSunLight,o=i.hour,a=i.minute,n=new Date;n.setHours(o),n.setMinutes(a);var r=n.getTime();e._earthClock.showTime(r);var s=e._clockContainer;"hidden"===T.dom(s).getCurrentStyle("visibility")&&(s.style.visibility="visible")}),o.addEventListener("onsunlighttime_clear",function(){e.stopEarth()})},closeCurQuery:function(t){searchBox.setQuery(),T("#clearMapArea").css("display","none"),window.poi2RouteSearchName=void 0,comMgr.go("cur&wd="+encodeURIComponent("全国"),{cinfo:{from:"earth_close"}},t)},isEarthClockOpened:function(){return this._earthClockIsOpen},isEarthClockOpening:function(){return this._isClosing},startEarth:function(){map.startSunLightAnimation(),this._earthClockIsOpen=!0,this.setEarthClockBtnStatus()},stopEarth:function(t){var i=this._clockContainer;i.style.visibility="hidden",map.stopSunLightAnimation(t),this._earthClockIsOpen=!1,this.setEarthClockBtnStatus()},setEarthClockBtnStatus:function(){var t=T("#earthClockBtn")[0];t.style.backgroundPosition=this._earthClockIsOpen?"0 -56px":""},toggleEarth:function(){if(!this._isClosing&&!this._map.getLock()){if(this._earthClockIsOpen)this.stopEarth();else{var t=this;t._isClosing=!0,t.closeCurQuery(function(){t.startEarth()}),addStat("earth.clock","click",{da_e_name:"pcmapearth"})}this._isInitClockPos||(this._isInitClockPos=!0,this.setEarthClockPosition())}},setEarthClockPosition:function(){var t=this._clockContainer,i=t.offsetWidth,e=map.getSize(),o=e.width,a=o/2+i/2-this.container[0].offsetWidth-this.startRight;t.style.left=-a+"px"},shareIt:function(){require.async("common:widget/ui/toolShare/ToolShare.js",function(t){var i=window.temp.linkPop;i&&i.visible?i.close():t.open()}),addStat("earth.share","click",{da_e_name:"pcmapearth"})},likeIt:function(){if(0===this._clickCount){var t=this.formatNum(++this._curCount);T("#likeItNum").text(t),T.ajax(this._postCountURL,{method:"post",dataType:"json"});var i=T("#likeItTip")[0];i.style.display="block",setTimeout(function(){i.style.top="-100px",i.style.opacity=0},100)}this._clickCount++,addStat("earth.like","click",{da_e_name:"pcmapearth"})}}),module.exports={init:function(){window.earthTools=new EarthTools(map),map.addControl(window.earthTools)}}});
;define("common:widget/ui/earthTools/earthClock.js",function(t,i,e){function h(t){var i=t.getContext("2d");this._canvas=t,this._ctx=i,this._ctxWidth=t.width,this._ctxHeight=t.height,this._date=new Date}var a="#A0ADBF",n=3,o=25,r="#A0ADBF",s=2,c=30,l="rgba(12,13,44,0.51)",d="#A0ADBF",x="#A0ADBF",w=3,_=3,f=2,g=2,u="#A0ADBF";T.extend(h.prototype,{drawLine:function(t,i,e,h,a,n,o,r,s,c){t.save(),t.lineWidth=i,t.strokeStyle=e,t.translate(s,c),t.rotate(r),t.beginPath(),t.moveTo(h,a),t.lineTo(n,o),t.closePath(),t.stroke(),t.restore()},drawCircle:function(t,i,e,h,a,n,o){t.save(),t.lineWidth=i,t.strokeStyle=h,t.fillStyle=e,t.beginPath(),t.arc(a,n,o,0,2*Math.PI,!1),t.closePath(),t.fill(),t.restore()},drawHorizontalLine:function(t,i,e,h,a,n,o,r,s){this.drawLine(t,i,h,a,n,a+e,n,o,r,s)},drawClockPanel:function(t){var i=3,e=l,h=d,a=this._ctxWidth/2,n=this._ctxHeight/2,o=this._ctxWidth/2-3;this.drawCircle(t,i,e,h,a,n,o)},drawScales:function(t){for(var i=0;12>i;i++)0!==i&&3!==i&&6!==i&&9!==i&&this.drawHorizontalLine(t,f,g,x,36-g,0,30*i*Math.PI/180,this._ctxWidth/2,this._ctxHeight/2);for(var i=0;4>i;i++)this.drawHorizontalLine(t,i%3===0?1.2*w:w,i%3===0?1.2*_:_,x,36-_,0,90*i*Math.PI/180,this._ctxWidth/2,this._ctxHeight/2)},drawHourPoint:function(t,i){this.drawHorizontalLine(t,n,o,a,0,0,30*(i-3)*Math.PI/180,this._ctxWidth/2,this._ctxHeight/2)},drawMinPoint:function(t,i){this.drawHorizontalLine(t,s,c,r,0,0,6*(i-15)*Math.PI/180,this._ctxWidth/2,this._ctxHeight/2)},drawText:function(t,i,e){t.fillStyle=u,t.font="bold 12px arial",i=1===i.toString().length?"0"+i:i,e=1===e.toString().length?"0"+e:e,t.fillText(i+":"+e,22,60)},showTime:function(t){var i=this._ctx,e=this._date;i.clearRect(0,0,this._ctxWidth,this._ctxHeight),this.drawClockPanel(i),this.drawScales(i),e.setTime(t);var h=e.getMinutes(),a=e.getHours(),n=a+h/60;this.drawHourPoint(i,n),this.drawMinPoint(i,h),this.drawText(i,a,h)}}),e.exports=h});