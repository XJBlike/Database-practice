define("common:widget/com/BaseComponent.js",function(o,e,n){function t(o){T.lang.Class.call(this),this.dom=o.dom,this.opts=o||{},this.$parentEl=T(this.opts.dom),this.json=this.opts.json,this.cinfo=this.opts.cinfo||{},this.name=this.opts.name}T.inherits(t,T.lang.Class,"BaseComponent"),T.extend(t.prototype,{render:function(){try{return!0}catch(o){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:o.message||o.description,path:"common:widget/com/BaseComponent.js",ln:28})}},initialize:function(){try{}catch(o){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:o.message||o.description,path:"common:widget/com/BaseComponent.js",ln:33})}},unload:function(o){this.removeFromManager(o)},removeFromManager:function(){var e=o("common:widget/com/componentManager.js");e.remove(this._className)}}),n.exports=t});
;define("common:widget/com/MapComponent.js",function(e,t,o){function i(e){e=e||{},window.currentComponent=this,e.cinfo=e.cinfo||{},this.dom=e.dom=T("#MapInfo"),this.modelQuery=e.url,this.isMainRequest="no"===e.isMainRequest?!1:!0,this.startCity={name:m.cityName,code:m.cityCode},(null==e.cinfo.city||null==e.cinfo.city.name)&&(e.cinfo.startCity={name:this.startCity.name,code:this.startCity.code}),map.enableLoadTiles=!0,n.call(this,e);var t=!0;"record"in e&&(t=e.record),t&&r.record(e),this.isMainRequest&&map.clearOverlays(),map.fullScreenMode&&e.cinfo&&e.cinfo.exitLargeMapMode&&window.fullScreenCtrl&&window.fullScreenCtrl.exitFull(!0),this.isMainRequest&&this.json&&this.json.result&&!c.active&&(11==this.json.result.type||1==this.json.result.type||36==this.json.result.type||2==this.json.result.type)?(m.enableMapMove=!1,window.mapMoveTimer&&clearTimeout(window.mapMoveTimer),window.mapMoveTimer=setTimeout(function(){m.enableMapMove=!0},4e3)):this.isMainRequest&&(window.mapMoveTimer&&clearTimeout(window.mapMoveTimer),m.enableMapMove=!0),this.resizeContent(this.name)}var n=e("common:widget/com/BaseComponent.js"),s=e("common:widget/ui/searchData/searchData.js"),a=e("common:widget/ui/config/config.js"),r=e("common:widget/ui/history/history.js"),m=a.modelConfig,c=e("common:widget/ui/Weather/Weather.js"),d=e("common:widget/ui/util/util.js"),u=e("common:widget/com/componentManager.js"),l=baidu("#RouteHeadWrapper"),p=baidu("#MapInfo");T.inherits(i,n,"MapComponent"),T.extend(i.prototype,{statusChange:function(e,t){this.modelQuery=e,s.fetch(e,t)},render:function(){try{return!0}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"common:widget/com/MapComponent.js",ln:116})}},initialize:function(){try{}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"common:widget/com/MapComponent.js",ln:121})}},resizeContent:function(e){var t=d.getMapSize(),o=t.height,i=u.isRouteModel(e)?l.outerHeight():0;p.height(o-i)},unload:function(){this.removeFromManager(),this.destroy&&this.destroy(),this.dom.html(""),n.prototype.unload.apply(this,arguments)}}),o.exports=i});
;define("common:widget/com/componentManager.js",function(require,exports,module){var searchData=require("common:widget/ui/searchData/searchData.js"),util=require("common:widget/ui/util/util.js"),sizeUtil=require("common:widget/ui/config/size.js"),constant=require("common:widget/ui/constant/Constant.js"),hisMgr=require("common:widget/ui/searchHistory/hisMgr.js"),toast=require("common:widget/ui/toast/toast.js"),moduleCode={1:"City",2:"City",5:"BusStops",6:"PoiSearch",7:"Clarify",11:"PoiSearch",13:"RouteAddr",14:"BusTrans",15:"LinesQuery",18:"BusLines",19:"RouteAddr",20:"NavTrans",21:"SearchInView",22:"BusTrans",23:"RouteAddr",24:"RouteAddr",26:"SpecialPoi",28:"District",29:"RouteAddr",31:"NavWalk",32:"NavBike",36:"PoiSearch",37:"Clarify",38:"PoiSearch",39:"SearchInView",40:"Clarify",41:"PoiAddr",48:"CBusTrans",49:"RouteAddr",50:"RouteAddr"},indexModelCode={0:"CountryIndex",1:"ProvinceIndex",2:"CityIndex",3:"AreaIndex"},historySearchModel={1:"s",2:"s",5:"s",6:"s",7:"s",11:"s",21:"bd",26:"s",28:"s",29:"s",36:"s",37:"s",38:"nb",39:"bd",40:"bd",41:"s"},historyLineModel={13:"bt",14:"bt",20:"nav",22:"bt",31:"walk",32:"cycle",48:"bt"},routeModel=["RouteSearch","RouteAddr","BusTrans","NavTrans","NavWalk","NavBike","CBusTrans"],searchModel=["City","CountryIndex","ProvinceIndex","AreaIndex","CityIndex","Clarify","PoiSearch","SearchInView"],printModel=["CountryIndex","ProvinceIndex","AreaIndex","CityIndex","PoiSearch","SearchInView","BusTrans","NavTrans","CBusTrans"],mainWrapper=baidu("#MapInfo"),routeWrapper=baidu("#RouteHeadWrapper"),components={},compMonitorFlag=!1,componentManager={start_event:0,compMonitorFlag:!1,go:function(param,opts,callback){var url="";"string"==typeof param?url=param:T.isObject(param)&&(url=baidu.url.jsonToQuery(param,null)),"function"==typeof opts&&(callback=opts,opts={}),opts=opts||{};var me=this;me.start_event=(new Date).getTime();var corePerfMonitor=window.corePerfMonitor;me.isCoreFunc(url)?corePerfMonitor&&!corePerfMonitor.firstRender&&(corePerfMonitor.searchStartTime=(new Date).getTime(),alog("cus.fire","count","z_start_search")):corePerfMonitor&&(corePerfMonitor.searchStartTime=null),searchData.fetch(url,function(json,options){var result=json.result,type=result.type,start=result.start,end=result.end,unKnowLine="未知路段";if(me.start_send=(new Date).getTime(),opts.json=json,opts.url=url,void 0===json.content&&(31===type||32===type)){T("#nav_container").hide(),T("#cbtContainer").hide();var plan=31===type?"步行":"骑行";return void toast.show("该"+plan+"方案无结果")}if(1&json.result.result_show)return map.setMapType(BMAP_SATELLITE_MAP),void map.showStreetLayer(!0);var componentName=moduleCode[type];if(componentName){if(compMonitorFlag=!0,!T.isString(componentName)&&componentName.defaultComponent){var selector=componentName;if(componentName=selector.defaultComponent,selector.special){var flag=!0;try{eval(selector.special.condition)||(flag=!1)}catch(e){flag=!1}flag&&(componentName=selector.special.component)}}if("City"==componentName){window.MapSignInst&&window.MapSignInst.unload();var subtype=json.content.city_type;componentName=indexModelCode[subtype]}baidu.array.contains(routeModel,componentName)?me.loadRoute(function(e){opts.routeCmp=e,opts.fromGo=!0,opts.searchDataType=options.type,me.load(componentName,opts,callback)}):me.loadPlaceAsync(function(){opts.fromGo=!0,opts.searchDataType=options.type,me.load(componentName,opts,callback)})}if(historySearchModel[type]){if(!result.wd)return void window.listener.trigger("loading","end",T("#MapInfo"));if(!opts.cinfo||!opts.cinfo.genRequestKey){var hisData={};hisData.qt=historySearchModel[type],hisData.wd=result.wd,result.where&&(hisData.wd2=result.where),hisMgr.setSearchData([hisData])}}else if(historyLineModel[type]){if(T("#history_bus_walk").hide(),T("#mapInfoWrapper").resize(),hisData={qt:historyLineModel[type],c:json.current_city.code+"",plankind:result.sy+""},start&&void 0!==start.wd&&""!==start.wd){if(start.wd===unKnowLine||end.wd===unKnowLine)return;if(hisData.sn={keyword:start.wd||unKnowLine,type:"1"},start.pt&&(hisData.sn.xy=start.pt),start.uid&&(hisData.sn.uid=start.uid),end.length>=1)for(var i=0;i<end.length;i++){var endPt={keyword:end[i].wd||unKnowLine,type:"1"};end[i].pt&&(endPt.xy=end[i].pt),end[i].uid&&(endPt.uid=end[i].uid),i===end.length-1?hisData.en=endPt:(hisData.wp||(hisData.wp=[]),hisData.wp.push(endPt))}else void 0!==end.wd&&""!==end.wd&&(hisData.en={keyword:end.wd||unKnowLine,type:"1"},end.pt&&(hisData.en.xy=end.pt),end.uid&&(hisData.en.uid=end.uid))}else if(void 0!==result.s_query&&void 0!==result.e_query){if(result.s_query===unKnowLine||result.e_query===unKnowLine)return;hisData.sn={keyword:result.s_query,type:"2"},hisData.en={keyword:result.e_query.length?result.e_query[0]:result.e_query,type:"2"}}hisMgr.setRouteData([hisData])}},function(){me.start_send=(new Date).getTime(),me.load("Error",{dom:mainWrapper})},opts.MapRevertOpts)},isCoreFunc:function(e){if(!e)return!1;0!==e.indexOf("qt=")&&(e="qt="+e);var t=e.split("&");if("string"!=typeof t[0])return!1;var o=t[0].split("=")[1],n={s:1,bd:1,nav:1,bt:1,walk:1};return n[o]?!0:!1},load:function(e,t,o){var n=this;t=t||{},t.dom=t.dom?T(t.dom):mainWrapper,t.name=e;var r={};require.async("common:widget/com/"+e+"/"+e+".js",function(a){n.transfer_time=(new Date).getTime();for(var i in components)null!=components[i]&&components[i].dom&&t.dom&&components[i].dom[0]===t.dom[0]&&t.isFromContextMenu!==!0&&(components[i].unload(components[i]._className,t),n.remove(i));if("Fav"!=e){var s=require("common:widget/ui/BoxContainer/BoxContainer.js");s.exit()}!window.currentComponent||"PoiSearch"!=currentComponent._className&&"SearchInView"!=currentComponent._className||(n.preModuleName=window.currentComponent._className);var c=new a(t);if(components[e]=c,!isPrint){var d=require("common:widget/ui/nav/nav.js"),u=require("common:widget/com/RouteSearch/RouteSearch.js");n.isRouteModel(e)?(sizeUtil.routeMode=!0,d.switchTab(2)):(sizeUtil.routeMode=!1,u.hide(),n.isSearchModel(e)&&d.switchTab(1))}n.setBeforeRender(c,t);var l=c.render();if(l&&"object"==typeof l)c.$parentEl.empty().append(c.$el);else if(l&&"string"==typeof l)c.$el=T(l),c.$parentEl.empty().append(c.$el);else if(!l)return;if(n.sendMonitorData(e,t),t.json&&n.setInitStatus(c,t),c.initialize(),"function"==typeof t.onload&&t.onload(c),o&&o(c),n.trigger(),n.start_send){var m="z_"+e.toLowerCase()+"_load_time",p=n.transfer_time-n.start_send;p>0&&(r[m]=p,alog("cus.fire","time",r))}})},isRouteModel:function(e){return baidu.array.contains(routeModel,e)},isSearchModel:function(e){return baidu.array.contains(searchModel,e)},trigger:function(){listener.trigger("com.subway","zindexchange"),baidu(window).trigger("resize",{from:"load"})},loadCity:function(e,t){window.corePerfMonitor&&!window.corePerfMonitor.firstRender&&(window.corePerfMonitor.searchStartTime=(new Date).getTime(),alog("cus.fire","count","z_start_search"));var o=e.content.city_type,n="CityIndex";switch(o){case constant.CITY_TYPE_NATION:n="CountryIndex";break;case constant.CITY_TYPE_PROV:n="ProvinceIndex";break;case constant.CITY_TYPE_CITY:n="CityIndex";break;case constant.CITY_TYPE_DIST:n="AreaIndex"}this.load(n,{json:e,cinfo:{cityInit:1,exitLargeMapMode:!1},fromGo:!0,onload:function(e){t&&t(e),baidu(window).trigger("resize",{from:"loadCity"})}})},loadRoute:function(e,t){t=t||{};var o=require("common:widget/com/RouteSearch/RouteSearch.js");o.show(1),listener.trigger("com.route","load",{}),"function"==typeof t.onload&&t.onload(),e&&e(o)},sendMonitorData:function(e,t){if(!window.isPrint&&window.corePerfMonitor){t=t||{};var o,n=window.corePerfMonitor;if(n.firstRender?o=(new Date).getTime()-n.pageStartTime:n.searchStartTime&&(o=(new Date).getTime()-n.searchStartTime),t.fromGo&&"fail"!==t.searchDataType&&!n.firstRender&&n.searchStartTime&&2e3>=o&&"Error"!==e&&alog("cus.fire","count","z_finish_render"),!n.components[e])return void(n.firstRender=!1);var r=["z_total_request"];"number"==typeof o&&o>2e3&&r.push("z_timeout_request"),alog("cus.fire","count",r),n.componentName=e;var a={};if(n.firstRender){var i="z_"+e.toLowerCase()+"_first";a[i]=o;var s="B_NORMAL_MAP"===n.firstLoadMapType?"normal":"satellite";if("CityIndex"===e&&n.tileLoadedTime)return n.firstRender=!1,a["z_mapload_first_"+s+"_cityindex"]=n.tileLoadedTime,alog("cus.fire","time",a),n.dataSent=!0,void map.removeEventListener("tilesloaded",n.onTilesLoad);n.sendTilesLoadData=!0,n.componentData={},n.componentData[i]=a[i]}else{if("CityIndex"===e)return;n.sendTilesLoadData=!0,a["z_"+e.toLowerCase()+"_search"]=o,alog("cus.fire","time",a)}}},get:function(e){return components[e]},remove:function(e){components[e]=null},setBeforeRender:function(e,t){try{var o=t.json||{},n=require("common:widget/ui/Weather/Weather.js"),r=require("common:widget/ui/indexUtil/IndexUtil.js"),a=require("common:widget/ui/config/config.js"),i=a.modelConfig,s=require("common:widget/com/Subway/SbwMgr.js");if(util.loadSearchInfo(function(e){e.rangeSearchCenterMarker&&(e.rangeSearchCenterMarker.remove(),e.rangeSearchCenterMarker=null)}),e.isMainRequest&&o.current_city){var c=o.current_city;n.active=i.cityName!==c.name&&!o.weather,r.setCurCity(o.current_city,{from:"com"}),i.upCityid=c.up_cityid?c.up_cityid:c.code,window.clearClarify=null}s.sbwInst&&s.sbwInst.unload(t)}catch(d){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:d.message||d.description,path:"common:widget/com/componentManager.js",ln:739})}},setInitStatus:function(e,t){var o=t.json||{},n=require("common:widget/ui/mapInfo/mapInfo.js"),r=require("common:widget/ui/fullScreen/fullScreen.js");o.hot_city&&window._OLR&&(window._OLR.hot_city=o.hot_city),1&o.result.result_show&&1==o.result.pattern_sign||window.GRControll&&window.GRControll.clearAfterGetAtBase(o),!map.fullScreenMode&&"close"!=n.status||window.GRControll&&window.GRControll.isGRequest&&!t.history||(map.fullScreenMode?o&&o.result&&2==o.result.type||t.cinfo&&0==t.cinfo.exitLargeMapMode||(r&&r.exitFull(void 0),"close"==n.status&&n.show()):"close"==n.status&&(o&&o.result&&2==o.result.type||t.cinfo&&0==t.cinfo.exitLargeMapMode||n.show()))},loadPrintCom:function(){},loadPlaceAsync:function(e){require.async(["common:widget/ui/place/place.js","common:widget/ui/place/placeEnter.js","common:widget/ui/place/caterPopInner.js"],function(t,o,n){t.placeEntrance=o,t.caterPopInner=n,window.place=t,e&&e()})},getLastSearchTime:function(e){return e?searchData.lastSearchTime[e]:searchData.lastSearchTime}};window.componentManager=componentManager,module.exports=componentManager});
;define("common:widget/view/View.js",function(e,i,n){function t(){T.lang.Class.call(this)}T.inherits(t,T.lang.Class,"View"),T.extend(t.prototype,{render:function(){try{return!0}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"common:widget/view/View.js",ln:11})}},initialize:function(){try{}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"common:widget/view/View.js",ln:15})}},unload:function(){}}),n.exports=t});
;define("common:widget/ui/areaCfg/areaCfg.js",function(n,a,e){var i="中国|1,安徽|23,福建|16,甘肃|6,广东|7,广西|17,贵州|24,海南|21,河北|25,黑龙江|2,河南|30,湖北|15,湖南|26,江苏|18,江西|31,吉林省|9,辽宁|19,内蒙古|22,宁夏|20,青海|11,山东|8,山西|10,陕西|27,四川|32,新疆|12,西藏|13,云南|28,浙江|29,北京|131,天津|332,石家庄|150,唐山|265,秦皇岛|148,邯郸|151,邢台|266,保定|307,张家口|264,承德|207,沧州|149,廊坊|191,衡水|208,太原|176,大同|355,阳泉|357,长治|356,晋城|290,朔州|237,晋中|238,运城|328,忻州|367,临汾|368,吕梁|327,呼和浩特|321,包头|229,乌海|123,赤峰|297,通辽|64,鄂尔多斯|283,呼伦贝尔|61,巴彦淖尔|169,乌兰察布|168,兴安盟|62,锡林郭勒盟|63,阿拉善盟|230,沈阳|58,大连|167,鞍山|320,抚顺|184,本溪|227,丹东|282,锦州|166,营口|281,阜新|59,辽阳|351,盘锦|228,铁岭|60,朝阳|280,葫芦岛|319,长春|53,吉林市|55,四平|56,辽源|183,通化|165,白山|57,松原|52,白城|51,延边朝鲜族自治州|54,哈尔滨|48,齐齐哈尔|41,鸡西|46,鹤岗|43,双鸭山|45,大庆|50,伊春|40,佳木斯|42,七台河|47,牡丹江|49,黑河|39,绥化|44,大兴安岭地区|38,上海|289,南京|315,无锡|317,徐州|316,常州|348,苏州|224,南通|161,连云港|347,淮安|162,盐城|223,扬州|346,镇江|160,泰州|276,宿迁|277,杭州|179,宁波|180,温州|178,嘉兴|334,湖州|294,绍兴|293,金华|333,衢州|243,舟山|245,台州|244,丽水|292,合肥|127,芜湖|129,蚌埠|126,淮南|250,马鞍山|358,淮北|253,铜陵|337,安庆|130,黄山|252,滁州|189,阜阳|128,宿州|370,巢湖|251,六安|298,亳州|188,池州|299,宣城|190,福州|300,厦门|194,莆田|195,三明|254,泉州|134,漳州|255,南平|133,龙岩|193,宁德|192,南昌|163,景德镇|225,萍乡|350,九江|349,新余|164,鹰潭|279,赣州|365,吉安|318,宜春|278,抚州|226,上饶|364,济南|288,青岛|236,淄博|354,枣庄|172,东营|174,烟台|326,潍坊|287,济宁|286,泰安|325,威海|175,日照|173,莱芜|124,临沂|234,德州|372,聊城|366,滨州|235,菏泽|353,郑州|268,开封|210,洛阳|153,平顶山|213,安阳|267,鹤壁|215,新乡|152,焦作|211,濮阳|209,许昌|155,漯河|344,三门峡|212,南阳|309,商丘|154,信阳|214,周口|308,驻马店|269,武汉|218,黄石|311,十堰|216,宜昌|270,襄樊|156,鄂州|122,荆门|217,孝感|310,荆州|157,黄冈|271,咸宁|362,随州|371,恩施土家族苗族自治州|373,仙桃|1713,潜江|1293,天门|2654,神农架林区|2734,长沙|158,株洲|222,湘潭|313,衡阳|159,邵阳|273,岳阳|220,常德|219,张家界|312,益阳|272,郴州|275,永州|314,怀化|363,娄底|221,湘西土家族苗族自治州|274,广州|257,韶关|137,深圳|340,珠海|140,汕头|303,佛山|138,江门|302,湛江|198,茂名|139,肇庆|338,惠州|301,梅州|141,汕尾|339,河源|200,阳江|199,清远|197,东莞|119,中山|187,潮州|201,揭阳|259,云浮|258,南宁|261,柳州|305,桂林|142,梧州|304,北海|295,防城港|204,钦州|145,贵港|341,玉林|361,百色|203,贺州|260,河池|143,来宾|202,崇左|144,海口|125,三亚|121,五指山|1644,琼海|2358,儋州|1215,文昌|2758,万宁|1216,东方|2634,定安|1214,屯昌|1641,澄迈|2757,临高|2033,白沙黎族自治|2359,昌江黎族自治|1642,乐东黎族自治|2032,陵水黎族自治|1643,保亭黎族苗族自治|1217,琼中黎族苗族自治|2031,重庆|132,成都|75,自贡|78,攀枝花|81,泸州|331,德阳|74,绵阳|240,广元|329,遂宁|330,内江|248,乐山|79,南充|291,眉山|77,宜宾|186,广安|241,达州|369,雅安|76,巴中|239,资阳|242,阿坝藏族羌族自治州|185,甘孜藏族自治州|73,凉山彝族自治州|80,贵阳|146,六盘水|147,遵义|262,安顺|263,铜仁地区|205,黔西南布依族苗族自治州|343,毕节地区|206,黔东南苗族侗族自治州|342,黔南布依族苗族自治州|306,昆明|104,曲靖|249,玉溪|106,保山|112,昭通|336,丽江|114,临沧|110,楚雄彝族自治州|105,红河哈尼族彝族自治州|107,文山壮族苗族自治州|177,普洱|108,西双版纳傣族自治州|109,大理白族自治州|111,德宏傣族景颇族自治州|116,怒江傈僳族自治州|113,迪庆藏族自治州|115,拉萨|100,昌都地区|99,山南地区|97,日喀则地区|102,那曲地区|101,阿里地区|103,林芝地区|98,西安|233,铜川|232,宝鸡|171,咸阳|323,渭南|170,延安|284,汉中|352,榆林|231,安康|324,商洛|285,兰州|36,嘉峪关|33,金昌|34,白银|35,天水|196,武威|118,张掖|117,平凉|359,酒泉|37,庆阳|135,定西|136,陇南|256,临夏回族自治州|182,甘南藏族自治州|247,西宁|66,海东地区|69,海北藏族自治州|67,黄南藏族自治州|70,海南藏族自治州|68,果洛藏族自治州|72,玉树藏族自治州|71,海西蒙古族藏族自治州|65,银川|360,石嘴山|335,吴忠|322,固原|246,中卫|181,乌鲁木齐|92,克拉玛依|95,吐鲁番地区|89,哈密地区|91,昌吉回族自治州|93,博尔塔拉蒙古自治州|88,巴音郭楞蒙古自治州|86,阿克苏地区|85,克孜勒苏柯尔克孜自治州|84,喀什地区|83,和田地区|82,伊犁哈萨克自治州|90,塔城地区|94,阿勒泰地区|96,石河子|770,阿拉尔|731,图木舒克|792,五家渠|789,香港特别行政区|2912,澳门特别行政区|2911,凤凰县|1724,台北|9002,高雄|9019,台中|9017,台南|9016,新北|9010,基隆|9011,新竹|9006,嘉义|9013".split(","),r=[];!function(){for(var n=0;n<i.length;n++){var a=i[n].split("|");r[a[0]]=a[1]}}(),null!=r["中国"]&&(r["全国"]=r["中国"]),e.exports=r});
;define("common:widget/ui/stat/CodeStat.js",function(e,t,r){function o(){var e={},t=document.referrer&&document.referrer.match(/^(?:(\w+):\/\/)?(?:(\w+):?(\w+)?@)?([^:\/\?#]+)(?::(\d+))?(\/[^\?#]+)?(?:\?([^#]+))?(?:#(\w+))?/);if(t)var r=t[4];else var r="";var o,n=T.url.queryToJson(location.search);if("www.hao123.com"==r?o="hao123":"www.baidu.com"==r?"alamap"==n.from?(o="阿拉丁",e.alatpl=n.tpl):(o="pstab",e.pstabDetail=-1==document.referrer.indexOf("word")?"搜索前":"搜索后"):""==r?o="自有用户":(o="其他来源",e.otherReferer=r),n.third_party&&(e.third_party=n.third_party),n.s){var a=n.s.substring(0,n.s.indexOf("%"));a&&(e.qt=a);var i=T.url.queryToJson(decodeURIComponent(n.s));i&&i.wd&&(e.wd=i.wd)}e.refer=o}var n=function(){function t(e){var t,r=window.poiResponse,o=r&&r.result,e=e||{};if(r&&o){t={from:"map",query:o.return_query||o.wd||"",qid:o.qid||"",page_num:isNaN(Number(o.page_num))?"":""+o.page_num};for(var n in t)t.hasOwnProperty(n)&&t[n]&&(e[n]=t[n])}return e}function r(e,t,r){function n(){if(e.src&&-1!=e.src.indexOf("class="))var t="http://log.map.baidu.com/t.gif?"+e.src;else var t="http://map.baidu.com/newmap_test/static/common/images/transparent.gif?newmap=1"+e;i.src=t,i.onload=o}e&&(d=!0,r?n():setTimeout(function(){n()},t||50))}function o(){var e=c.shift();return e?void r(e):void(d=!1)}function n(){d=!1,o()}function a(e,t){var r="";for(var o in e)"undefined"!=typeof e[o]&&(r=t?r+"&"+o+"="+encodeURIComponent(e[o]):r+"&"+o+"="+e[o]);return r}var i=new Image,d=!1,c=[],u={READY:"ready",SHOW:"show",CLICK:"click",HIDE:"hide"},s=e("common:widget/ui/config/config.js"),m=s.modelConfig;return i.onload=n,i.onerror=n,window.statParamInterceptor=t,{addStat:function(e,o,n,i){if(e){var s,n=n||{};if(n.da_par=window._SOURCE,"number"==typeof e)n=o||{},(n.uid||n.tag||n.useraction)&&(n=t(n)),n.code=e,n.t=(1e8*Math.random()).toFixed(0),n.c=m.cityCode,s=a(n,!0);else{if(o=o||"click",!e||"string"!=typeof o||!u[o.toUpperCase()])return;n.da_src=e,n.da_act=o,n.resid=61,n.t=(new Date).getTime(),s=a(n)}d?c.push(s):r(s,0,i)}},classStat:function(){}}}();window.addStat=n.addStat,window.ccStat=n.classStat,function(){function e(e,t,o,n){var a=Math.floor(.001*(new Date).getTime()),i=new Image;i.src="http://log.map.baidu.com/errorreport?product="+e+"&model="+t+"&type="+o+"&detail="+encodeURIComponent(n)+"&t="+a+"&c="+r}function t(e){var t=Math.floor(.001*(new Date).getTime()),r=new Image;r.src="http://log.map.baidu.com/tn.gif?module="+e.module+"&time="+t+"&subvalue="+e.subtype+"&subtype="+e.type+"&value="+e.value+"&detail="+encodeURIComponent(e.detail)+"&logid="+e.logid+"&represent="+e.represent}var r="unknow";T.browser.chrome&&(r="chrome"+T.browser.chrome),T.browser.ie&&(r="ie"+T.browser.ie),window.ReportError=function(t,r,o){!t&&window.currentComponent&&(t=window.currentComponent.__type),"map.baidu.com"==location.host&&Math.random()<.005&&e("PCMAP_JS",t,r,o)};var o={};window.ErrorMonitor=function(e,r,n,a,i){void 0===a?a=.2:a===!0&&(a=1);var d=a;if(("BASE"==r||"succ"==r)&&(d=.01*a),"map.baidu.com"==location.host&&Math.random()<d){{Math.random()}if("BASE"!=r){if(i=i||{},i.unique){if(o[e])return;o[e]=!0}i.xhr=i.xhr||{};var c=i.xhr.timeEnd?i.xhr.timeEnd-i.xhr.timeStart:i.xhr.endTime-i.xhr.startTime;t({module:e,type:i.type,subtype:r,value:c,detail:i.url,logid:i.xhr.getResponseHeader&&i.xhr.getResponseHeader("HTTP_X_BD_LOGID"),represent:d})}}},window.onerror=function(e,t,r,o){return ReportError(null,"execute_error",e+"."+r+"."+o),!1}}(),r.exports={addStat:n.addStat,ccStat:n.classStat,pvstat:o}});
;define("common:widget/ui/util/util.js",function(e,t,n){var i={taxi:[131,289,257,340,75,332,179,218,224,315,132,268,233,288,236,158],smp:[1,2,11,21,26,28,36,38,39,41],smpSug:["PoiSearch","BusSearchSta","BusSearchEnd","DriveSearchSta","DriveSearchEnd","iw_ssn","iw_esn"]},r=e("common:widget/ui/config/size.js"),o={cssPrefixes:["Webkit","ms"],vendorPropName:function(e,t){if(t in e)return t;for(var n=t[0].toUpperCase()+t.slice(1),i=this.cssPrefixes.length;i--;)if(t=this.cssPrefixes[i]+n,t in e)return t;return!1},vendorEvent:function(e,t,n){var i={animationend:{style:"animation",events:["animationend","webkitAnimationEnd"]},animationstart:{style:"animation",events:["animationstart","webkitAnimationStart"]}},r=e.style;if(this.vendorPropName(r,i[t].style))for(var o=i[t].events,a=0;a<o.length;a++)e.addEventListener(o[a],function(e){n&&n(e)});else n&&n()},beforeEndHTML:function(e,t){var n=document.createElement("div");n.innerHTML=t;for(var i=n.childNodes.length,r=0;i>r;r++)e.appendChild(n.childNodes[0]);return n=null,e.lastChild},evalScript:function(e){var t=document.getElementsByTagName("head")[0]||document.documentElement,n=document.createElement("script");n.type="text/javascript";try{n.appendChild(document.createTextNode(e))}catch(i){n.text=e}t.insertBefore(n,t.firstChild),t.removeChild(n)},formatBounds:function(e){var t=e||map.getBounds();return t?"("+t.minX+","+t.minY+";"+t.maxX+","+t.maxY+")":""},formatBlinfo:function(e){for(var t,n=[],i=0,r={},o=e.length;o>i;i++)if(t=e[i].addr,r[t]){var a=n[r[t]-1];a.uid=a.uid+"_"+e[i].uid,a.index=a.index+"_"+i,n.push(e[i])}else{var s=T.extend({},e[i]);n.push(s),n[i].index=i,r[t]=i+1}return n},geoToPoint:function(e){var t=e.split("|");if(1==t[0]){var n=t[1].split(","),i=new BMap.Point(parseFloat(n[0]),parseFloat(n[1]));return i}},getParam:function(e){if(e.indexOf("?")>-1)var t=e.slice(e.indexOf("?")+1);else{if(!(e.indexOf("#")>-1))return;var t=e.slice(e.indexOf("#")+1)}if(""!=t){for(var n={},i=t.split("&"),r=0;r<i.length;r++){var o=i[r].split("=");if(o[1]){var a=o[1].indexOf("#");o[1]=a>-1?o[1].slice(0,a):o[1],n[o[0]]=o[1]}}return n}},extendHashParam:function(e,t){if(e.indexOf("#")>-1){var n=e.slice(e.indexOf("#")+1);if(""!=n)for(var i=n.split(/[&\?]/),r=0;r<i.length;r++){var o=i[r].split("=");if(o[1]){var a=o[1].indexOf("#");o[1]=a>-1?o[1].slice(0,a):o[1],t[o[0]]=o[1]}}}return t},getOverlayPoint:function(e){return e.getPoint?e.getPoint():e.getPosition()},getPointByStr:function(e){if("string"==typeof e){var t=e.split(",");if(!(t.length<2))return new BMap.Point(t[0],t[1])}},getBPoints:function(e){if(e&&0!=e.length){for(var t=[],n=0;n<e.length;n++)if(e[n])for(var i=e[n].split(";"),r=0;r<i.length;r++){var o=this.getPointByStr(i[r]);t.push(o)}return t}},getPointsBounds:function(e){for(var t=new BMap.Bounds,n=0,i=e.length;i>n;n++)t.extend(e[n]);return t},getPoiPoint:function(e){var t=[],n=null;if(!e)return null;if("Point"==e.toString())n=e;else{if("string"==typeof e){if(t=T.trim(e).split(","),t.length<2)return;t[0]=parseFloat(T.trim(t[0])),t[1]=parseFloat(T.trim(t[1]))}else if(t=e.slice(0),t.length<2)return;n=new BMap.Point(t[0],t[1])}return n},parseGeo:function(e){if("string"==typeof e){var t=e.split("|"),n=parseInt(t[0]),i=t[1],r=t[2],o=r.split(";");if(4===n){for(var a=[],s=0;s<o.length-1;s++)"1"===o[s].split("-")[0]&&a.push(o[s].split("-")[1]);o=a,o.push("")}var u=[];switch(n){case 1:u.push(o[0]);break;case 2:case 3:case 4:for(var s=0;s<o.length-1;s++){var l=o[s];if(l.length>100)l=l.replace(/([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0|[1-9]\d*),([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0|[1-9]\d*)(,)/g,"$1,$2;"),u.push(l);else{for(var f=[],d=l.split(","),c=0;c<d.length;c+=2){var p=d[c],h=d[c+1];f.push(p+","+h)}u.push(f.join(";"))}}}return u.length<=1&&(u=u.toString()),{type:n,bound:i,points:u}}},isInteger:function(e){return/^\+?[1-9][0-9]*$/.test(e)},filtQuery:function(e){return e=e||"",e.replace(/[\uac00-\ud7a3]/g,"").replace(/\u2022|\u2027|\u30FB/g,String.fromCharCode(183)).replace(/^\s*|\s*$/g,"")},fixed:function(e,t){for(var e=e.toString();e.length<t;)e="0"+e;return e},isInBounds:function(e,t){return t=t||map.getBounds(),t.containsPoint(e)},supportMinHeight:function(){var e;return function(){if(void 0===e){var t=document.createElement("div"),n=document.body;t.style.minHeight="100px",t.style.height="auto",t.style.padding="0",t.style.borderWidth="0",e=100===n.appendChild(t).offsetHeight,n.removeChild(t)}return e}}(),getClientSize:function(){var e=document;return{width:e.body.clientWidth,height:e.body.clientHeight}},jsonToQuery:function(e,t){var n=[];t=t||function(e){return e};for(var i in e){var r=e[i];""!==r&&null!=r&&"undefined"!=typeof r&&n.push(i+"="+t(r))}return n.join("&")},isActiveCity:function(e,t){return T.array.some(i[e],function(e){return e==t})},stopBubble:function(e){var e=window.event||e;e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},preventDefault:function(e){var e=window.event||e;return e.preventDefault?e.preventDefault():e.returnValue=!1,!1},purgeEvents:function(e){if(e){var t=e.attributes,n="";if(t)for(var i=0,r=t.length;r>i;i++)n=t[i].name,"function"==typeof e[n]&&(e[n]=null);var o=e.childnodes;if(o)for(var i=0,r=o.length;r>i;i++)arguments.callee(e.childnodes[i])}},loadSearchInfo:function(t){e.async("common:widget/ui/searchInfoWindow/searchInfoWindow.js",function(e){t&&t(e)})},getMapSize:function(){var e=this.getClientSize().width,t=this.getClientSize().height,n=map.fullScreenMode;return t-=map&&n?0:r.TOP_HEIGHT-r.TOOL_HEIGHT,map&&!n&&"open"==r.sideStatus&&(e-=r.LEFT_SIDE_WIDTH),e=0>e?0:e,t=0>t?0:t,{width:e,height:t}},isSupportCssProp:function(){var e=document.createElement("div"),t="Khtml O Moz webkit".split(" "),n=t.length;return function(i){if(i in e.style)return!0;if("-ms-"+i in e.style)return!0;for(i=i.replace(/^[a-z]/,function(e){return e.toUpperCase()});n--;)if(t[n]+i in e.style)return!0;return!1}}(),initLoadingMediator:function(){listener.on("loading",function(e,t){if(t instanceof T.dom.$DOM)switch(e){case"start":t.addClass("loading-status");break;case"end":t.removeClass("loading-status")}}),listener.on("com.route","load",function(){listener.trigger("loading","end",T("#MapInfo"))})},placeHolder:function(e,t){var n=e.attr("placeholder"),t=t||T;(8==t.browser.ie||9==t.browser.ie&&n)&&(e.val(n),e.focus(function(){t(this).val()===n&&t(this).val("")}).blur(function(){var e=t(this);""===e.val()&&e.val(n)}))}};n.exports=o});
;define("common:widget/ui/config/config.js",function(t,a,i){var e=t("common:widget/ui/areaCfg/areaCfg.js"),p={"3d_city":{},poiSearch:{enableRoute:!0,showCircle:!0},busTrans:{enableDragging:!0},navTrans:{enableDragging:!0},navWalk:{enableDragging:!0},navBike:{enableDragging:!1},host:function(t,a){if(!t)return"";var i=m.cdnHost;if(!T.isArray(i)||!i.length)return t;var e=t.split("."),p=1===e.length?e[0]:e[e.length-2],n=p.charCodeAt(p.length-1);return i=i[n%i.length],/^http[s]?:\/\//.test(t)?t.replace(/^http[s]?:\/\/[^\/]*/,i):i+(0==t.indexOf("/")?"":"/")+t},smFlwCon:""},n={DATA_URL:"?newmap=1&reqflag=pcmap&biz=1&from=webmap&da_par="+window._SOURCE+"&pcevaname=pc3&qt=",MAIN_BOX:"MapInfo",cityName:"全国",cityCode:e["全国"],upCityid:e["全国"],highLevel:19,cityType:0,supBus:0,sup:0,level:{country:5,province:11,city:12,area:13,cityindex:12,countryindex:4,provinceindex:11,areaindex:13},defalutCityCode:null,enableMapMove:!0,panoCityName:"",panoCityCode:"",timg:"/wolfman/static/common/images/transparent.gif"},o=TVC.ditu,c={normal:o.normal.version,satellite:o.satellite.version,normalTraffic:o.normalTraffic.version,satelliteTraffic:o.satelliteTraffic.version,mapJS:o.mapJS.version,mapJSUdt:o.mapJS.updateDate,INDOOR_CLICK_VER:o.panoClick.version,UDT_VERSION:o.panoUdt.version},m={PANO_URL:"http://pcsv0.map.bdimg.com/",MAP_PHPUI_URL:"http://map.baidu.com/?",DETAIL_MAP_URL:"http://map.baidu.com/detail?",PANO_TILE_URL:["http://pcsv2.map.bdimg.com/","http://pcsv1.map.bdimg.com/","http://pcsv0.map.bdimg.com/"],PANO_ROAD_LAYER:"http://pcsv0.map.bdimg.com",PANO_3DIMAGE_URL:"http://pcsv0.map.bdimg.com",PANO_PHPUI_URL:"http://sv0.map.baidu.com",PANO_ROUTE_VIDEO_URL:"http://pcsv2.map.bdimg.com",PANO_AERIAL_VIDEO_SERVER_URL:"http://pcsv0.map.bdimg.com/video/",PANO_INDOOR_ICON_URL:"http://pcsv0.map.bdimg.com",PANO_VIDEO_SERVER_URL:"http://atv.map.baidu.com",PANO_HOME_URL:"http://quanjing.baidu.com",MapComplaintCenterURL:"http://tousu.baidu.com/map/",WP_URL:"http://weipai.baidu.com",MAP_CENTER_URL:"http://"+window.location.host,cdnHost:["http://webmap0.map.bdstatic.com","http://webmap1.map.bdstatic.com"],DETAIL_PAGE_URL:"http://"+window.location.host},s={1:{sy:5},3:{sy:0},4:{sy:2},5:{sy:3}},r={0:{ck:3,txt:"(推荐路线)"},5:{ck:1,txt:"(时间短)"},2:{ck:4,txt:"(少换乘)"},3:{ck:5,txt:"(少步行)"},4:{ck:6,txt:"(不坐地铁)"},t:"公交：",favDict:s},d={0:{ck:0,sy:0,txt:"(推荐路线)"},1:{ck:1,sy:1,txt:"(最短路程)"},2:{ck:2,sy:2,txt:"(不走高速)"},3:{ck:3,sy:3,txt:"(躲避拥堵)"},t:"自驾："},l={0:d,5:d,1:r,6:r,7:r,2:{t:"步行："},3:{t:"骑行："},9:{0:{ck:3,txt:"(推荐路线)"},1:{ck:7,txt:"(出发较早)"},2:{ck:8,txt:"(到达较早)"},3:{sy:0},7:{sy:1},8:{sy:2},t:"公交："}};n.pk_dict=l,i.exports={modelConfig:n,mapVersion:c,mapConfig:p,urlConfig:m}});
;define("common:widget/ui/config/size.js",function(H,T,I){function _(){}var e={MIN_WIDTH:960,MAPINFO_WIDTH:325,TOP_HEIGHT:98,TOOL_HEIGHT:0,INFOTAB_HEIGHT:56,SEARCH_HEIGHT:98,LEFT_NAV_WIDTH:56,LEFT_SIDE_WIDTH:382,routeModel:!1,resize:_};I.exports=e});
;define("common:widget/ui/constant/Constant.js",function(_,E,R){var A={GEO_TYPE_AREA:0,GEO_TYPE_LINE:1,GEO_TYPE_POINT:2,CITY_TYPE_NATION:0,CITY_TYPE_PROV:1,CITY_TYPE_CITY:2,CITY_TYPE_DIST:3,AREA_TYPE_NORM:0,AREA_TYPE_PROV:1,AREA_TYPE_DIST:2,AREA_TYPE_POI:3,DEST_START:0,DEST_END:1,DEST_MIDDLE:2,DEST_SEC:3,POI_TYPE_NORMAL:0,POI_TYPE_BUSSTOP:1,POI_TYPE_BUSLINE:2,POI_TYPE_SUBSTOP:3,POI_TYPE_SUBLINE:4,ROUTE_TYPE_DEFAULT:0,ROUTE_TYPE_BUS:1,ROUTE_TYPE_WALK:2,ROUTE_TYPE_DRIVE:3,ROUTE_TYPE_TEMP_BUS:4,ROUTE_TYPE_TEMP_WALK:5,ROUTE_TYPE_RAIL_DASHED:6,ROUTE_TYPE_BADWAY:7,ROUTE_TYPE_SMOOTH:8,ROUTE_TYPE_SLOW:9,ROUTE_TYPE_HEAVY:10,ROUTE_TYPE_DRIVE_GREY:11,ROUTE_TYPE_DRIVE_RED:12,SYNC_ACTION_ADD:0,SYNC_ACTION_UPDATE:1,SYNC_ACTION_DELETE:2,SYNC_DATA_TYPE_POI:0,SYNC_DATA_TYPE_ROUTE:1,OVERLAY_STYLE:{MKR_A:1,MKR_B:2,MKR_C:3,MKR_D:4,MKR_E:5,MKR_F:6,MKR_H:7,MKR_I:8,MKR_J:9,MKR_K:10,MKR:11,MKR_RCTR:12,DIS_DOT:13,BUS_STOP:14,BUS_TRANS:15,SUB_TRANS:16,DS_MKR:17,DE_MKR:18,DRV_M_MKR:19,DRV_E_MKR:20,MKR_NULL:21,GEN_MKR:22,VIW_LBL:30,DIS_LBL:31,DIS_T_LBL:32,DS_LBL:33,DE_LBL:34,DIR_MKR:40,ROUTE:60,BUS_ROUTE:61,WALK_ROUTE:62,DRV_ROUTE:63,DIS_LINE:64,AREA:65,H_LINE:66,HO_LINE:67,HW_LINE:68,ADDR_MKR_NUM:[70,71,72,73,74,75,76,77,78,79],ADDR_MKR_ACC:110,ADDR_MKR_EST:111,RAIL_DASHED_ROUTE:120},A_J_MARKER_IMG:"http://webmap2.map.bdstatic.com/wolfman/static/common/images/markers_new_edfa724.png",A_J_MARKER_IMG_NEW:"http://webmap0.map.bdstatic.com/wolfman/static/common/images/markers_new2_31a3944.png",A_J_MARKER_IMG_NEW_HEIGHT:300,A_J_MARKER_IMG_NEW_WIDTH:300,A_J_MARKER_IMG_NEW2X:"http://webmap1.map.bdstatic.com/wolfman/static/common/images/markers_new2x_9b958e6.png",A_J_MARKER_IMG_NEW2X_SRCSET:{"2x":"http://webmap1.map.bdstatic.com/wolfman/static/common/images/markers_new2x_9b958e6.png"},A_J_MARKER_IMG_NEW2X_HEIGHT:600,A_J_MARKER_IMG_NEW2X_WIDTH:600,A_J_MARKER_RED_SIZE:new BMap.Size(21,33),A_J_MARKER_RED_OFFSET:new BMap.Size(10,33),A_J_MARKER_BLUE_SIZE:new BMap.Size(21,33),A_J_MARKER_BLUE_OFFSET:new BMap.Size(10,33),A_J_MARKER_CENTERBLUE_SIZE:new BMap.Size(25,40),A_J_MARKER_CENTERBLUE_OFFSET:new BMap.Size(12,40),A_J_MARKER_OFFSET:new BMap.Size(10,33),A_J_MARKER_INFOWND_OFFSET:new BMap.Size(13,1),A_J_MARKER_CLICK_SIZE:new BMap.Size(25,40),A_J_MARKER_CLICK_OFFSET:new BMap.Size(12,40),A_J_MARKER_BLUE_ICON_Y:66,A_J_MARKER_ORANGE_ICON_Y:33,A_J_MARKER_CLICK_ICON_Y:99,A_J_MARKER_BLUE_ICON_WID:21,A_J_MARKER_RED_ICON_WID:21,A_J_MARKER_CLICK_ICON_WID:25,A_J_ADDR_OFFSET:new BMap.Size(8,20),DEST_MARKER_SIZE:new BMap.Size(25,40),DEST_MARKER_OFFSET:new BMap.Size(12,40),DEST_MARKER_INFOWND_OFFSET:new BMap.Size(14,0),MARKER_11_11_SIZE:new BMap.Size(11,11),MARKER_11_11_OFFSET:new BMap.Size(5,5),MARKER_11_11_INFOWND_OFFSET:new BMap.Size(5,0),CHILD_MARKER_IMG:"http://webmap1.map.bdstatic.com/wolfman/static/common/images/markers_child_00ddde4.png",CHILD_MARKER_IMG2X_SRCSET:{"2x":"http://webmap1.map.bdstatic.com/wolfman/static/common/images/markers_child2x_28c493b.png"},CHILD_MARKER_IMG2X_SIZE:new BMap.Size(210,66),CHILD_MARKER_WID:21,CHILD_MARKER_OFFSET:new BMap.Size(10,32),CHILD_MARKER_ORANGE_Y:0,CHILD_MARKER_GREEN_Y:32,CHILD_MARKER_ORANGE_SIZE:new BMap.Size(21,32),CHILD_MARKER_GREEN_SIZE:new BMap.Size(21,32),CHILD_MARKER_INFOWND_OFFSET:new BMap.Size(13,1),PCHILD_MARKER_IMG:"http://webmap1.map.bdstatic.com/wolfman/static/common/images/marker_pchild_2067cda.png",PCHILD_MARKER_IMG2X_SRCSET:{"2x":"http://webmap1.map.bdstatic.com/wolfman/static/common/images/markers_child2x_28c493b.png"},PCHILD_MARKER_IMG2X_SIZE:new BMap.Size(210,66),PCHILD_MARKER_OFFSET:new BMap.Size(0,0),PCHILD_MARKER_HOVER:90,PCHILD_MARKER_HEIGHT:28,PCHILD_MARKER_WIDTH_1:28,PCHILD_MARKER_WIDTH_2:40,PCHILD_MARKER_WIDTH_3:52,PCHILD_MARKER_WIDTH_4:65,PCHILD_MARKER_WIDTH_5:77,PCHILD_MARKER_WIDTH_6:89,TRANS_TYPE_BUS:0,TRANS_TYPE_SUB:1,TRANS_TYPE_RAIL:2,TRANS_TYPE_AIR:3,TRANS_TYPE_DRIVING:4,TRANS_TYPE_WALKING:5};R.exports=A});
;define("common:widget/ui/searchHistory/hisMgr.js",function(e,t,a){var n=e("common:widget/ui/Storage/Storage.js"),s=e("common:widget/ui/config/config.js"),o=s.modelConfig,i=-1,r=1,c=0,l=15,d=6,h=o.DATA_URL+"usync",u="_search_save_new",g="_line_save_new",v={};v[u]="poihistory",v[g]="routehistory";var y={};y[u]=0,y[g]=0;var m=1e4,f={state:i,init:function(){this.state=r,this.processOldData()},offline:function(){this.state=c,this.processOldData()},processOldData:function(){var e=n.get({key:"_search_save"});if(e){var t=[];e=e.split(encodeURIComponent(","));for(var a=0;a<e.length;a++){var s=e[a];s=s.split("_");var o={qt:"s",wd:s[0]};s[1]&&(o.wd2=s[1]),o.ctime=Math.round((new Date).getTime()/1e3)-7776e3+"",t.push(o)}n.remove({key:"_search_save"}),this.setSearchData(t)}else{var i=this.getUnsyncLocalData(u);this.clearUnsyncLocalData(u),i.length?this.setSearchData(i):this.getSearchData()}var r=n.get({key:"_line_save"});if(r){var c=[];r=r.split(encodeURIComponent(","));for(var a=0;a<r.length;a++){var s=r[a];s=s.split(" - ");var o={qt:"bt"};o.ctime=Math.round((new Date).getTime()/1e3)-7776e3+"";for(var l=0;l<s.length;l++){var d=s[l];d=d.split("$$");var h={type:1,keyword:d[0]};d[1]&&(h.xy=d[1]),0===l?o.sn=h:l===s.length-1?o.en=h:(o.qt="nav",o.wp||(o.wp=[]),o.wp.push(h))}c.push(o)}n.remove({key:"_line_save"}),this.setRouteData(c)}else{var i=this.getUnsyncLocalData(g);this.clearUnsyncLocalData(g),i.length?this.setRouteData(i):this.getRouteData()}},setData:function(e,t){if(this.state===r){for(var a=this.getLocalData(e),s=0;s<t.length;s++)t[s].ctime||(t[s].ctime=t[s].ctime||Math.round((new Date).getTime()/1e3)+"",t[s].platform=t[s].platform||"3");for(var o=[],i=0;i<t.length;i++){var c={action:"add",detail:t[i]};c.ctime=t[i].ctime+"",o.push(c)}var d={datas:T.json.stringify(o)},u=T.cookie.get("validate");d=T.extend(d,{validate:u}),T.ajax(h+"&mode=hsync&subkey="+v[e]+"&t="+(new Date).getTime(),{dataType:"json",method:"post",data:d,success:function(t){if(addStat("multi.history.sync","click",{da_e_name:"pcmap3"}),t.tsync){var a=t.tsync.download;a||(a=[]);for(var s=[],o=0;o<a.length;o++){var i=T.json.parse(a[o].detail);i.sn&&"我的位置"===i.sn.keyword||i.en&&"我的位置"===i.en.keyword||s.push(i)}n.set({key:e,value:T.json.stringify(s)}),y[e]=(new Date).getTime()}}})}else{for(var a=this.getUnsyncLocalData(e),s=0;s<t.length;s++)t[s].ctime||(t[s].ctime=t[s].ctime||Math.round((new Date).getTime()/1e3)+"",t[s].platform=t[s].platform||"3");if(1===t.length)for(var g=0;g<a.length;g++)if(this.compareData(t[0],a[g],e)){a.splice(g,1);break}a=t.concat(a),a=a.slice(0,l),n.set({key:e+"_unsync",value:T.json.stringify(a)})}},compareData:function(e,t,a){return a===u?e.wd===t.wd&&e.wd2===t.wd2?!0:!1:e.sn.keyword===t.sn.keyword&&e.en.keyword===t.en.keyword?!0:!1},getWpNames:function(e){for(var t="",a=0;a<e.length;a++)t+=e[a].keyword;return t},getData:function(e){var t=this,a=T.Deferred();if(this.state===r&&(new Date).getTime()-y[e]>m)addStat("multi.history.download","click",{da_e_name:"pcmap3",da_trd:"online"}),T.ajax(h+"&mode=hdownload&subkey="+v[e]+"&t="+(new Date).getTime(),{dataType:"json",method:"get",success:function(s){if(s.tsync){var o=s.tsync.download;o||(o=[]);for(var i=[],r=0;r<o.length;r++){var c=T.json.parse(o[r].detail);c.sn&&"我的位置"===c.sn.keyword||c.en&&"我的位置"===c.en.keyword||i.push(c)}a.resolve(i),n.set({key:e,value:T.json.stringify(i)}),y[e]=(new Date).getTime()}else{var l=t.getLocalData(e);a.resolve(l)}}});else{if(this.state===i&&this.processOldData(),this.state!==r){var s=this.getUnsyncLocalData(e);s=s.slice(0,d),addStat("multi.history.download","click",{da_e_name:"pcmap3",da_trd:"unlogin"})}else{var s=this.getLocalData(e);addStat("multi.history.download","click",{da_e_name:"pcmap3",da_trd:"local"})}a.resolve(s)}return a},clearData:function(e){if(this.state===r){var t=T.cookie.get("validate"),a={validate:t};T.ajax(h+"&mode=hclear&subkey="+v[e]+"&t="+(new Date).getTime(),{dataType:"json",method:"post",data:a,success:function(){}})}this.clearLocalData(e)},getSearchData:function(){return this.getData(u)},setSearchData:function(e){return this.setData(u,e)},getRouteData:function(){return this.getData(g)},setRouteData:function(e){return this.setData(g,e)},clearSearchData:function(){this.clearData(u)},clearRouteData:function(){this.clearData(g)},getLocalData:function(e){var t=n.get({key:e});return t?T.json.parse(t):[]},getUnsyncLocalData:function(e){var t=n.get({key:e+"_unsync"});return t?T.json.parse(t):[]},clearUnsyncLocalData:function(e){n.remove({key:e+"_unsync"})},clearLocalData:function(e){n.remove({key:e}),n.remove({key:e+"_unsync"})},clearAllLocalData:function(){this.clearLocalData(u),this.clearLocalData(g)}};a.exports=f});
;define("common:widget/ui/indexUtil/IndexUtil.js",function(t,e,i){{var o=t("common:widget/ui/config/config.js"),n=t("common:widget/com/componentManager.js"),a=t("common:widget/ui/mapInfo/mapInfo.js"),c=(t("common:widget/ui/areaCfg/areaCfg.js"),t("common:widget/ui/sateCityList/SateCityList.js"),t("common:widget/ui/stat/CodeStat.js"),t("common:widget/ui/ui3Tools/ui3Tools.js")),s=o.modelConfig;o.mapConfig}i.exports={cnameSearch:function(t,e,i){var o={MapRevertOpts:{noAddBounds:!0}};i=i||0,e=e||s.cityCode,n.go("con&contp=0&wd="+encodeURIComponent(t)+"&pn=0&c="+e+"&src="+i,o)},selectCity:function(e,i){if(window.temp.cityPop)return void window.temp.cityPop.close();var o={title:"城市列表",content:"",height:402,width:395,open:function(){this.styleSwitch&&e.addClass("ui3-city-change-click")},close:function(){this.styleSwitch&&e.removeClass("ui3-city-change-click"),window.temp.cityPop=null}};for(var n in i)o[n]=i[n];t.async(["common:widget/ui/Popup/Popup.js","common:widget/ui/Storage/Storage.js","common:widget/com/SelectCity/SelectCity.js"],function(t,n,c){var s=window.temp.cityPop=new t(o);s.addConnectDom(e[0]),s.render(),s.hide(),o&&"undefined"!=typeof o.right?s.getDom().style.right=o.right+"px":s.getDom().style.left=o&&"undefined"!=typeof o.left?o.left+"px":"close"==a.status?"12px":"396px",o&&"undefined"!=typeof o.top?s.getDom().style.top=o.top+"px":o&&"undefined"!=typeof o.bottom?s.getDom().style.top=o.bottom+"px":map.fullScreenMode?(s.getDom().style.top="28px",s.getDom().style.left="12px"):s.getDom().style.top="136px",i.baiduStorage=n,i.exitLargeMapMode=!1;var r=new c({dom:s.content,cinfo:i,pop:s});r.show()}),window.place&&place.resetArea&&place.resetArea(),addStat("indexcityex.cityexchange.cityexchangeentrance")},setCurCity:function(t,e){e=e||{},t=t||{};{var i=t.name||"",o=t.code||"";t.type||""}window.isPrint||o&&(s.cityCode!=o&&(this.isSupportStreetView(o)&&addStat(STAT_CODE.STAT_PANORAMA,{catalog:"pano-city-visit",from:o}),addStat(STAT_CODE.STAT_PANORAMA,{catalog:"city-visit",from:o})),i&&o&&(this.setModelConfig(t,e),listener.trigger("com.city","change",t),this.setDataCopyRight(),c.streetViewTool._isInited||(c.streetViewTool._isInited=!0,c.streetViewTool.init())))},setModelConfig:function(t){s.cityCode=t.code,s.cityName=t.name,s.cityType=t.type||"",s.sup=t.sup,s.sup_bus=t.sup_bus,s.sup_subway=t.sup_subway},setDataCopyRight:function(){t.async("common:widget/ui/dataCopyRight/dataCopyRight.js",function(t){t.setCopyRight()})},setSupBus:function(t){s.supBus=t,window.isPrint},isSupportStreetView:function(t){var e=window.G_POC||[];t=t||s.cityCode;for(var i=0;i<e.length;i++)if(t==e[i])return!0;return!1},isSupportStreetView2:function(){var t=window.G_POC||[],e=s.cityCode;if(e>=9e3&&9378>=e)return!1;for(var i=0;i<t.length;i++)if(e==t[i]||-9999==t[i])return!0;return!1},getBusExpTime:function(){var t=new Date,e=T.date.format(t,"yyyy-MM-dd"),i=t.getHours(),o=t.getMinutes(),a=o>=10?o:"0"+o,c=i+":"+a,s="",r=n.get("BusTrans"),p=window.currentComponent._className;return r&&"BusTrans"==p&&(e=r.startQDate?r.startQDate:e,c=r.startQTime?r.startQTime:c),s=e+" "+c},switchUrl:function(t,e){var i="",o=window.encodeURIComponent,n=T.trim,a=document.fmwd.word;""!=n(a.value)&&(i=o(a.value));{var c=["http://news.baidu.com/ns?word=#####&tn=news&from=news&ie=utf-8&bs=mp3&sr=0&cl=2&rn=20&ct=1&prevct=no&sc=map","http://www.baidu.com/s?wd=#####&ie=utf-8&fr=map1000","http://tieba.baidu.com/f?kw=#####&ie=utf-8&fr=map_tab","http://zhidao.baidu.com/q?word=#####&ct=17&pn=0&tn=ikaslist&rn=10&lm=0&fr=map0000","http://music.baidu.com/search?key=#####&ie=utf-8&fr=map","http://image.baidu.com/search/index?tn=baiduimage&ct=201326592&cl=2&lm=-1&word=#####&z=0&ie=utf-8&fr=map0000","http://v.baidu.com/v?ct=301989888&s=25&word=#####&ie=utf-8&fr=map0000","http://baike.baidu.com/search/word?&word=#####&pic=1&sug=1&enc=utf8&fr=map0000","http://wenku.baidu.com/search?word=#####&ie=utf-8&fr=map0000"];t.href}if(""!=i)if(""!=c[1*e]&&-1!=c[1*e].indexOf("#####"))t.href=1==e&&window.isSupportHttps?c[1*e].replace("http","https").replace(/#####/gi,i):c[1*e].replace(/#####/gi,i);else{var s="?";t.href=t.href+s+"ie=utf-8&q="+i}},initControls:function(){var e=t("common:widget/ui/ui3Tools/ui3Tools.js");e.init()}}});
;define("common:widget/ui/mapUtil/mapUtil.js",function(e,t,o){function a(e){for(var t=i(e.charAt(0)),o=e.substr(1),a=0,s=o.length,p=[],d=[],_=[];s>a;)if(o.charAt(a)==f[0]){if(13>s-a)return 0;if(_=n(o.substr(a,13),p),0>_)return 0;a+=13}else if(";"==o.charAt(a))d.push(p.slice(0)),p.length=0,++a;else{if(8>s-a)return 0;if(_=r(o.substr(a,8),p),0>_)return 0;a+=8}for(var l=0,c=d.length;c>l;l++)for(var u=0,E=d[l].length;E>u;u++)d[l][u]/=100;return{geoType:t,geo:d}}function i(e){var t=-1;return e==f[1]?t=d.GEO_TYPE_POINT:e==f[2]?t=d.GEO_TYPE_LINE:e==f[3]&&(t=d.GEO_TYPE_AREA),t}function n(e,t){for(var o=0,a=0,i=0,n=0;6>n;n++){if(i=s(e.substr(1+n,1)),0>i)return-1-n;if(o+=i<<6*n,i=s(e.substr(7+n,1)),0>i)return-7-n;a+=i<<6*n}return t.push(o),t.push(a),0}function r(e,t){var o=t.length;if(2>o)return-1;for(var a=0,i=0,n=0,r=0;4>r;r++){if(n=s(e.substr(r,1)),0>n)return-1-r;if(a+=n<<6*r,n=s(e.substr(4+r,1)),0>n)return-5-r;i+=n<<6*r}return a>l&&(a=l-a),i>l&&(i=l-i),t.push(t[o-2]+a),t.push(t[o-1]+i),0}function s(e){var t=e.charCodeAt(0);return e>="A"&&"Z">=e?t-"A".charCodeAt(0):e>="a"&&"z">=e?26+t-"a".charCodeAt(0):e>="0"&&"9">=e?52+t-"0".charCodeAt(0):"+"==e?62:"/"==e?63:-1}{var p=e("common:widget/ui/util/util.js"),d=e("common:widget/ui/constant/Constant.js"),_=e("common:widget/ui/config/config.js");_.mapConfig}BMap.Overlay.getZIndex=function(e,t,o){return(e=1*e)?(t&&t==BMAP_COORD_MERCATOR&&(e=BMap.Project.convertMC2LL(new BMap.Point(0,e)).lat),(-1e5*e<<5)+(o||0)):0};var f=["=",".","-","*"],l=1<<23,c={decode_geo_diff:a};o.exports={addArrow:function(e,t){for(var o=0;o<e.length;o++){var a=e[o].split(",");e[o]=new BMap.Point(a[0],a[1])}for(var i=-1e3,n=[],r=t.getBounds(),o=1;o<e.length-1;o++)if(!(e[o].lng<r.minX||e[o].lng>r.maxX||e[o].lat<r.minY||e[o].lat>r.maxY)){var s=t.pointToPixel(e[o]),p=t.pointToPixel(e[o+1]),d=(s.x-p.x)*(s.x-p.x)+(s.y-p.y)*(s.y-p.y);if(!(400>d)){var _=Math.atan2(e[o].lat-e[o+1].lat,e[o+1].lng-e[o].lng),f=Math.floor(8*_/Math.PI+16.5)%16*-16;if(f!=i){var l=new BMap.Icon("http://webmap0.map.bdstatic.com/wolfman/static/common/images/dest_markers_14848ce.png",new BMap.Size(16,16),{imageOffset:new BMap.Size(f,-120),infoWindowOffset:new BMap.Size(9,0)}),c=new BMap.Marker(e[o],{icon:l});t.addOverlay(c),n.push(c),i=f}}}return n},addSearchPoi:function(e,t,o,a){var i=p.getPoiPoint(e),n=o.split("-")[1]||o;if(n=n.substring(0,6),a=a||{},a.type=a.type||"normal",a.garnd=a.grand||!1,a.isgrandtype=a.isgrandtype,!(!i||"undefined"==typeof t||0>t||t>11&&"child"!==a.type||t>39&&"child"===a.type)){var r,s=d.A_J_MARKER_IMG_NEW;"RouteAddrMarker"==a.type&&(s=d.A_J_MARKER_IMG);var _;if("child"==a.type){s=d.CHILD_MARKER_IMG;var f=new BMap.Icon(s,d.CHILD_MARKER_ORANGE_SIZE,{imageOffset:new BMap.Size(-d.CHILD_MARKER_WID*t,-d.CHILD_MARKER_ORANGE_Y),offset:d.CHILD_MARKER_OFFSET,infoWindowOffset:d.CHILD_MARKER_INFOWND_OFFSET,imageSize:d.CHILD_MARKER_IMG2X_SIZE,srcSet:d.CHILD_MARKER_IMG2X_SRCSET});r=t+1}else if("pchild"==a.type){var l=n.replace(/[\u0100-\uffff]/g,"##").length/2,_=Math.ceil(l);s=d.PCHILD_MARKER_IMG;var f=new BMap.Icon(s,new BMap.Size(d["PCHILD_MARKER_WIDTH_"+_],28),{imageOffset:new BMap.Size(0,-d.PCHILD_MARKER_HEIGHT*(6-_)),offset:new BMap.Size(d["PCHILD_MARKER_WIDTH_"+_]/2,d.PCHILD_MARKER_HEIGHT),infoWindowOffset:new BMap.Size(d["PCHILD_MARKER_WIDTH_"+_]/2,1)});r=t+1}else{var c=0;("RouteAddrMarker"==a.type||"groupon"==a.type)&&(c=-d.A_J_MARKER_ORANGE_ICON_Y);var u=new BMap.Size(-d.A_J_MARKER_RED_ICON_WID*t,c),f=new BMap.Icon(s,d.A_J_MARKER_RED_SIZE,{offset:d.A_J_MARKER_RED_OFFSET,imageOffset:u,infoWindowOffset:d.A_J_MARKER_INFOWND_OFFSET});r=t+1}var E=100;"child"===a.type&&(E=1e3);var R=new BMap.Marker(i,{icon:f,zIndexFixed:!0,baseZIndex:25e5-E*(t+1),startAnimation:"marker-raise marker-"+t});if(R.customProperty={type:a.type},a.uid&&"undefined"!=typeof a.ext_type&&1&a.ext_type){var m="<span class='inr-tip' id='inr_tip_"+t+"' data-uid=\""+a.uid+'" data-wd="'+o+'" >室内地图</span>',g=this.createNormalTip(m,{point:i,offset:new BMap.Size(11,20)});g.setStyle({background:"url(http://webmap2.map.bdstatic.com/wolfman/static/common/images/inr_bg_3fefafb.gif) 0 -29px no-repeat",height:"20px",border:"0"}),g.setTitle("查看室内地图"),g._indoor=!0,R.setLabel(g)}map.addOverlay(R),"pchild"==a.type?(R.isgrand=1,R.textlen=_,p.beforeEndHTML(R.siblingElement,'<div class="pchild-marker-label" style="width:'+d["PCHILD_MARKER_WIDTH_"+_]+'px;z-index:10;font-weight:bold;position: absolute;color:#f21101;text-align:center;margin-top:3px;">'+n+"</div>")):(R.isgrand=0,R.textlen=2),R._stCode=r,o&&R.setTitle(o),R.isgchild=a.garnd,R.isgrandtype=a.isgrandtype||0;var M=this;return baidu("#pano360_id"+t).on("click",function(){var e=baidu(this).data("guid"),t=baidu(this).data("wd");M.show360FullViewMap(e,{wd:t,code:""})}),baidu("#tipBtn_"+t).on("mouseover",function(){var e=baidu(this).data("index");M.showInrTip(e)}),R}},addSearchInViewTitle:function(e,t,o){var a=this.createSearchInViewTitle(e,t);return a._stCode=d.OVERLAY_STYLE.VIW_LBL,o&&"Marker"==o.toString()?(o.setLabel(a),a):(map.addOverlay(a),a)},addDetailPoi:function(e,t){var o=p.getPoiPoint(e);if(o){var a=new BMap.Icon(d.A_J_MARKER_IMG,d.A_J_MARKER_RED_SIZE,{offset:d.A_J_MARKER_OFFSET,imageOffset:new BMap.Size(0,-116),infoWindowOffset:d.A_J_MARKER_INFOWND_OFFSET}),i=new BMap.Marker(o,{icon:a});return map.addOverlay(i),i._stCode=d.OVERLAY_STYLE.MKR,t&&i.setTitle(t),i}},addRoute:function(e,t,o,a){var i,n,r,s,p,_;if(1===t&&("yes"===map.showTerminal||"yes2"===map.showTerminal)){i=e.split(";");var f=new BMap.Icon("http://webmap0.map.bdstatic.com/wolfman/static/common/images/start_2c8cf26.png",new BMap.Size(30,33),{offset:new BMap.Size(14,32),imageOffset:new BMap.Size(0,0)}),l=new BMap.Icon("http://webmap2.map.bdstatic.com/wolfman/static/common/images/end_8f017e7.png",new BMap.Size(30,33),{offset:new BMap.Size(14,32),imageOffset:new BMap.Size(0,0)});_=i.length-1,n=new BMap.Point(parseFloat(i[0].split(",")[0]),parseFloat(i[0].split(",")[1])),r=new BMap.Point(parseFloat(i[_].split(",")[0]),parseFloat(i[_].split(",")[1])),p=new BMap.Marker(n,{isTop:!0,icon:f}),s=new BMap.Marker(r,{isTop:!0,icon:l}),map.addOverlay(p),map.addOverlay(s),map.showTerminal="no"}var c=[{stroke:6,color:"#3a6bdb",opacity:.8,stCode:d.OVERLAY_STYLE.ROUTE},{stroke:6,color:"#3a6bdb",opacity:.8,stCode:d.OVERLAY_STYLE.BUS_ROUTE},{stroke:6,color:"#78bc5f",opacity:.8,stCode:d.OVERLAY_STYLE.WALK_ROUTE},{stroke:5,color:"#3a6bdb",opacity:.8,stCode:d.OVERLAY_STYLE.DRV_ROUTE},{stroke:6,color:"#3a6bdb",opacity:.8,stCode:d.OVERLAY_STYLE.BUS_ROUTE},{stroke:4,color:"#78bc5f",opacity:.8,stCode:d.OVERLAY_STYLE.WALK_ROUTE},{stroke:6,color:"#688DE1",opacity:.8,strokeStyle:"dashed",stCode:d.OVERLAY_STYLE.RAIL_DASHED_ROUTE},{stroke:6,color:"#575757",opacity:.8,strokeStyle:"dotted",stCode:d.OVERLAY_STYLE.WALK_ROUTE},{stroke:5,color:"#00bd00",opacity:.95,stCode:d.OVERLAY_STYLE.DRV_ROUTE,strokeLineCap:"square"},{stroke:5,color:"#ffac00",opacity:.95,stCode:d.OVERLAY_STYLE.DRV_ROUTE,strokeLineCap:"square"},{stroke:5,color:"#f41c0d",opacity:.95,stCode:d.OVERLAY_STYLE.DRV_ROUTE,strokeLineCap:"square"},{stroke:4,color:"#9e9e9e",opacity:.8,stCode:d.OVERLAY_STYLE.DRV_ROUTE},{stroke:5,color:"#ff0103",opacity:.8,stCode:d.OVERLAY_STYLE.DRV_ROUTE}];if("undefined"==typeof t&&(t=0),c[t]){var u=c[t],E={strokeWeight:u.stroke,strokeColor:u.color,strokeOpacity:u.opacity,strokeStyle:u.strokeStyle,strokeLineCap:u.strokeLineCap||"round"};if("string"==typeof e||"Point"==e[0].toString())var R=new BMap.Polyline(e,E);else if("[object Array]"==Object.prototype.toString.call(e))var R=new BMap.PolylineMultipart(e,E);var m=a||map;if(m.addOverlay(R),R._stCode=c[t].stCode,R._routeType=t,R._sMarker=p,R._eMarker=s,t==d.ROUTE_TYPE_BUS){var g=new BMap.Polyline(e,{strokeWeight:u.stroke-2,strokeColor:"#fff",strokeOpacity:.3});R._p=g,m.addOverlay(g)}return R}},createSearchInViewTitle:function(e,t){var o=p.getPoiPoint(e);if(o){var a=new BMap.Size(14,-21),i=t;t.replace(/[\u0100-\uffff]/g,"##").length>20&&(t=t.substring(0,10)+"...");var n=new BMap.Label(t,{point:o,offset:a});return n.setTitle(i),n.setStyle({lineHeight:"15px",padding:"1px 3px",borderColor:"#a7a7a7",color:"#666",cursor:"pointer"}),n}},createNormalTip:function(e,t){var o={display:!0,style:{background:"url(http://webmap0.map.bdstatic.com/wolfman/static/common/images/tip_5ffa1fb.gif) 0 0 no-repeat",color:"#000",height:"30px",border:"0",padding:"0 0 0 4px"}};t&&"object"==typeof t&&(t=T.extend(o,t));var a=new BMap.Label(e,{point:t.point,offset:t.offset});return a},cutPoints:function(e,t){if(t?.25>t?t=0:t>.25&&1>t?t=1:t>32&&(t=32):t=0,e&&"string"==typeof e){var o=e;if(t>0){var a=new RegExp("(((-?\\d+)(\\.\\d+)?),((-?\\d+)(\\.\\d+)?);)(((-?\\d+)(\\.\\d+)?),((-?\\d+)(\\.\\d+)?);){"+t+"}","ig");o=e.replace(a,"$1")}return o}},selectRoute:function(e){if(e&&"Polyline"==e.toString()){var t=["#ff0103","#ff0103","#ff0103","#ff0103","","","#ff0103"];t[e._routeType]&&(e.setStrokeColor(t[e._routeType]),e._stCode=e._stCode==d.OVERLAY_STYLE.BUS_ROUTE?d.OVERLAY_STYLE.HO_LINE:e._stCode==d.OVERLAY_STYLE.WALK_ROUTE?d.OVERLAY_STYLE.HW_LINE:d.OVERLAY_STYLE.H_LINE)}},unSelectRoute:function(e){if(e&&"Polyline"==e.toString()){var t=["#3a6bdb","#3a6bdb","#30a208","#3a6bdb","","","#688DE1"],o=[d.OVERLAY_STYLE.ROUTE,d.OVERLAY_STYLE.BUS_ROUTE,d.OVERLAY_STYLE.WALK_ROUTE,d.OVERLAY_STYLE.DRV_ROUTE,,,d.OVERLAY_STYLE.RAIL_DASHED_ROUTE];t[e._routeType]&&(e.setStrokeColor(t[e._routeType]),e._stCode=o[e._routeType])}},removeRoute:function(e){e._p&&"Polyline"==e._p.toString()&&(e._p.remove(),e._p=null),e.remove(),e=null},addArea:function(e,t){if(e){var o=[{strokeColor:"#0064fc",strokeWeight:2,fillColor:!1,strokeOpacity:.8,strokeStyle:"dashed",stCode:d.OVERLAY_STYLE.AREA},{strokeColor:"#0064fc",strokeWeight:2,fillColor:!1,strokeOpacity:.8,strokeStyle:"dashed",stCode:d.OVERLAY_STYLE.AREA},{strokeColor:"#0064fc",strokeWeight:2,fillColor:!1,strokeOpacity:.8,strokeStyle:"dashed",stCode:d.OVERLAY_STYLE.AREA},{strokeColor:"#6791e5",strokeWeight:2,strokeOpacity:.9,strokeStyle:"solid",fillColor:"#4673cc",fillOpacity:.5,stCode:d.OVERLAY_STYLE.AREA}],a=t||0;if(o[a]){var i;return i=e.length>2e3?new BMap.Polyline(e,o[a]):new BMap.Polygon(e,o[a]),map.addOverlay(i),!o[a].strokeColor&&i.setFillColor(!1),i._stCode=o[a].stCode,i}}},removeArea:function(e){"Polygon"==e.toString()&&(e.remove(),e=null)},addTransPoi:function(e,t,o,a){var i=p.getPoiPoint(e);if(i){var n=d.OVERLAY_STYLE.BUS_TRANS,r=-55;switch(t){case d.TRANS_TYPE_BUS:r=-55;break;case d.TRANS_TYPE_SUB:n=d.OVERLAY_STYLE.SUB_TRANS,r=-76;break;case d.TRANS_TYPE_RAIL:r=-118;break;case d.TRANS_TYPE_AIR:r=-139;break;case d.TRANS_TYPE_DRIVING:r=-97;break;case d.TRANS_TYPE_WALKING:r=-160}var s=new BMap.Icon("http://webmap1.map.bdstatic.com/wolfman/static/common/images/trans_icons_45ed3d3.png",new BMap.Size(21,21),{imageOffset:new BMap.Size(0,r),infoWindowOffset:new BMap.Size(10,0)}),_=new BMap.Marker(i,{icon:s}),f=a||map;return _._stCode=n,o&&_.setTitle(o),f.addOverlay(_),_}},addBusStopPoi:function(e,t){var o=p.getPoiPoint(e);if(o){var a=new BMap.Icon("http://webmap0.map.bdstatic.com/wolfman/static/common/images/stop_icon_b14a324.png",d.MARKER_11_11_SIZE,{offset:d.MARKER_11_11_OFFSET,infoWindowOffset:d.MARKER_11_11_INFOWND_OFFSET}),i=new BMap.Marker(o,{icon:a,baseZIndex:15e5});return map.addOverlay(i),i._stCode=d.OVERLAY_STYLE.BUS_STOP,t&&i.setTitle(t),i}},addDestPoi:function(e,t,o){o=o||{};var a=o.userMap||map,i=p.getPoiPoint(e);if(i){if(t==d.DEST_MIDDLE){var n=new BMap.Icon("http://webmap2.map.bdstatic.com/wolfman/static/common/images/drv_m_234b1a3.png",d.MARKER_11_11_SIZE,{offset:d.MARKER_11_11_OFFSET,infoWindowOffset:d.MARKER_11_11_INFOWND_OFFSET}),r=new BMap.Marker(i,{icon:n,baseZIndex:-1e7});return a.addOverlay(r),r.enableDragging(!0),r._stCode=d.OVERLAY_STYLE.DRV_M_MKR,r}if(!o.showText){var n=new BMap.Icon("http://webmap0.map.bdstatic.com/wolfman/static/common/images/markers_new2_31a3944.png",d.DEST_MARKER_SIZE,{offset:d.DEST_MARKER_OFFSET,imageOffset:new BMap.Size(-200-25*t,-139),infoWindowOffset:d.DEST_MARKER_INFOWND_OFFSET,imageSize:new BMap.Size(d.A_J_MARKER_IMG_NEW_WIDTH,d.A_J_MARKER_IMG_NEW_HEIGHT),srcSet:d.A_J_MARKER_IMG_NEW2X_SRCSET}),r=new BMap.Marker(i,{icon:n,baseZIndex:35e5,startAnimation:o.startAnimation});return o.text&&r.setTitle(o.text),r._stCode=d.OVERLAY_STYLE.DS_MKR+t,a.addOverlay(r),r}var s=o.text;s.length>10&&(s=s.substring(0,10)+"...");var _=new BMap.Label(o.text,{point:i});return _.setStyles({cursor:"pointer"}),_.setOffset(new BMap.Size(-12,-28)),_._stCode=d.OVERLAY_STYLE.DS_LBL+t,_.addEventListener("domready",function(){var e=_.getDom();e.style.border="none",e.style.background="transparent",e.style.overflow="visible",e.style.zIndex=25e5+2*map.pointToPixel(i).y,e.style.cursor="url("+map.config.defaultCursor+"), default",T.browser.ie||(T.on(e,"mousedown",function(){e.style.cursor="url("+map.config.draggingCursor+"), default"}),T.on(e,"mouseup",function(){e.style.cursor="url("+map.config.defaultCursor+"), default"})),_.zIndex=e.style.zIndex;var o="";o=6==T.browser.ie?'<div class="dest_icon_left_ie6 dest'+t+'"><div></div></div><div class="dest_icon_right_ie6"><div></div><span class="dest_text_ie6">'+s+"</span></div>":'<div class="dest_icon dest'+t+'"><div class="dest_icon_right"><span class="dest_text">'+s+"</span></div></div>",e.innerHTML=o}),a.addOverlay(_),_}},createDrvMidLabel:function(e,t){var o=new BMap.Label(e,{point:t,offset:new BMap.Size(15,-5)});return o.setStyles({border:"1px solid #999",color:"#666",padding:"2px",background:"#fff"}),o},addDrvDirIcon:function(e,t,o){o=o||map;var a=p.getPoiPoint(e);if(a){(0>t||t>12)&&(t=0);var i=-18*t,n=new BMap.Icon("http://webmap0.map.bdstatic.com/wolfman/static/common/images/dest_markers_14848ce.png",new BMap.Size(18,18),{imageOffset:new BMap.Size(i,-100),infoWindowOffset:new BMap.Size(9,0)}),r=new BMap.Marker(a,{icon:n});return o.addOverlay(r),r._stCode=d.OVERLAY_STYLE.DIR_MKR+t,r}},addPanoTips:function(){},addDrRoute:function(e,t,o,a){var i=this,n=a||map;window.dropRoutes||(window.dropRoutes=[]);var r=[];t.onRemoveTips();var s=t.routePoints;if(t.mapZoomLevel=n.getZoom(),t.driveBounds.length>0){var _=p.getBPoints(t.driveBounds);(0==t.drag&&!e||o)&&this.setViewport(_,40),t.drag=0}for(var f=(Math.pow(2,BMap.MapType[n.mapType].zoomLevelMax-n.getZoom()),0);f<s.length;f++){for(var l=s[f],c=[],u=0;u<l.length;u++)for(var E=l[u].p,R=this.cutPoints(E,0),m=R.split(";"),g=0;g<m.length;g++){var M=m[g].split(","),T=new BMap.Point(M[0],M[1]);c.push(T)}if(!t.draging&&0==t.sended){var i=t;if(0==e){var v=this.addRoute(c,d.ROUTE_TYPE_DRIVE,void 0,n);r.push(v),v.index=f,v.addEventListener("mouseover",function(e){i.onRouteOver(e)}),v.addEventListener("mousemove",function(e){i.onRouteMove(e)}),v.addEventListener("mouseout",function(e){i.onRouteOut(e)}),window.dropRoutes.push(v)}else{var w=window.dropRoutes[f];w&&w.setPoints(c)}}}return r},createTip:function(e,t,o,a){if(e||"string"==typeof e){var i={display:!0,offset:new BMap.Size(3,-34),style:{background:"url(http://webmap0.map.bdstatic.com/wolfman/static/common/images/tip_5ffa1fb.gif) 0 0 no-repeat",color:"#000",height:"30px",border:"0",padding:"0 0 0 4px"}},n=a||map;i.point=n.getCenter(),o&&"object"==typeof o&&(o=T.extend(i,o)),e="<span class="+t+">"+e+"</span>";var r=new BMap.Label(e,{point:o.point,offset:o.offset}),s=new BMap.Marker(o.point,{icon:new BMap.Icon("/wolfman/static/common/images/transparent.gif",new BMap.Size(1,1))});return r.setStyle(o.style),s.setLabel(r),0==o.display&&r.hide(),n.addOverlay(s),r.addEventListener("mouseover",function(){s.setTop(!0,35e5-BMap.Overlay.getZIndex(o.point.lat,BMAP_COORD_MERCATOR))}),r.addEventListener("mouseout",function(){s.setTop(!1)}),s}},getBitLevel:function(e){for(var t=BMap.MapType[map.mapType],o=t.zoomLevelMax,a=1,i=o;i>=a;i--){var n=Math.pow(2,t.zoomLevelMax-i)*t.baseUnits/t.tileSize;if((e.getMaxX()-e.getMinX())/n<map.width-60&&(e.getMaxY()-e.getMinY())/n<map.height-60)break}return i},setViewport:function(e,t){if(0!=e.length){var o=null;t&&(o={margins:[t,t,t,t]});var a=map.getViewport(e,o);map.setViewport(a)}},_getPicType:function(){var e=map.getMapType(),t=[];return e==BMAP_SATELLITE_MAP?(t.push(7),map._isHybridShow&&t.push(1)):t.push(0),window.GRControll&&window.GRControll.getDataForSnap()&&t.push(6),t.join(",")},parse2Geo:function(e,t){t?.25>t?t=0:t>.25&&1>t?t=1:t>32&&(t=32):t=0;var o=e.split("|");if(1==o.length){var a=c.decode_geo_diff(o[0]);return{type:a.type,bound:"",points:a.geo.join(",")}}if(o.length>1){for(var i=e.split(";.="),n=[],r=[],s=0,p=i.length,d=0;p>d;d++){var _=i[d];p>1&&(0==d&&(_+=";"),d>0&&p-1>d&&(_=".="+_+";"),d==p-1&&(_=".="+_));var f=_.split("|"),l=c.decode_geo_diff(f[0]),u=c.decode_geo_diff(f[1]);n.push(l.geo.join(",")),n.push(u.geo.join(","));var a=c.decode_geo_diff(f[2]);s=a.type;var E=a.geo.join(",");if(E=E.replace(/([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0|[1-9]\d*),([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0|[1-9]\d*)(,)/g,"$1,$2;"),t>0){var R=new RegExp("(((-?\\d+)(\\.\\d+)?),((-?\\d+)(\\.\\d+)?);)(((-?\\d+)(\\.\\d+)?),((-?\\d+)(\\.\\d+)?);){"+t+"}","ig");E=E.replace(R,"$1")}r.push(E)}return 1>=p&&(r=r.join(";")),{type:s,bound:n.join(";"),points:r}}},getGEORevertAddress:function(e,t){var o="http://api.map.baidu.com/?qt=rgc&x="+e.lng+"&y="+e.lat+"&dis_poi=100&poi_num=10&ie=utf-8&oue=1&res=webmap";baidu.jsonp(o,function(e){"function"==typeof t&&e&&e.content&&t(e)})},add3DTip:function(){},remove3DTip:function(){},show360FullViewMap:function(){},showInrTip:function(e){T.g("inrTipNew_"+e).style.display="block",T.g("tipBtn_"+e).style.display="none",setTimeout(function(){T.g("inrTipNew_"+e)&&(T.g("inrTipNew_"+e).style.display="none"),T.g("tipBtn_"+e)&&(T.g("tipBtn_"+e).style.display="block")},3e3)}}});
;define("common:widget/ui/Animation/Animation.js",function(t,i,n){function e(){}e.INFINITE="INFINITE",e.prototype.build=function(t){var i=this,n={duration:1e3,fps:30,delay:0,transition:s.linear,finish:function(){},onStop:function(){}};if(this._anis=[],t)for(var o in t)n[o]=t[o];return"number"==typeof n.delay?setTimeout(function(){i.start()},n.delay):n.delay!=e.INFINITE&&this.start(),this._opts=n,this},e.prototype.start=function(){this._beginTime=(new Date).getTime(),this._endTime=this._beginTime+this._opts.duration,this._launch()},e.prototype.add=function(t){this._anis.push(t)},e.prototype._launch=function(){var t=this,i=(new Date).getTime();if(i>=t._endTime){if(t._opts.render(t._opts.transition(1)),t._opts.finish(),t._anis.length>0){var n=t._anis[0];n._anis=[].concat(t._anis.slice(1)),n.start()}}else t.schedule=t._opts.transition((i-t._beginTime)/t._opts.duration),t._opts.render(t.schedule),t.terminative||(t._timer=setTimeout(function(){t._launch()},1e3/t._opts.fps))},e.prototype.stop=function(t){this.terminative=!0;for(var i=0;i<this._anis.length;i++)this._anis[i].stop(),this._anis[i]=null;this._anis.length=0,this._timer&&(clearTimeout(this._timer),this._timer=null),this._opts.onStop(this.schedule),t&&(this._endTime=this._beginTime,this._launch())},e.prototype.cancel=function(){this._timer&&clearTimeout(this._timer),this._endTime=this._beginTime,this.schedule=0},e.prototype.setFinishCallback=function(t){this._anis.length>0?this._anis[this._anis.length-1]._opts.finish=t:this._opts.finish=t};var s={linear:function(t){return t},reverse:function(t){return 1-t},easeInQuad:function(t){return t*t},easeInCubic:function(t){return Math.pow(t,3)},easeOutQuad:function(t){return-(t*(t-2))},easeOutCubic:function(t){return Math.pow(t-1,3)+1},easeInOutQuad:function(t){return.5>t?t*t*2:-2*(t-2)*t-1},easeInOutCubic:function(t){return.5>t?4*Math.pow(t,3):4*Math.pow(t-1,3)+1},easeInOutSine:function(t){return(1-Math.cos(Math.PI*t))/2}};s["ease-in"]=s.easeInQuad,s["ease-out"]=s.easeOutQuad,n.exports={Animation:e,Transitions:s}});
;define("common:widget/ui/searchData/searchData.js",function(e,o,n){function r(e,o,n){var r="",t=o||(new Date).getTime(),a=map.getBounds(),s="&l="+map.getZoom(),l=location.pathname,c=window.isPrint?l.replace("print.html",""):l;if((-1!=e.indexOf("nav&")||-1!=e.indexOf("nse&"))&&(e+="&extinfo=63"),0!=e.indexOf("bd&")&&window.searchInViewCtrl&&(window.searchInViewCtrl.exit(),window.searchInViewCtrl.curKw="",window.toolsMediator&&window.toolsMediator.removeActive(T("#ui3_tool_sehInView"))),document.location.href.indexOf("format=1")>-1&&(r="&format=1"),e.indexOf("&l=")>-1&&(s=""),e=e.replace(/%3C/gi,encodeURIComponent(" ")).replace(/%3E/gi,encodeURIComponent(" "))+"&tn="+map.mapType,e.indexOf("&nn=")<0&&(e+="&nn=0"),e.indexOf("b=(")>-1||n&&n.noAddBounds)e=c+i.DATA_URL+e+r+"&ie=utf-8"+s+"&t="+t;else{var d=Math.min(a.minX,a.maxX),u=Math.max(a.minX,a.maxX),m=Math.min(a.minY,a.maxY),f=Math.max(a.minY,a.maxY);e=c+i.DATA_URL+e+r+"&ie=utf-8"+s+"&b=("+d+","+m+";"+u+","+f+")&t="+t}return e}var t=e("common:widget/ui/config/config.js"),i=t.modelConfig,a=e("common:widget/ui/vcode/Vcode.js"),s={lastSearchTime:{},fetch:function(e,o,n,t){var i=e.substring(0,e.indexOf("&")),s=e,l=(new Date).getTime();return this.lastSearchTime[i]=l,e=r(e,l,t),ErrorMonitor("qt_"+i,"BASE",""),T.ajax(e,{dataType:"json",success:function(r,t){var l=t.getResponseHeader("need_vcode_check"),c=t.getResponseHeader("codestr"),d={};if(l)return d.lastRequest=s,d.setUrl=e,d.codestr=c,void a.openPop(d);var u=t.getResponseHeader("HTTP_X_BD_LOGID");if(!r||!r.result)return ErrorMonitor("qt_"+i,"res_null",u+"$$no res$$"+e,void 0,{xhr:t,url:e,type:"fail"}),void(n&&n());var m;1===r.result.current_null&&!r.place_info||t.slow?(1!==r.result.current_null||r.place_info||"bse"===i||(ErrorMonitor("qt_"+i,"res_null",u+"$$no content$$"+e,void 0,{xhr:t,url:e,type:"fail"}),m="fail"),t.slow&&(ErrorMonitor("qt_"+i,"req_slow"+t.slow,u,void 0,{xhr:t,url:e,type:"slow"}),m="slow")):(ErrorMonitor("qt_"+i,"succ","",void 0,{xhr:t,url:e,type:"succ"}),m="succ"),o&&o(r,{type:m})},error:function(o){ErrorMonitor("qt_"+i,"req_fail",o.status,void 0,{xhr:o,url:e,type:"fail"}),n&&n()}})},setUrl:r};n.exports=s});
;define("common:widget/route/setMyPlace/SetMyPlaceStorer.js",function(t,e,r){var i=(t("common:widget/ui/util/util.js"),t("common:widget/ui/config/config.js")),a=(i.mapConfig,{baiduStorage:null,arr:[],userId:encodeURIComponent(baidu.cookie.get("BAIDUID"))||"",init:function(e){var r=this,i=t("common:widget/ui/Storage/Storage.js");r.baiduStorage=i,e&&e()},setAll:function(t){this.baiduStorage.set({key:"_smp_save",value:baidu.json.stringify(t)}),this.arr=t},set:function(t){var e=this.arr;if(e&&0!=e.length){var r=this.getIndexByTarget(t.target);void 0!=r?e[r]=t:e.push(t)}else e=[t];this.setAll(e)},getAll:function(){try{var t=baidu.json.parse(this.baiduStorage.get({key:"_smp_save"}))}catch(e){return}return this.arr=t||[],t},getItemByTarget:function(t){if(t){var e=this.getIndexByTarget(t);return this.arr[e]}},getIndexByTarget:function(t){if(t)for(var e=0,r=this.arr.length;r>e;e++)if(t==this.arr[e].target)return e},rmvItemByTarget:function(t){t&&this.rmvItemByIndex(this.getIndexByTarget(t))},rmvItemByIndex:function(t){void 0!==t&&(T.array.removeAt(this.arr,t),this.setAll(this.arr))},clear:function(){this.baiduStorage.remove({key:"_smp_save"})}});r.exports=a});
;define("common:widget/route/setMyPlace/ui3SetMyPlace.js",function(e,t,a){var i,n=e("common:widget/route/setMyPlace/ui3SetMyPlacePop.js"),c=(e("common:widget/ui/toast/toast.js"),n.storer),l={},m=i={init:function(e){return this.onSelect=e||function(){},this.initSaved(),this.drawList()},drawList:function(){function e(e){var t=e?"home":"company",a=['<li class="ui3-set-my-place-item ',t,'" data-target="',t,'">','    <div class="clearfix ui3-set-my-place-inner">',"        <b><em>&nbsp;</em><span>",e?"我的家":"公司/学校","</span",'       ></b><i><a href="#" class="no-data" onclick="return false">设置</a></i>',"    </div>","</li>"];return a.join("")}function t(e,t){var a=e?"home":"company",i=['<li class="ui3-set-my-place-item ',a,'" data-target="',a,'">','    <div class="clearfix ui3-set-my-place-inner">','       <i class="ui3-set-my-place-action">','       <a href="#" onclick="return false" data-action="edit">修改</a','       ><a href="#" onclick="return false" data-action="delete">清空</a>',"       </i>","        <b><em>&nbsp;</em><span>",e?"我的家":"公司/学校",'</span></b><a href="#" class="has-data" onclick="return false" title="',t.note,'">',t.note,"</a>","    </div>","</li>"];return i.join("")}var a=l.home,i=l.company,n=[];return n.push(a?t(!0,a):e(!0)),n.push(i?t(!1,i):e(!1)),n.join("")},initSaved:function(){var e=c.getAll();l={},T.each(e,function(e,t){var a=t.target;"home"===a?l.home=t:"company"===a&&(l.company=t)})},select:function(e,t){var a=l[e];a?(t&&t.val(a.name),this.onSelect(a),addStat("indexleftmenu.setMyPlace.useBtn","click",{da_e_name:"pcmap3"}),"company"==e?addStat("indexleftmenu.setMyPlace.useCompanyBtn","click",{da_e_name:"pcmap3"}):"home"==e&&addStat("indexleftmenu.setMyPlace.useHomeBtn","click",{da_e_name:"pcmap3"})):("home"==e?addStat("indexleftmenu.setMyPlace.setHomeBtn","click",{da_e_name:"pcmap3"}):"company"==e&&addStat("indexleftmenu.setMyPlace.setCompanyBtn","click",{da_e_name:"pcmap3"}),i.open({target:e,action:"add"}))},bindWrapEvents:function(e){e.find("a.no-data").bind("click",function(){var e=T(this).parents("li"),t=e.attr("data-target");i.open({target:t,action:"add"}),"home"==t?addStat("indexleftmenu.setMyPlace.setHomeBtn","click",{da_e_name:"pcmap3"}):"company"==t&&addStat("indexleftmenu.setMyPlace.setCompanyBtn","click",{da_e_name:"pcmap3"}),addStat("indexleftmenu.setMyPlace.setBtn","click",{da_e_name:"pcmap3"})}),e.find("a[data-action]").bind("click",function(){var e=T(this),t=e.parents("li"),a=e.attr("data-action"),c=t.attr("data-target"),m=l[c];m.target=c;var o="home"===m.target?"我的家":"公司 / 学校";if("edit"===a)addStat("indexleftmenu.setMyPlace.editBtn","click",{da_e_name:"pcmap3"}),addStat("indexleftmenu.setMyPlace."+c+"editBtn","click",{da_e_name:"pcmap3"}),i.open(m);else{var d=window.confirm("是否要清空常用地点“"+o+"”?");addStat("indexleftmenu.setMyPlace.deleteBtn","click",{da_e_name:"pcmap3"}),addStat("indexleftmenu.setMyPlace."+c+"deleteBtn","click",{da_e_name:"pcmap3"}),d&&n.bundle().remove(c)}}),e.find("li").bind("click",function(t){if(!T(t.target).is("[data-action],.no-data")){var a=T(this),n=a.attr("data-target"),c=l[n];if(!c||0===c.length)return void a.find(".no-data").trigger("click");e.suggestInputTarget&&e.suggestInputTarget.val(c.name),i.onSelect(c),addStat("indexleftmenu.setMyPlace.useBtn","click",{da_e_name:"pcmap3"}),"company"==c.target?addStat("indexleftmenu.setMyPlace.useCompanyBtn","click",{da_e_name:"pcmap3"}):"home"==c.target&&addStat("indexleftmenu.setMyPlace.useHomeBtn","click",{da_e_name:"pcmap3"})}})},open:function(e){i.pop=n.initialize(e)}},o=".ui3-set-my-place-item{line-height:32px}.ui3-set-my-place-item:hover,.ui3-set-my-place-item.ui3-suggest-item-hover{cursor:pointer;background-color:#EBEBEB}.ui3-set-my-place-item.home em{display:inline-block;width:15px;height:13px;background:url(http://webmap1.map.bdstatic.com/wolfman/static/common/images/ui3/tools/suggestion-icon_013979b.png) no-repeat 0 -40px}.ui3-set-my-place-item.company em{display:inline-block;width:15px;height:14px;background:url(http://webmap1.map.bdstatic.com/wolfman/static/common/images/ui3/tools/suggestion-icon_013979b.png) no-repeat 0 -26px}.ui3-set-my-place-item b{padding-left:12px;float:left;line-height:32px}.ui3-set-my-place-item.other b{padding-left:17px}.ui3-set-my-place-item em{display:inline-block;width:15px;line-height:14px;height:14px;background:url(http://webmap0.map.bdstatic.com/wolfman/static/common/images/ui3/tools/tools_47a3ea9.png) no-repeat -30px -291px}.ui3-set-my-place-item span{color:#666;margin-left:8px;width:53px}.ui3-set-my-place-item a{vertical-align:middle;color:#999;margin-left:14px;text-decoration:none}.ui3-set-my-place-item i{float:right;font-style:normal;margin-right:5px}.ui3-set-my-place-action a{margin-left:5px}.ui3-set-my-place-inner i a:hover{color:#36c}.ui3-set-my-place-item .has-data{display:block;margin-left:105px;margin-right:70px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ui3-set-my-place-item.other .has-data{margin-left:44px}.ui3-set-my-place-item .has-data:hover{}";e.loadCss({content:o,name:"ui3SetMyPlace"}),a.exports=m});
;define("common:widget/ui/mapInfo/mapInfo.js",function(e,t,i){var n=e("common:widget/ui/util/util.js"),o=e("common:widget/ui/mapInfoScroll/mapInfoScroll.js"),a=e("common:widget/ui/config/size.js"),s=(n.isSupportCssProp("transition"),T("#map_info")),m={status:"open",isGoing:!1,timer:null,init:function(){var e=this;e.bindEvent()},slideShow:function(){var e=this;if(e.status="open",a.sideStatus="open",!e.isGoing){e.isGoing=!0;var t=T("#MapHolder"),i=T("#MapInfoTab"),o=map.getCenter(),m=n.getClientSize().height-98,r=n.getClientSize().width,d=(T.g("StreetViewHolder"),a.LEFT_SIDE_WIDTH),l=T(".route-op-banner,.sub-op-banner");setTimeout(function(){l.show()},300),s.animate({left:0},200,"linear",function(){i.attr({"class":"mapinfo_but",title:"收起左栏"})}),t.animate({"margin-left":d},{duration:200,easing:"linear",step:function(){e.dice(.5)&&map.setCenter(o)},done:function(){e.isGoing=!1,map.setCenter(o),e.dispatchEvent("onShowSide",{action:"show",size:{width:r,height:m,marginLeft:d}})}}),T.g("cityBottom")&&baidu.dom.show(T.g("cityBottom"))}},slideHide:function(){var e=this;if(e.status="close",a.sideStatus="close",!e.isGoing){e.isGoing=!0;{var t=T("#MapHolder"),i=T("#MapInfoTab"),o=map.getCenter(),m=n.getClientSize().height-98,r=n.getClientSize().width;T.g("StreetViewHolder"),a.LEFT_SIDE_WIDTH,T(".route-op-banner,.sub-op-banner").hide()}s.animate({left:-a.LEFT_SIDE_WIDTH},200,"linear",function(){i.attr({"class":"mapinfo_but mapinfo_but_open",title:"显示左栏"})}),t.animate({"margin-left":0},{duration:200,easing:"linear",step:function(){e.dice(.5)&&map.setCenter(o)},done:function(){e.isGoing=!1,map.setCenter(o),e.dispatchEvent("onHideSide",{action:"hide",size:{width:r,height:m,marginLeft:0}})}}),T.g("cityBottom")&&baidu.dom.hide(T.g("cityBottom"))}},dice:function(e){return Math.random()<e},hide:function(){var e=this;if(e.status="close",a.sideStatus="close",!e.isGoing){e.isGoing=!0;var t=T.g("MapHolder"),i=T.g("MapInfoCon"),o=T.g("MapInfoTab"),s=map.getCenter(),m=n.getClientSize().height-98,r=n.getClientSize().width,d=T.g("StreetViewHolder"),l=a.LEFT_SIDE_WIDTH;i.style.left="-"+l+"px",o.style.left=0,t.style.marginLeft=0,t.style.height=m+"px",d.style.marginLeft=0,map.addEventListener("resize",function(){map.setCenter(s),map.removeEventListener("resize",arguments.callee)}),o.className="mapinfo_but mapinfo_but_open",o.title="显示左栏",T.g("cityBottom")&&baidu.dom.hide(T.g("cityBottom")),e.isGoing=!1,this.dispatchEvent("onHideSide",{action:"hide",size:{width:r,height:m,marginLeft:0}})}},show:function(){var e=this;if(e.status="open",a.sideStatus="open",!e.isGoing){e.isGoing=!0;var t=T.g("MapHolder"),i=T.g("map_info"),o=T.g("MapInfoTab"),s=map.getCenter(),m=n.getClientSize().height-98,r=n.getClientSize().width-a.LEFT_SIDE_WIDTH,d=T.g("StreetViewHolder"),l=a.LEFT_SIDE_WIDTH;i.style.left=0,o.style.left=l+"px",t.style.height=m+"px",t.style.marginLeft=l+"px",d.style.marginLeft=l+"px",map.addEventListener("resize",function(){map.setCenter(s),map.removeEventListener("resize",arguments.callee)}),o.className="mapinfo_but",o.title="收起左栏",e.isGoing=!1,T.g("cityBottom")&&baidu.dom.show(T.g("cityBottom")),this.dispatchEvent("onShowSide",{action:"show",size:{width:r,height:m,marginLeft:l}})}},bindEvent:function(){var e=this,t=T.g("MapInfoTab");T.on(t,"mouseover",function(){var t="mapinfo_but_close_on";"close"==e.status&&(t="mapinfo_but_open_on"),this.className="mapinfo_but "+t}),T.on(t,"mouseout",function(){var t="";"close"==e.status&&(t="mapinfo_but_open"),this.className="mapinfo_but "+t}),T.on(t,"click",function(){"open"==e.status?(addStat("indexleftmenu.placemenu.sidebarclose","click",{da_e_name:"pcmap3"}),e.slideHide()):(addStat("indexleftmenu.placemenu.sidebaropen","click",{da_e_name:"pcmap3"}),e.slideShow(),o.update())})}};m=baidu.lang.createSingle(m),i.exports=m});
;define("common:widget/ui/mapInfoScroll/mapInfoScroll.js",function(n,e,a){var l={panel:null,init:function(){var n=this,e=5;T.browser.ie&&(e=3),n.panel=new baidu.ui.ScrollPanel({container:"MapInfo",overflow:"overflow-y",margin:[5,e,5,0]}),n.panel.render("MapInfo")},update:function(n){if(!window.isPrint){n=n||{};var e=this,a=n.notToTop;e.panel&&e.panel.update(),a||e.panel.getScrollBar().scrollTo(0)}},show:function(){var n=this;if(n.panel){{n.panel.getTarget()}n.panel&&n.panel.setVisible(!0)}},hide:function(){var n=this;if(n.panel){{n.panel.getTarget()}n.panel&&n.panel.setVisible(!1)}}};a.exports=l});
;define("common:widget/ui/fullScreen/fullScreen.js",function(e,t,i){var n=e("common:widget/ui/util/util.js"),l=e("common:widget/ui/mapInfo/mapInfo.js"),o=e("common:widget/ui/history/history.js"),r=e("common:widget/ui/config/size.js"),s={isFullScreen:!1,isGoing:!1,timer:null,init:function(){this.toggleFullScreen(),this.bindEvent(),this.hasInit=!0},toFull:function(t){var i=this;if(!i.isGoing){i.isGoing=!0;var l=T.g("searchWrapper"),s=T.g("MapHolder"),a=(T.g("MapInfoCon"),T.g("MapInfoTab")),u=(T.g("tool_fullScrF"),""),c=map.getCenter(),g=(r.LEFT_SIDE_WIDTH,T.g("StreetViewHolder")),d=T("#map_info");d.hide();var f=n.getClientSize().height,m=n.getClientSize().width;T("#ui3_tool_fullScr").addClass("exit-fullscreen").find("span").text("退出"),window.GRControll&&window.GRControll.setGRequestFlg(1e3),"none"!=T.G("locSearch").style.display&&(u=T.G("PoiSearch").value),l.style.display="none",a.style.display="none",s.style.marginLeft=0,s.style.height=f+"px",g.style.marginLeft=0,map.fullScreenMode=i.isFullScreen=!0,map.addEventListener("resize",function(){map.setCenter(c),map.removeEventListener("resize",arguments.callee)}),i.isGoing=!1,null==t&&o.record({url:"isfullScreen=true"}),this.dispatchEvent("onFullScreen",{action:"enter",size:{width:m,height:f,marginLeft:0}}),e.async("common:widget/ui/setDefCity/SetDefCity.js",function(e){e.hideCityTip()}),addStat("indextool.toolbar.fullscreen","click",{da_e_name:"pcmap3"})}},exitFull:function(t){var i=this;if(!i.isGoing){i.isGoing=!0;var s=T.g("searchWrapper"),a=T.g("MapHolder"),u=T.g("MapInfoCon"),c=T.g("MapInfoTab"),g=(T.g("tool_fullScrF"),map.getCenter()),d=r.LEFT_SIDE_WIDTH,f=T.g("StreetViewHolder"),m=n.getClientSize().width,p=n.getClientSize().height-r.SEARCH_HEIGHT,h=0,S=m;T("#ui3_control_wrap .fullscreen").removeClass("exit-fullscreen"),"open"==l.status&&(S-=d),window.GRControll&&window.GRControll.setGRequestFlg(1e3);var y=T("#map_info");y.show(),s.style.display="",c.style.display="",T.g("cityBottom")&&baidu.dom.show(T.g("cityBottom")),"open"==l.status&&(m-=d,h+=d,u.style.left=0,a.style.marginLeft=d+"px",f.style.marginLeft=d+"px"),a.style.height=p+"px",map.fullScreenMode=i.isFullScreen=!1,map.addEventListener("resize",function(){map.setCenter(g),map.removeEventListener("resize",arguments.callee)}),i.isGoing=!1,null==t&&o.record({url:"isfullScreen=false"});var w="open"==l.status?d:0;this.dispatchEvent("onExitFull",{action:"exit",size:{width:m,height:p,marginLeft:w}}),e.async("common:widget/ui/setDefCity/SetDefCity.js",function(e){e.hideCityTip()}),addStat("indextool.toolbar.exitfullscreen","click",{da_e_name:"pcmap3"})}},toggleFullScreen:function(){this.isFullScreen?(this.exitFull(),listener.trigger("fullScreen","outFullScreen")):(this.toFull(),listener.trigger("fullScreen","inFullScreen"))},bindEvent:function(){var e=this;T.on(document,"keydown",function(t){t=window.event||t,27==t.keyCode&&e.isFullScreen&&setTimeout(function(){e.exitFull()},100)})},fullScreenState:function(){return this.isFullScreen?!0:!1}};i.exports=s=baidu.lang.createSingle(s),window.fullScreenCtrl=s});
;define("common:widget/ui/userMgr/userMgr.js",function(e,i,a){function n(e){var i=e.split("@");return i[0].length<3?e:(i[0]=i[0].charAt(0)+i[0].charAt(1)+"****"+i[0].charAt(i[0].length-1),i[0]+"@"+i[1])}function t(e){return e.substr(0,3)+"*****"+e.substr(e.length-3)}function o(e){if(!e)return"";var i="",a=e.uName,o=e.email,s=e.mobile;e.incomplete&&(a=e.displayname),a?i=a:o?i=n(o):s&&(i=t(s)),"thirdappid"in e&&!e.uName&&!e.email&&!e.mobile&&(i='<img src="http://passport.bdimg.com/passApi/img/icon_'+e.thirdappid+'_16.png" style="vertical-align:middle;padding-right:2px">'+i);var l=['<ul><li><a href="javascript:void(0)" class="return-old-link"><span></span>返回旧版地图</a></li><li class="line">|</li><li id="usernameInfo" style="height:22px;" class="uname mn-lk-w">'];return l.push(e.uName?'<a id="username" class="mn-lk" href="http://www.baidu.com/p/'+a+'?from=map">'+i+"<em></em></a>":'<a id="username" class="mn-lk" href="https://passport.baidu.com/v2/?ucenteradduname">'+i+"<em></em></a>"),l.push('<div id="popUserInfoId" style="width:80px;right:0;visibility:hidden;" class="mn-tip"><ul class="mn"><li>'),l.push(e.uName?'<a class="my-info" target="_blank" href="http://map.baidu.com/ugc/user/index">我的主页</a>':'<a class="my-info" target="_blank" href="https://passport.baidu.com/v2/?ucenteradduname">我的主页</a>'),l.push('</li><li><a class="my-info" href="'+m+'">帐号设置</a></li><li><a class="logout" href="javascript:void(0)">退出</a></li></ul></div>'),l.push('<li class="line">|</li>'),l.push('<li class="book-order"><a class="action" href="javascript:void(0);" >&nbsp;订单查询<em></em></a></li>'),l.push('<li class="line">|</li>'),l.push('<li><a href="http://nlbc.baidu.com/lbs-lbc/?from=maptop" target="_blank"  class="lbc_txt">商户免费标注</a><a href="http://lbsyun.baidu.com" target="_blank" data-stat-code="api">地图开放平台</a></li>'),l.push('<li class="line">|</li>'),l.push('<li><a href="http://www.baidu.com">百度首页</a></li>'),l.join("")}function s(){_?_.show():c.getLink(function(e){baidu.sio(p+"passApi/js/uni_login_wrapper.js?cdnversion="+(new Date).getTime()).callByBrowser(function(){baidu.g("passport-login-pop")||(_=passport.pop.init({apiOpt:{staticPage:h,product:"ma",charset:"utf-8",u:e||location.href,memberPass:!0,safeFlag:0,sms:2},cache:!1,authsite:w,authsiteCfg:{act:"implicit",u:e||location.href},tangram:!0,onRender:function(){try{var e=baidu.phoenix;window.baidu=window.T,window.baidu.phoenix=e;var i=$("#passport-login-pop-dialog");i.find(".pass-sms-link-back").text("百度帐号登录").css({position:"absolute",top:-185}),i.delegate(".pass-sms-link-back","click",function(){window.addStat("login.sms.back","click",{da_e_name:"pcmap3"})}).delegate(".pass-sms-btn","click",function(){window.addStat("login.id.back","click",{da_e_name:"pcmap3"})}).delegate(".pass-checkbox-memberPass","change",function(){$(this).prop("checked")||window.addStat("login.id.cancelChecked","click",{da_e_name:"pcmap3"})})}catch(a){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"common:widget/ui/userMgr/userMgr.js",ln:153})}},onShow:function(){$("#passport-login-pop-dialog .pass-checkbox-memberPass").prop("checked",!0)},onLoginSuccess:function(e){switch(e.currentTarget&&"sms"===e.currentTarget.currentLoginType?window.addStat("login.sms.login","click",{da_e_name:"pcmap3"}):window.addStat("login.id.login","click",{da_e_name:"pcmap3"}),r){case"fav":addStat("newfav.login.pvuv","click",{da_e_name:"pcmap3"});break;case"rightTopBanner":addStat("rightTopBanner.loginSuccess.pvuv","click",{da_e_name:"pcmap3"});break;case"poilistHoneypot":addStat("poilistHoneypot.loginSuccess.pvuv","click",{da_e_name:"pcmap3"});break;case"poilistNormal":addStat("poilistNormal.loginSuccess.pvuv","click",{da_e_name:"pcmap3"})}}}),_.show())})})}function l(e,i){var a=k++;e.innerHTML='<ul class="login-tab">                 <li class="tab-item tab-item-left tab-selected">                     <a href="#" onclick="return false;" hidefocus="true">普通登录</a>                 </li>                 <li class="tab-item tab-item-right">                     <a href="#" onclick="return false;" hidefocus="true">手机登录</a>                 </li>            </ul>            <div id="ss_pass_login_form'+a+'" class="tang-pass-loginPanel"></div>            <div id="otherLogin'+a+'" class="pass-phoenix-list" style="margin-left:55px;"></div>            <div class="nopass">没有百度帐号？<a href="https://passport.baidu.com/v2/?reg&regType=1&tpl=ma" target="_blank">立即注册</a></div>',baidu.sio(p+"phoenix/account/jsapi?a="+(new Date).getTime()).callByBrowser(function(){var e=baidu.phoenix;window.baidu=window.T,window.baidu.phoenix=e,baidu.phoenix.require(w,{target:"otherLogin"+a,tpl:"map",act:"implicit",html:{tsina:"新浪微博",renren:"人人网",qzone:"qq号",tqq:"腾讯微博"},u:i||location.href})}),baidu.sio(p+"passApi/js/wrapper.js?cdnversion="+(new Date).getTime()).callByBrowser(function(){function e(e,i){i.children("li").each(function(a){baidu(this).click(function(n){n.preventDefault(),i.children("li").removeClass("tab-selected"),baidu(this).addClass("tab-selected"),e.switchTo(["normal","phone"][a])})})}passport.use("login",{tangram:!1},function(n){var t=new n.passport.login({product:"map",staticPage:h,u:i||location.href,charset:"",memberPass:!0,safeFlag:0});t.on("loginSuccess",function(){top.location.reload()}),baidu("#ss_pass_login_form"+a).html(""),t.render("ss_pass_login_form"+a),e(t,baidu("#ss_pass_login_form"+a).prevAll("ul.login-tab"))})})}var r,c=e("common:widget/ui/mapShare/MapShare.js"),u=e("common:widget/ui/searchHistory/hisMgr.js"),p="https://passport.baidu.com/",d="http://mc.map.baidu.com/passport/Session3.php",m="http://passport.baidu.com/?center&tpl=ma&aid=7&default_tab=4",g="&tpl=ma",h="http://"+location.host+"/v3Jump.html",f="1",b="0",v=['<ul class="order-list" data-stat-code="order">','<li><a target="_blank" class="order-list-movie" href="/detail?qt=orderlist&type=movie">电影订单</a></li>',"</ul>"].join("");if(6==T.browser.ie||7==T.browser.ie)var w=["tsina","renren","tqq"];else var w=["qzone","tsina","renren","tqq"];var _,k=0,S={loginStatus:!1,defferd:T.Deferred(),init:function(e,i){var a=this;return this.update({onsuccess:function(){e&&e(),a.defferd.resolve()},onoffline:function(){i&&i(),a.defferd.reject()}}),this.generateOrder(),a.defferd.promise()},generateOrder:function(){var e;baidu.dom("#user_info").delegate(".book-order","mouseenter",function(){var i=baidu(this).find(".order-list");e&&clearTimeout(e),0==i.length&&(i=baidu(this).append(baidu(v))),i.show()}).delegate(".book-order","mouseleave",function(){var i=baidu(this).find(".order-list");i.length>0&&(e=setTimeout(function(){i.hide()},50))}).delegate(".order-list-hotel","click",function(){var e=S.userState&&S.userState.isOnline||"0";window.addStat(1,{da_src:"inf.order_hotel",from:"map",user:e})})},getState:function(e){T.jsonp(d,function(i){i&&e(i)})},login:function(e,i,a){e?l(e,i):(r=a,s())},logout:function(){u.clearAllLocalData(),c.getLink(function(e){window.location.href=p+"?logout"+g+"&u="+encodeURIComponent(e)})},showloginSug:function(){var e=this,i=[],a="<div id='unlogin' class='unlogin-search-tip'><img class='unlogin-search-text' src='/wolfman/static/common/images/transparent.gif' /><i title='关闭' class='close'></i></div>";i.push(a),baidu("#logout_user_info").insertHTML("beforeend",i.join("")),listener.on("fullScreen","inFullScreen",this.hide,this),listener.on("fullScreen","outFullScreen",this.show,this),T("#unlogin img").on("click",function(i){e.login(void 0,void 0,"rightTopBanner"),i.stopPropagation(),i.preventDefault(),i.returnValue=!1,addStat("rightTopBanner.login.pvuv","click",{da_e_name:"pcmap3"})}),T("#unlogin i").on("click",function(i){e.removeLoginSug(),i.stopPropagation(),i.preventDefault(),addStat("rightTopBannerClose.login.pvuv","click",{da_e_name:"pcmap3"})}),addStat("rightTopBanner.login.pvuv","show",{da_e_name:"pcmap3"})},removeLoginSug:function(){listener.off("fullScreen","inFullScreen",this.hide,this),listener.off("fullScreen","outFullScreen",this.show,this),T.dom.remove(T.g("unlogin")),T.cookie.set("UNLOGIN","2",{expires:36e5})},hide:function(){T("#unlogin").css("display","none")},show:function(){T("#unlogin").css("display","block")},update:function(e){e=e||{};var i=this,a=(T.g("login"),T.g("logout_user_info")),n=T.g("login_user_info");this.getState(function(t){function s(){i.tipTimer=setTimeout(function(){T.g("popUserInfoId").style.visibility="hidden"},200)}switch(i.userState=t,t.isOnline){case f:a.style.display="none",n.style.display="inline",n.innerHTML=o(t),T.g("username").onmouseover=function(){T.g("popUserInfoId").style.visibility="visible"},T.g("username").onmouseout=s,T.g("popUserInfoId").onmouseover=function(){window.clearTimeout(i.tipTimer)},T.g("popUserInfoId").onmouseout=s,baidu("#popUserInfoId a.logout").one("click",function(e){i.logout(),e.preventDefault()}),e&&e.onsuccess&&e.onsuccess(t),i.loginStatus=!0;break;case b:i.showloginSug(),a.style.display="inline",n.style.display="none",baidu("#login").on("click",function(e){e=window.event||e,baidu.event.preventDefault(e),i.login(),e.returnValue=!1}),i.loginStatus=!1,e&&e.onoffline&&e.onoffline(t)}})}};a.exports=S});
;define("common:widget/ui/signMgr/signMgr.js",function(e,n,a){function o(){var n=arguments;window.MapSignInst?o.fun(n):e.async(["common:widget/com/MapSign/MapSign.js","common:widget/ui/searchInfoWindow/searchInfoWindow.js"],function(e,a){new e({cinfo:{arg:n,searchInfoWindow:a}})}),map.on("maptypechange",function(e){e.mapType===BMAP_EARTH_MAP&&o.exituserSign()})}var t=(e("common:widget/com/componentManager.js"),e("common:widget/ui/mapShare/MapShare.js")),r=function(e){var n=T.g("shareInupt"),a=T.g("cpShareCon");e&&e.url&&(i=!0,a.style.display="inline",n.value=e.url,n.focus(),n.select(),window._iwUrlCbk&&window._iwUrlCbk(e.url))};o._USERSHARE=1,o._USERFAV=1,o.fun=function(e){1==e.length&&MapSignInst[e[0]](),e.length>1&&MapSignInst[e[0]](e[1])},o.userTagPanl=null,o.exituserSign=function(){o.userTagPanl&&o.userTagPanl.isVisible()&&MapSignInst.exituserSign()},o.mapSign={pointInfo:{list:{}},polylineInfo:{list:{}},remarkInfo:{list:{}}},o.temp={event:{}},o.deCodeShare=function(e){var e=e||"";return e.replace(/&amp;/g,"&").replace(/&lt;br\/&gt;/g,"<br/>")},o.cpShare=function(){var e=T.g("shareInupt").value;return o.cpShare.timer&&clearTimeout(o.cpShare.timer),window.clipboardData&&(window.clipboardData.clearData(),window.clipboardData.setData("Text",e)),T.g("usSharMes")&&(T.g("usSharMes").style.display="block"),o.cpShare.timer=setTimeout(function(){T.g("usSharMes")&&(T.g("usSharMes").style.display="none")},1e3),e},o.cpShareFF=function(){var e=(T.g("shareInupt").value,baidu.swf.createHTML({id:"signLinkBtnFlh",url:"/wolfman/static/common/swf/fClipboard.swf",width:"44",height:"24",wmode:"transparent",ver:"9.0.0"}));o.cpShareFF.checkFlash=function(){var e=baidu.swf.getMovie("signLinkBtnFlh");e&&e.flashInit&&e.flashInit()&&(clearInterval(o.cpShareFF.timer),e.setHandCursor(!0),e.setContentFuncName("_sign.cpShareFF.getPasteData"),e.setMEFuncName("_sign.cpShareFF.mouseEventHandler"))},o.cpShareFF.getPasteData=function(){var e=o.cpShare();return e},o.cpShareFF.mouseEventHandler=function(e){var n=T.g("cpShareCon");"mouse_over"==e?n.className="on":"mouse_down"==e?n.className="down":"mouse_up"==e?n.className="on":"mouse_out"==e&&(n.className="")},T.g("cpShareCon").innerHTML=e,o.cpShareFF.timer=setInterval(o.cpShareFF.checkFlash,500)},o.goShare=function(n){T.g("iw_tool_box")?T.g("iw_tool_box").style.top="-2000px":null;var a=T.g("iw_share_con");e.async("common:widget/com/SharePanel/SharePanel.js",function(e){new e({dom:a,cinfo:{from:"iwshare",data:n}});a.style.display="",o._goShare(n)})},o._goShare=function(e){T.g("shareInupt").style.display="block",T.g("cpShareCon_").style.display="none";var e=e&&e.uid?e:null,n=(T.g("shareInupt"),T.g("cpShareCon")),a="http://map.baidu.com/?";if(T.browser.chrome&&(T.g("iwBoxShareInput").style.padding="0 93px 0 2px"),T.g("shareInupt").onfocus=function(){this.select()},T.browser.ie){if(n){var u=function(e){0==e.button&&(this.className="down")},c=function(){this.className="on"},p=function(){this.className=""};n.onclick=function(){o.cpShare()},T.on(n,"mouseover",c),T.on(n,"mousedown",u),T.on(n,"mouseup",c),T.on(n,"mouseout",p),o.temp.event.shareCopy=[{obj:n,type:"mouseover",fun:c},{obj:n,type:"mousedown",fun:u},{obj:n,type:"mouseup",fun:c},{obj:n,type:"mouseout",fun:p}]}}else o.cpShareFF();var l=function(){var e=t.SHARE_PROC_URL+"?url="+encodeURIComponent(a)+"&web=true";i=!1,T.jsonp(e,r),clearTimeout(s),s=setTimeout(function(){0==i&&r({url:a})},3e3)};if(e)a+="shareurl=1&poiShareUid="+e.uid+"&cityCode="+e.cityCode+"&tn="+map.mapType,map._isHybridShow&&(a+="&hb="+BMAP_TYPE_HYBIRD),l();else{var h=MapSignInst.temp.iw.index,m=o.mapSign.pointInfo.list[h];MapSignInst.getSignLink(baidu.json.stringify(m),function(e){if(1!=e.result)return T.g("shareInupt").style.display="none",n.style.display="none",T.g("cpShareCon_").style.display="block",void(T.g("cpShareCon_").innerHTML="有不符合相关法规政策的词，请修改");var o=e.content.shareId;a+="poiShareId="+o,a+="&tn="+map.mapType,map._isHybridShow&&(a+="&hb="+BMAP_TYPE_HYBIRD),l()},"single")}},o.reShare=function(){if(T.g("iw_share_con").style.display="none",o.temp.event.shareCopy&&o.temp.event.shareCopy.length>0)for(var e=o.temp.event.shareCopy,n=0;n<e.length;n++){var a=e[n];T.un(a.obj,a.type,a.fun)}};var i=!0,s=null;o.parseShare=function(e){var n="/userflag/share.php?act=read_share&shareId="+e+"&t="+(new Date).getTime();baidu.ajax(n,{dataType:"json",success:function(e){if(e=e||{},1==e.result){var n=e.content;o("parseAllShare",n)}else o(),alert("数据已经删除")},error:function(){}})},window._sign=o,a.exports=o});
;define("common:widget/ui/toast/toast.js",function(e,t,o){var i,s=T("#info-tip-wrapper"),a=T("#info-tip"),n=a.find(".info-tip-text");s.on("mouseenter",function(){clearTimeout(i),s.removeClass("active")});var c={show:function(e,t){clearTimeout(i);t||(t="success"),s.addClass("active"),n.html(e),a.removeClass().addClass(t),i=setTimeout(function(){s.removeClass("active")},3e3)}};o.exports=c});
;define("common:widget/ui/fav/favMgr.js",function(require,exports,module){function judge_CN(e,t){for(var i=charPYStr,a=0;a<(e.length>t.length?e.length:t.length);a++)if(e.charAt(a)!=t.charAt(a))return i.indexOf(e.charAt(a))>i.indexOf(t.charAt(a))?1:-1;return 0}function sortByTime(e,t){return t.getData().mtime-e.getData().mtime}function sortByChinese(opts){return opts=opts||{},sortMod?function(e,t){var i=e.name,a=t.name;return i.localeCompare(a)}:function(obj_a,obj_b){var flag,a=obj_a.name[0],b=obj_b.name[0];return/^(\+|-)?\d+($|\.\d+$)/.test(a)&&/^(\+|-)?\d+($|\.\d+$)/.test(b)?(a=eval(a),b=eval(b),flag=a>b?1:b>a?-1:0):(a=a.toString(),b=b.toString(),flag=a.charCodeAt(0)>=19968&&b.charCodeAt(0)>=19968?judge_CN(a,b):a>b?1:b>a?-1:0),flag}}function copyModels(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i]);return t}function hasGeo(e){return e.detail&&e.detail.data&&e.detail.data.extdata&&(e.detail.data.extdata.geoptx||e.detail.data.extdata.geopty)}function getDataType(e){var t={10:"poi",11:"poi",20:"line",21:"line",22:"line",23:"line",30:"tag"},i=String(e.sid).match(/(\d+)_/);return i?t[i[1]]:void 0}var config=require("common:widget/ui/config/config.js"),modelConfig=config.modelConfig,boxMgr=require("common:widget/ui/BoxContainer/BoxContainer.js"),userMgr=require("common:widget/ui/userMgr/userMgr.js"),PoiModel=require("common:widget/ui/fav/PoiModel.js"),LineModel=require("common:widget/ui/fav/LineModel.js"),mapUtil=require("common:widget/ui/mapUtil/mapUtil.js"),toast=require("common:widget/ui/toast/toast.js"),charPYStr=require("common:widget/ui/fav/FavSortPY.js"),LOGIN_PENDING=-1,LOGIN_ONLINE=1,LOGIN_OFFLINE=0,SORT_TYPE_TIME="1",SORT_TYPE_LETTER="2",LIMIT=100,deferred=T.Deferred(),poiDeferred=T.Deferred(),poiModels=[],rawData=[],filteredPoiModels=[],editModels=[],__bySid={},__byUid={},__byTagId={},loginState=LOGIN_PENDING,curPage=0,curSort=SORT_TYPE_TIME,PAGE_COUNT=10,filters=[[],[],[],[]],FILTER_TYPE_TAG=1,FILTER_TYPE_TYPE=3,FILTER_TYPE_REG=2,lastVer="0",lineModels=[],curLinePage=0,REQUEST_URL=modelConfig.DATA_URL+"fav",sortMod="百度".localeCompare("地图")>1?0:1,favMgr={init:function(){loginState=LOGIN_ONLINE;var e=Math.round(1e5*Math.random());T.cookie.set("validate",e,{path:"/"});var t=this,i=(new Date).getTime();return T.when(this.getFavData(),this.getFilterData()).then(function(e,a){t.genModels(e),t.genFilters(a),deferred.resolve(poiModels,filters);var e={};e.z_fav_dataload=(new Date).getTime()-i,window.alog("cus.fire","time",e)},function(){deferred.resolve([],[])}),this.bindListeners(),deferred},offline:function(){loginState=LOGIN_OFFLINE,deferred.reject()},bindListeners:function(){listener.on("fav.poi.model","rename",function(){toast.show("重命名成功")}),listener.on("fav.poi.model","remove",function(){toast.show("删除成功")}),listener.on("fav.poi.model","add",function(){toast.show("添加成功")}),listener.on("fav.poi.model","changetag",function(){toast.show("标签操作成功")}),listener.on("fav.line.model","remove",function(){toast.show("删除成功")}),listener.on("fav.line.model","add",function(){toast.show("添加成功")}),listener.on("fav.poi.model","exceeded",function(){toast.show("已达到1000个收藏点上限","warning")}),listener.on("fav.poi.model","invalid",function(){toast.show("该地点已失效","warning")})},getFilterData:function(){var e=T.Deferred();return this.getData("&mode=get&type=tag",function(t){e.resolve(t&&t.favindexs?t.favindexs.favindex:[])},function(){e.resolve([])}),e},updateFilterData:function(){var e=this;this.getData("&mode=get&type=tag",function(t){t&&t.favindexs&&(e.genFilters(t.favindexs.favindex),listener.trigger("fav.poi.tag","change",e.getFilters()))})},getFavData:function(){var e=this;return this.getData("&mode=get&type=favdata&limit="+LIMIT,function(t){return t.result&&8===t.result.error?void e.getFavData():void(t&&t.sync?(t.sync.lastver&&(lastVer=t.sync.lastver),t.sync.newdata&&(rawData=rawData.concat(t.sync.newdata)),"0"===t.sync.newnum?poiDeferred.resolve(rawData):t.sync.newnum?e.getFavData():poiDeferred.resolve(rawData)):poiDeferred.resolve(rawData))},function(e){poiDeferred.reject(e)}),poiDeferred},updateFavData:function(){var e=this;this.getData("&mode=get&type=favdata&limit="+LIMIT,function(t){t&&t.sync&&(t.sync.lastver&&(lastVer=t.sync.lastver),t.sync.newnum&&"0"!==t.sync.newnum&&e.updateFavData(),e.sync(t.sync))})},genModels:function(e){if(e)for(var t=e.length-1;t>=0;t--)if("del"!==e[t].action&&100==e[t].status){var i=getDataType(e[t]);if("poi"===i&&hasGeo(e[t])){var a=new PoiModel(e[t]);poiModels.push(a),__bySid[a.sid]=a,__byUid[a.uid]=a,a.tag&&(__byTagId[a.tag.indexid]=a)}else if("line"===i){var a=new LineModel(e[t]);lineModels.push(a),__bySid[a.sid]=a}}},genFilters:function(e){filters=[[],[],[],[]];for(var t=0;t<e.length;t++)filters[e[t].type].push(e[t])},getTags:function(){return filters[FILTER_TYPE_TAG]},getFilters:function(){return filters},sort:function(e,t,i){e||(e=curSort),e===SORT_TYPE_LETTER?(curSort=SORT_TYPE_LETTER,filteredPoiModels.sort(sortByChinese())):(curSort=SORT_TYPE_TIME,filteredPoiModels.sort(sortByTime)),this.setPage(t||0,i)},filter:function(e,t){var i=this;e?this.getData("&mode=get&type=filter&tids="+e,function(e){if(filteredPoiModels=[],e.favdatas)for(var a=e.favdatas.favdata,n=0;n<a.length;n++){var o=__bySid[a[n].fid];o&&filteredPoiModels.push(o)}i.sort(curSort,t,!0)}):(filteredPoiModels=copyModels(poiModels),i.sort(curSort,t))},setPage:function(e,t){(!T.isNumber(e)||0>e)&&(e=0),curPage=e;var i=this.slicePoiModels();return i.length||0===curPage?void this.panel.setPoiPage(i,curPage,Math.ceil(filteredPoiModels.length/PAGE_COUNT),t):void this.setPage(curPage-1,t)},setLinePage:function(e){(!T.isNumber(e)||0>e)&&(e=0),curLinePage=e;var t=this.sliceLineModels();return t.length||0===curLinePage?void this.panel.setLinePage(t,curLinePage,Math.ceil(lineModels.length/PAGE_COUNT)):void this.setLinePage(curLinePage-1)},slicePoiModels:function(){return filteredPoiModels.slice(curPage*PAGE_COUNT,curPage*PAGE_COUNT+PAGE_COUNT)},sliceLineModels:function(){return lineModels.slice(curLinePage*PAGE_COUNT,curLinePage*PAGE_COUNT+PAGE_COUNT)},openPanel:function(){var e=this;"pending"===deferred.state()&&boxMgr.show(),deferred.then(function(){e.showPanel()},function(){e.showPanel(),loginState===LOGIN_OFFLINE&&userMgr.login(void 0,void 0,"fav")})},getModel:function(e){return __bySid[e]},getModelByUid:function(e){return __byUid[e]},getModelByTagId:function(e){return __byTagId[e]},getSidByData:function(e){for(var t=0;t<poiModels.length;t++){var i=poiModels[t];if(i.name===e.name&&(i.addr===e.addr||i.addr==="地址:"+e.addr)&&i.pointStr===e.pointStr)return i.sid}return!1},showPanel:function(){var e=this;require.async("common:widget/com/FavPanel/FavPanel.js",function(t){e.panel?boxMgr.show():(addStat("newfav.panel.pvuv","show",{da_e_name:"pcmap3"}),filteredPoiModels=copyModels(poiModels),e.panel=new t({isLogin:loginState===LOGIN_ONLINE,poiModels:e.slicePoiModels(),lineModels:e.sliceLineModels(),filters:filters,poiTotal:Math.ceil(filteredPoiModels.length/PAGE_COUNT),lineTotal:Math.ceil(lineModels.length/PAGE_COUNT)}),e.panel.render(),boxMgr.show(),e.panel.initialize())})},getData:function(e,t,i){T.ajax(REQUEST_URL+e+"&lastver="+lastVer+"&t="+(new Date).getTime(),{dataType:"json",method:"get",success:function(e){t&&t(e)},error:function(e){i&&i(e)}})},postData:function(e,t,i){var a=T.cookie.get("validate");t=T.extend(t,{validate:a}),T.ajax(REQUEST_URL+e+"&lastver="+lastVer,{data:t,dataType:"json",method:"post",success:function(e){e&&e.sync&&(lastVer=e.sync.lastver),e?e.sync?i&&i(e.sync):e.favindexs&&i&&i(e.favindexs.favindex):i&&i()},error:function(){}})},checkState:function(e){return loginState===LOGIN_ONLINE?(e&&e(),!0):(userMgr.login(void 0,void 0,"fav"),!1)},addFav:function(e,t){if(this.checkState()){addStat("newfav.poi.add","click",{da_e_name:"pcmap3"});var i="&mode=add&type=favdata",a=this;if(1===e){var n={type:"10",sourceid:t.uid,plateform:3,fromapp:"百度地图",extdata:{name:t.name,geoptx:t.x,geopty:t.y}};this.postData(i,{data:T.json.stringify(n)},function(e){a.sync(e)})}else if(2===e){var n={type:"11",sourceid:"",plateform:3,fromapp:"百度地图",extdata:{name:t.name,content:t.content,geoptx:t.x,geopty:t.y}};this.postData(i,{data:T.json.stringify(n)},function(e){a.sync(e)})}}},rename:function(e,t){addStat("newfav.rename.add","click",{da_e_name:"pcmap3"});var i=this;t=t||"",t=t.substring(0,20);var a=this.getModel(e);if(a){var n="&mode=modify&type=remark",o={name:t,geoptx:a.get("extdata").geoptx,geopty:a.get("extdata").geopty};"11"===a.type&&(o.content=a.addr),this.postData(n,{data:T.json.stringify([{cid:a.cid,sid:a.sid,action:"modify",detail:T.json.stringify({data:T.json.stringify({type:a.type,sourceid:a.uid,fid:a.sid,extdata:o})})}])},function(e){i.sync(e)},200)}},removeFavs:function(e){for(var t=this,i=[],a=0;a<e.length;a++){var n=this.getModel(e[a]);n&&i.push({cid:n.cid,sid:n.sid,action:"del"})}var o="&mode=delete&type=favdata";this.postData(o,{data:T.json.stringify(i)},function(e){t.sync(e)})},removeFav:function(e,t){addStat("newfav.poi.remove","click",{da_e_name:"pcmap3"});var i,a=this;if(i="uid"===t?this.getModelByUid(e):this.getModel(e)){var n="&mode=delete&type=favdata";this.postData(n,{data:T.json.stringify([{cid:i.cid,sid:i.sid,action:"del"}])},function(e){a.sync(e)})}},sync:function(e){var t,i={poi:{add:[],del:[],modify:[]},line:{add:[],del:[]},tag:[]},a=[];if(e&&e.newdata)for(var n=e.newdata.length-1;n>=0;n--){var o=e.newdata[n],d=getDataType(o);100==o.status?"poi"===d?(t=this.syncPoi(o),t&&i[d][t.type].push(t)):"tag"===d?(t=this.syncTag(o),t&&i[d].push(t)):"line"===d&&(t=this.syncLine(o),t&&i[d][t.type].push(t)):a.push(o.status)}-1!=T.array.indexOf(a,106)&&listener.trigger("fav.poi.model","exceeded",106),i.poi.add.length&&(listener.trigger("fav.poi.model","add",i.poi.add),this.updateFilterData()),i.poi.del.length&&(listener.trigger("fav.poi.model","remove",i.poi.del),this.updateFilterData()),i.line.add.length&&listener.trigger("fav.line.model","add",i.line.add),i.line.del.length&&listener.trigger("fav.line.model","remove",i.line.del),i.tag.length&&listener.trigger("fav.poi.model","changetag",i.tag)},syncPoi:function(e){if("del"===e.action){var t=this.getModel(e.sid);if(t)return this.removePoiFromLocal(t),t.remove(),{type:"del",id:t.sid,uid:t.uid}}else if("modify"===e.action){var t=this.getModel(e.sid);if(t)return t.rename(e.detail.data.extdata.name),{type:"modify",id:t.sid,uid:t.uid}}else if("add"===e.action&&(__bySid[e.sid]&&this.removePoiFromLocal(__bySid[e.sid]),hasGeo(e))){var t=new PoiModel(e);if(t)return poiModels.unshift(t),__bySid[t.sid]=t,__byUid[t.uid]=t,t.tag&&(__byTagId[t.tag.indexid]=t),{type:"add",id:t.sid,uid:t.uid}}},syncLine:function(e){if("del"===e.action){var t=this.getModel(e.sid);if(t)return this.removeLineFromLocal(t),t.remove(),{type:"del",id:t.sid}}else if("add"===e.action){var t=new LineModel(e);if(t)return lineModels.unshift(t),__bySid[t.sid]=t,{type:"add",id:t.sid}}},syncTag:function(e){if("del"===e.action){var t=this.getModelByTagId(e.sid);if(t)return t&&t.removeTag(e.sid),__byTagId[e.sid]=void 0,{type:"del",id:t.sid}}else if("add"===e.action){var t=this.getModel(e.detail.data.fid);if(t)return t.addTag(e.detail.data),__byTagId[t.tag.indexid]=t,{type:"add",id:t.sid}}},removePoiFromLocal:function(e){__bySid[e.sid]=void 0,__byUid[e.uid]=void 0,e.tag&&(__byTagId[e.tag.indexid]=void 0);var t=T.array.indexOf(poiModels,e);poiModels.splice(t,1),t=T.array.indexOf(filteredPoiModels,e),filteredPoiModels.splice(t,1)},removeLineFromLocal:function(e){__bySid[e.sid]=void 0;var t=T.array.indexOf(lineModels,e);lineModels.splice(t,1)},changeModelsTag:function(e,t){var i=[],a="&mode=modify&type=tag_poi",n=this;if(t)for(var o=0;o<e.length;o++){var d=this.getModel(e[o]);if(d){if(d.tag){if(d.tag.name===t)continue;i.push({action:"del",sid:d.tag.indexid})}i.push({action:"add",cid:"",detail:T.json.stringify({data:T.json.stringify({type:"30",name:t,fid:d.sid})})})}}i.length&&this.postData(a,{data:T.json.stringify(i)},function(e){n.sync(e)})},changeModelTag:function(e,t){var i=this.getModel(e),a="&mode=modify&type=tag_poi",n=[],o=this;if(i&&(i.tag||t)){if(i.tag){if(i.tag.name===t)return;n.push({action:"del",sid:i.tag.indexid,cid:""})}t&&n.push({action:"add",cid:"",detail:T.json.stringify({data:T.json.stringify({type:"30",name:t,fid:i.sid})})})}n.length&&this.postData(a,{data:T.json.stringify(n)},function(e){o.sync(e)})},addTag:function(e){addStat("newfav.tag.add","click",{da_e_name:"pcmap3"});var t=this;e=e||"",e=e.substring(0,6);var i="&mode=add&type=tag";this.postData(i,{tags:e},function(e){t.genFilters(e),listener.trigger("fav.poi.tag","change",t.getFilters())})},removeTag:function(e){addStat("newfav.tag.remove","click",{da_e_name:"pcmap3"});var t=this,i="&mode=delete&type=tag";this.postData(i,{tid:e},function(e){t.genFilters(e),listener.trigger("fav.poi.tag","change",t.getFilters()),t.updateFavData()})},addEditModel:function(e){editModels.push(e),listener.trigger("fav.poi.model","select",{id:e.sid}),e.highlightMarker();for(var t=[],i=0;i<editModels.length;i++)t.push(editModels[i].marker.point);mapUtil.setViewport(t)},removeEditModel:function(e){var t=T.array.indexOf(editModels,e);t>-1&&editModels.splice(t,1),e.unhighlightMarker(),listener.trigger("fav.poi.model","unselect",{id:e.sid});for(var i=[],a=0;a<editModels.length;a++)i.push(editModels[a].marker.point);mapUtil.setViewport(i)},clearEditModels:function(){for(var e=0;e<editModels.length;e++)listener.trigger("fav.poi.model","unselect",{id:editModels[e].sid}),editModels[e].unhighlightMarker();editModels=[]},getEditModels:function(){return editModels},inEditModels:function(e){return-1!==T.array.indexOf(editModels,e)},openTagInfoWnd:function(){for(var e=[],t=0;t<editModels.length;t++)e.push(editModels[t].sid);require.async("common:widget/ui/fav/FavTagInfoWindow.js",function(t){var i=new t(editModels[0].marker,{ids:e},function(){});i.show(),i.iw.addEventListener("close",function(){listener.trigger("fav.poi","canceledit")})})},openRemoveInfoWnd:function(){for(var e=[],t=0;t<editModels.length;t++)e.push(editModels[t].sid);require.async("common:widget/ui/fav/FavRemoveInfoWindow.js",function(t){var i=new t(editModels[0].marker,{ids:e},function(){});i.show(),i.iw.addEventListener("close",function(){listener.trigger("fav.poi","canceledit")})})},openTagManager:function(){var e=this;require.async("common:widget/ui/fav/TagManagerPopup.js",function(t){t.render(),t.setTags(e.getTags())})},getLineModels:function(){return lineModels},addLineFav:function(e,t){if(this.checkState()){addStat("newfav.line.add","click",{da_e_name:"pcmap3"});var i;0===e.pathtype?i="20":1===e.pathtype?i="21":2===e.pathtype?i="22":3===e.pathtype&&(i="23");var a="&mode=add&type=favdata",n=this,o={type:i,plateform:3,fromapp:"百度地图",extdata:e};this.postData(a,{data:T.json.stringify(o)},function(e){t&&t(e),n.sync(e)})}},removeLineFav:function(e,t){addStat("newfav.line.remove","click",{da_e_name:"pcmap3"});var i=this,a=this.getModel(e);if(a){var n="&mode=delete&type=favdata";this.postData(n,{data:T.json.stringify([{cid:a.cid,sid:a.sid,action:"del"}])},function(e){t&&t(e),i.sync(e)})}}};module.exports=favMgr});
;define("common:widget/ui/fav/PoiModel.js",function(e,t,i){function n(e){this.data=e,this.sid=e.sid,this.uid=this.getData().sourceid,this.type=this.getData().type,this.tags={},this.setProperties(e),this.marker=this.draw()}var a=e("common:widget/ui/constant/Constant.js"),o=e("common:widget/ui/util/util.js"),s=e("common:widget/ui/constant/Constant.js"),r={1:"",2:"来自iPad",3:"",4:"来自手机",5:"来自手机"};T.extend(n.prototype,{getData:function(){return this.data&&this.data.detail&&this.data.detail.data?this.data.detail.data:{}},get:function(e){return this.getData()[e]?this.getData()[e]:{}},setProperties:function(){var e=this.getData(),t=this.get("extdata"),i=this.get("sourcedata");this.name=t.name,this.pointStr=t.geoptx+","+t.geopty,"10"===this.type?this.setSourceData(i):(this.addr=t.content||i.address,this.image=void 0);var n=new Date;if(n.setTime(1e3*e.mtime),this.date=T.date.format(n,"yyyy-MM-dd"),e.tags)for(var a=0;a<e.tags.length;a++)"1"===e.tags[a].type&&(this.tags[e.tags[a].indexid]=e.tags[a],this.tag=e.tags[a]);this.from=r[e.plateform]||""},setSourceData:function(e){this.addr=e.addr,this.image=e.ext&&e.ext.detail_info?e.ext.detail_info.image:void 0},getConfig:function(){return{commonMarker:{image:"http://webmap2.map.bdstatic.com/wolfman/static/common/images/fav-icon-map_e560cba.png",size:new BMap.Size(13,12),offset:new BMap.Size(7,7),imageOffset:new BMap.Size(0,0),infoWindowOffset:new BMap.Size(7,0),imageSize:new BMap.Size(13,12),srcSet:{"2x":"http://webmap1.map.bdstatic.com/wolfman/static/common/images/fav-icon-map2x_15f7911.png"}},highlightMarker:{image:"http://webmap0.map.bdstatic.com/wolfman/static/common/images/fav/marker_39abd56.png",size:new BMap.Size(18,27),offset:new BMap.Size(9,27),imageOffset:new BMap.Size(0,0),infoWindowOffset:s.A_J_MARKER_INFOWND_OFFSET}}},draw:function(){var e=this,t=this.get("extdata"),i=new BMap.Point(t.geoptx,t.geopty),n=new BMap.Marker(i,{enableMassClear:!1,title:e.name}),a=this.getIcon(this.getConfig().commonMarker);return n.setIcon(a),n.addEventListener("click",function(){e.openInfoWnd()}),n.addEventListener("mouseover",function(){n.setTop(!0,27e7)}),n.addEventListener("mouseout",function(){n.setTop(!1)}),map.addOverlay(n),n},getIcon:function(e){return new BMap.Icon(e.image,e.size,{offset:e.offset,imageOffset:e.imageOffset,infoWindowOffset:e.infoWindowOffset,imageSize:e.imageSize,srcSet:e.srcSet})},openInfoWnd:function(){var e=this,t=this.marker.getPoint(),i={fav:1,title:T.encodeHTML(e.name),content:e.addr||""};if("10"===e.type)e.fetch(function(n){listener.trigger("fav.poi.model","select",{id:e.sid}),e.getInfoData(n,i,t)},function(){listener.trigger("fav.poi.model","invalid",{id:e.sid})});else{listener.trigger("fav.poi.model","select",{id:e.sid}),i.sid=e.sid,i.userSign=1;var n=e.addr||"";n=n.split("<br/>");for(var a=0;a<n.length;a++)n[a]=T.encodeHTML(n[a]);i.content=n.join("<br/>"),o.loadSearchInfo(function(n){var a=n.createSearchInfoWnd(i,{x:t.lng,y:t.lat,cityCode:e.get("sourcedata").address_detail&&e.get("sourcedata").address_detail.city_code});e.highlightMarker(),a.addEventListener("close",function(){e.unhighlightMarker(),listener.trigger("fav.poi.model","unselect",{id:e.sid})}),n.openSearchInfoWndPOI(a,e.marker)})}},getInfoData:function(e,t,i){var n=this,s=e.content,r=s.addr,d=s.tel,c=s.detail&&s.ty==a.GEO_TYPE_POINT||s.poiType==a.POI_TYPE_BUSLINE||s.poiType==a.POI_TYPE_SUBLINE;(s.poiType==a.POI_TYPE_BUSSTOP||s.poiType==a.POI_TYPE_SUBSTOP)&&(r=T.array.unique(r.split(";")).join("; ")),d&&(d=d.replace(/,/g,", ")),o.loadSearchInfo(function(e){var a=e.createSearchInfoWnd(T.object.extend(t,{addr:r,tel:d,hasDetail:c,detail:s.detail,ext_type:s.ext_type,uid:s.uid,poiType:s.poiType,ext:s.ext,cp:s.cp,cla:s.cla,catId:s.new_catalog_id||"",title:T.encodeHTML(n.name)||"",pano:s.pano,cla:s.cla,status:s.status,cp:s.cp,catId:s.new_catalog_id||""}),{x:i.lng,y:i.lat,cityCode:n.get("sourcedata").city_id});n.highlightMarker(),a.addEventListener("close",function(){n.unhighlightMarker(),listener.trigger("fav.poi.model","unselect",{id:n.sid})}),e.openSearchInfoWndPOI(a,n.marker)})},openRenameInfoWnd:function(){var t=this;e.async("common:widget/ui/fav/FavRenameInfoWindow.js",function(e){var i=new e(t.marker,t.sid,function(){t.openInfoWnd()});setTimeout(function(){t.highlightMarker()},10),map.setCenter(t.marker.point),listener.trigger("fav.poi.model","select",{id:t.sid}),i.show(),i.iw.addEventListener("close",function(){t.unhighlightMarker(),listener.trigger("fav.poi.model","unselect",{id:t.sid})})})},openRemoveInfoWnd:function(){var t=this;e.async("common:widget/ui/fav/FavRemoveInfoWindow.js",function(e){var i=new e(t.marker,{id:t.sid},function(){t.openInfoWnd()});setTimeout(function(){t.highlightMarker()},10),map.setCenter(t.marker.point),listener.trigger("fav.poi.model","select",{id:t.sid}),i.show(),i.iw.addEventListener("close",function(){t.unhighlightMarker(),listener.trigger("fav.poi.model","unselect",{id:t.sid})})})},openTagInfoWnd:function(){var t=this;e.async("common:widget/ui/fav/FavTagInfoWindow.js",function(e){var i=new e(t.marker,{id:t.sid,tag:t.tag},function(){t.openInfoWnd()});setTimeout(function(){t.highlightMarker()},10),map.setCenter(t.marker.point),listener.trigger("fav.poi.model","select",{id:t.sid}),i.show(),i.iw.addEventListener("close",function(){listener.trigger("fav.poi.model","unselect",{uid:t.sid}),t.unhighlightMarker()})})},rename:function(e){this.name=e,this.marker.setTitle(e),listener.trigger("fav.poi.model","rename",{id:this.sid,name:e,uid:this.uid})},removeTag:function(e){this.tags[e]=void 0,delete this.tags[e],this.tag=void 0;for(var t in this.tags)this.tag=this.tags[t]},addTag:function(e){this.tags[e.indexid]=e,this.tag=e},remove:function(){map.removeOverlay(this.marker)},unhighlightMarker:function(){this.marker.setIcon(this.getIcon(this.getConfig().commonMarker))},highlightMarker:function(){this.marker.setIcon(this.getIcon(this.getConfig().highlightMarker),"marker-raise")},fetch:function(e,t){if(this.uid){var i="/?qt=inf&uid="+this.uid+"&ie=utf-8&t="+(new Date).getTime();T.ajax(i,{dataType:"json",success:function(i){return i&&i.content?void(e&&e(i)):void(t&&t())},error:function(e){console.log("sendUidRequest qt=inf",e)}})}},fill:function(){var e=this;this.fetch(function(t){e.getData().sourcedata=t.content,e.setSourceData(e.get("sourcedata")),listener.trigger("fav.poi.model","fetch",{id:e.sid})})}}),i.exports=n});
;define("common:widget/ui/fav/LineModel.js",function(t,e,a){function i(t){this.data=t,this.sid=t.sid,this.setData(t)}var n=t("common:widget/com/componentManager.js"),s=t("common:widget/ui/util/util.js"),d=t("common:widget/ui/config/config.js"),o=d.modelConfig,p={0:"car",1:"bus",2:"walk",3:"bike",5:"car",6:"bus",7:"bus",9:"bus"},c={0:"train",1:"plane"};T.extend(i.prototype,{getData:function(){return this.data&&this.data.detail&&this.data.detail.data?this.data.detail.data:{}},get:function(t){return this.getData()[t]?this.getData()[t]:{}},setData:function(){var t=this.getData(),e=this.get("extdata");this.name=e.pathname;var a=new Date;a.setTime(1e3*t.mtime),this.date=T.date.format(a,"yyyy-MM-dd"),this.type=p[e.pathtype],this.subtype="bus"===this.type?c[e.transkind]?c[e.transkind]:"bus":this.type},remove:function(){},openLine:function(){var t=this.data.detail.data.extdata,e=2,a=2,i=t.curcityid,d=t.pagenumber||0,p=t.wp,c={},r="",u="",y="",$="",h="",g="",m="",f="",l="",x=t.sfavnode,v=t.efavnode,b=x.cityid,k=v.cityid,w=x.uid,D=v.uid,_=encodeURIComponent(x.name),T=encodeURIComponent(v.name),j=t.trafType||0;switch(t.pathtype){case 0:case 5:var I=o.pk_dict[t.pathtype];g="nav",h=I[t.plankind].sy;break;case 1:case 6:case 7:if(g="bt",isNaN(parseInt(t.transkind,10))){var I=o.pk_dict[t.pathtype].favDict;h=I[t.plankind]?I[t.plankind].sy||0:0,4==h&&(h=0,l="[0,2,4,7,5,8,9,10,11]",j=1),c={_index:(t.busidx||0)+",1,1",trafType:j}}else f=o.pk_dict[9][t.plankind].sy||0,m=t.transkind,c={_index:(t.busidx||0)+",1,1"};break;case 2:g="walk";break;case 3:g="cycle"}if(x.geoptx&&(e=1,y=x.geoptx+","+x.geopty),x.uid&&0==x.type&&(e=0),v.geoptx&&(a=1,$=v.geoptx+","+v.geopty),v.uid&&0==v.type&&(a=0),p&&p.length>2){for(var M=1;M<p.length-1;M++)r+="1$$$$"+p[M].p+"$$$$+to:",u+="0 +to:";a=1}k=u?u+k:k;var C={c:i,sn:e+"$$"+w+"$$"+y+"$$"+_+"$$$$$$",en:r+a+"$$"+D+"$$"+$+"$$"+T+"$$$$$$",sy:h,f:l,pn:d,csy:f,cty:m};b&&(C.sc=b,C.ec=k),("bt"==g||"bse"==g)&&(C.exptype=t.exptype||"dep",C.exptime=t.exptime||"",C.version=5),("nav"==g||"nse"==g)&&(C.version=4,C.mrs=1,C.route_traffic=1,t.routeIndex&&(c._index=t.routeIndex)),p&&p.length>2&&(C.drag=1);var L=g+"&"+s.jsonToQuery(C);n.go(L,{cinfo:c})}}),a.exports=i});
;define("common:widget/ui/mapShare/MapShare.js",function(n,t,o){function i(n){for(var t in n)return 0;return 1}function e(n,t,o){var i="",e=t;o.width&&(i=' style="width:'+o.width+'px"');var p='<div id="mapCommonTip" class="map_cTip"'+i+'><div class="tip">'+n+"</div><button ></button></div>";T.g("mapCommonTip")?T.g("mapCommonTip").style.display="":l.beforeEndHTML(e.getContainer(),p),T.g("mapCommonTip").style.left=parseInt(e.width)/2-o.width/2+"px",setTimeout(function(){a()},2e3),baidu("#mapCommonTip button").on("click",function(){a()})}function a(){T.g("mapCommonTip")&&(T.g("mapCommonTip").style.display="none")}var p,r,l=n("common:widget/ui/util/util.js"),s=n("common:widget/ui/config/config.js"),m=s.modelConfig,f={SHARE_PROC_URL:"http://j.map.baidu.com/",listIndex:null,mapSpotInf:null,mapInfo:{},getLink:function(n,t,o){this.cbk=n||function(){},this.getMap(),this.getList(),this.getSpotInfo(),this.getPopList(),this.getComponent(),this.getScrMode(),this.getPoiShare(),o=o||{};var a=this,l=[];for(var s in a.mapInfo)null!=a.mapInfo[s]&&""!=a.mapInfo[s]&&l.push(s+"="+a.mapInfo[s]);if(a.oUrl="http://map.baidu.com/?newmap=1&shareurl=1&force=newsample&"+l.join("&"),t&&!o.sms)return a.oUrl;var m=function(){var n=f.SHARE_PROC_URL+"?url="+encodeURIComponent(a.oUrl)+"&web=true";p=!1,T.jsonp(n,function(n){p=!0,a.cbk(n&&n.url||this.oUrl)}),clearTimeout(r),r=setTimeout(function(){0==p&&a.cbk(a.oUrl)},3e3)},u=baidu.json.parse(baidu.json.stringify(_sign.mapSign));if(i(u.pointInfo.list)&&i(u.polylineInfo.list)&&i(u.remarkInfo.list)){if(t)return n&&n(a.oUrl),a.oUrl;m()}else{for(var d in u.pointInfo.list)0==u.pointInfo.list[d].save&&delete u.pointInfo.list[d];for(var d in u.remarkInfo.list)0==u.remarkInfo.list[d].type&&delete u.remarkInfo.list[d];if(i(u.pointInfo.list)&&i(u.polylineInfo.list)&&i(u.remarkInfo.list)){if(t)return n&&n(a.oUrl),a.oUrl;m()}else MapSignInst.getSignLink(baidu.json.stringify(u),function(o){if(1!=o.result)return e("有不符合相关法规政策的词，请修改",map,{width:235}),t?(n&&n(a.oUrl),a.oUrl):void m();var i=o.content.shareId;return a.oUrl+="&mapShareId="+i,t?(n&&n(a.oUrl),a.oUrl):void m()},"all")}},getScrMode:function(){this.mapInfo.sc=map.fullScreenMode?1:0},getMap:function(){this.mapInfo.l=map.getZoom(),this.mapInfo.tn=map.mapType,this.mapInfo.hb=map._isHybridShow?BMAP_TYPE_HYBIRD:null;var n=map.getCenter();this.mapInfo.c=n.lng.toFixed(0)+","+n.lat.toFixed(0),this.mapInfo.cc=map.currentCity},getComponent:function(){var n=window.currentComponent,t="";n&&n.modelQuery?t=n.modelQuery.replace(/&b=\((-?\d+)(\.\d+),(-?\d+)(\.\d+);(-?\d+)(\.\d+),(-?\d+)(\.\d+)\)/gi,""):n&&"CityIndex"==n._className&&(t="cur&wd="+m.cityName+"&c="+m.cityCode),this.mapInfo.s=encodeURIComponent(decodeURIComponent(t))},getList:function(){this.mapInfo.i=null!=this.listIndex?this.listIndex.toString().replace("|",encodeURIComponent("|")):null},getPopList:function(){this.mapInfo.pi=null!=this.popIndex?this.popIndex:null},getPoiShare:function(){var n=location.href,t=l.getParam(n);t&&t.poiShareUid&&(this.mapInfo.poiShareUid=t.poiShareUid)},setPoiShowAll:function(n){this.mapInfo.poiall=n?1:null},setSmSCode:function(n){this.mapInfo.sms=n?n:null},getSpotInfo:function(){this.mapInfo.msi=null!=this.mapSpotInf?this.mapSpotInf:null},setParam:function(n,t){n&&"[object String]"===Object.prototype.toString.call(n)&&(t?this.mapInfo[n]=t:delete this.mapInfo[n])}};o.exports=f});
;define("common:widget/ui/toolShare/ToolShare.js",function(e,t,o){var n=e("common:widget/ui/util/util.js"),i=(e("common:widget/com/componentManager.js"),{SHARE_PROC_URL:"http://j.map.baidu.com/",long_url:"",keyList:{tsina:{title:"分享到新浪微博",code:1307,cbkcode:1317},tqq:{title:"分享到腾讯微博",code:1308,cbkcode:1318},qzone:{title:"分享到QQ空间",code:1306,cbkcode:1316},renren:{title:"分享到人人网",code:1309,cbkcode:1319},baidu:{title:"分享到百度搜藏",code:1310,cbkcode:1320},kaixin001:{title:"分享到开心网",code:1311,cbkcode:1321},hi:{title:"分享到百度空间",code:1312,cbkcode:1322},douban:{title:"分享到豆瓣网",code:1313,cbkcode:1323},tsohu:{title:"分享到搜狐微博",code:1314,cbkcode:1324},msn:{title:"分享到Myspace",code:1315,cbkcode:1325},fx:{title:"分享到飞信",code:1326,cbkcode:1327}},addCbkStat:function(){},_procCbk:function(e){this._rec=!0,this._getLinkCbk(e&&e.url||this.oldUrl)},getLink:function(e,t){this._getLinkCbk=t;{var o=this,i=this.oldUrl="http://map.baidu.com/?shareurl=1&"+n.jsonToQuery(e);this.SHARE_PROC_URL+"?url="+encodeURIComponent(i)+"&web=true&callback=toolShare._procCbk"}o._rec=!1,baidu.jsonp(this.SHARE_PROC_URL+"?url="+encodeURIComponent(i)+"&web=true",function(e){o._procCbk(e)}),clearTimeout(o._timer),this._timer=setTimeout(function(){0==o._rec&&o._getLinkCbk(i)},3e3)},open:function(t){if(window.temp.linkPop)return void window.temp.linkPop.close();t=t||{from:"mapshare"},t.shareText=this.shareText;var o={title:"您可将当前地图上的内容分享给好友",addDom:T(document.bogy)[0],content:"",height:94,width:T.browser.ie>=8?368:358,clickClose:!1,close:function(){window.temp.linkPop=null,listener.trigger("index.controls","close",{target:"share"})}};e.async("common:widget/ui/Popup/Popup.js",function(n){var i=window.temp.linkPop=new n(o);i.render(),i.hide(),i.getDom().style.top=t.keepTraffic?"205px":"136px",i.getDom().style.right="63px",e.async("common:widget/com/SharePanel/SharePanel.js",function(e){new e({dom:i.content,cinfo:t});i.show()})})},_open:function(e,t){e=e||window.event,n.stopBubble(e),this.open("",t)},fixName:function(e){return e?"【"+e+"】":""},Tween:function(e,t,o,n){return o*((e=e/n-1)*e*e+1)+t},getMInfo:function(){return{}},setShareText:function(e){e=e||{};var t="";for(var o in e)t=t+" "+e[o];this.shareText=t}});o.exports=i});
;define("common:widget/ui/mapRevert/MapRevert.js",function(require,exports,module){var util=require("common:widget/ui/util/util.js"),comMgr=require("common:widget/com/componentManager.js"),config=require("common:widget/ui/config/config.js"),traffic=require("common:widget/ui/Traffic/Traffic.js"),signMgr=require("common:widget/ui/signMgr/signMgr.js"),aqiMgr=require("common:widget/ui/AQIMgr/AQIMgr.js"),PanoInterface=require("pano:widget/PanoInterface/PanoInterface.js"),modelConfig=config.modelConfig,MapRevert={isRevert:!1,revert:function(){var e=location.href,r=util.getParam(e);if(r=util.extendHashParam(e,r),!r)return!1;if(null!=r.q){var t=0;for(var o in r)t++;1==t&&window.setTimeout(function(){try{T.g("PoiSearch").value=decodeURIComponent(r.q)}catch(e){}},300)}else try{var a=r.s||"";a=util.getParam(decodeURIComponent("?qt="+a)),"cur"!==a.qt&&a.wd&&window.setTimeout(function(){try{T.g("PoiSearch").value=decodeURIComponent(a.wd)}catch(e){}},300)}catch(n){}return r.mapShareId&&signMgr.parseShare(r.mapShareId),r.poiShareUid&&(r.s=encodeURIComponent("inf&uid="+r.poiShareUid+"&c="+r.cityCode)),r.s?(this.setModel(r),!0):r.poiShareId?(this.revertPoiShare(r),!0):1==r.aqi&&r.cname?(aqiMgr.revert(decodeURIComponent(r.cname)),!0):!1},setModel:function(param){var me=this,opts={cinfo:{cityInit:1},onload:function(){if(param.c){var e=param.c.split(","),r={};if(2==e.length){{parseFloat(e[0]),parseFloat(e[1])}r=new BMap.Point(parseFloat(e[0]),parseFloat(e[1])),map.centerAndZoom(r,parseInt(param.l))}}param.paid&&me.revertFullViewMap(param.paid),param.panoid&&param.panotype&&me.revertStreetView(param)}};if(null!=param.l&&"number"==typeof parseInt(param.l,10)&&(opts.cinfo._maplevel=parseInt(param.l)),null!=param.c){var p=param.c.split(",");if(2==p.length){var lng=parseFloat(p[0]),lat=parseFloat(p[1]),point=new BMap.Point(p[0],p[1]);opts.cinfo._centerPoint=point}}var index=param.i;null!=index&&(opts.cinfo._index=index,opts.cinfo.index=index);var showAll=param.poiall;showAll&&(opts.cinfo.poiall=1);var smsCode=param.sms;smsCode&&(opts.cinfo.sms=smsCode),1===param.tfc&&traffic.setBtn(!0,!0);var poPindex=param.pi;null!=poPindex&&(opts.cinfo._popIndex=parseInt(poPindex)),null!=param.ttype&&(opts.cinfo.trafType=param.ttype);var popPoint=param.b;if(null!=popPoint){var p=popPoint.split(",");if(2==p.length){var lng=parseFloat(p[0]),lat=parseFloat(p[1]),point=new BMap.Point(p[0],p[1]);opts.cinfo._popPoint=point}}param.s=param.s.replace(/%u[0-9a-zA-Z]{4}/gi,function(e){return encodeURIComponent(unescape(e))}),param.s.indexOf("con")>-1&&(opts.MapRevertOpts={noAddBounds:!0});var qs=[];try{qs=decodeURIComponent(param.s).split("&")}catch(e){return void comMgr.load("Error",{dom:T.g("MapInfo")})}for(var query="",i=0,l=qs.length;l>i;i++){var tempQ=qs[i].split("=");if(0!=tempQ.length)if(1!=tempQ.length){var q=tempQ.slice(1).join("");("ec"==tempQ[0]||"en"==tempQ[0])&&(q=q.replace(/\+/g," ")),query+="&"+tempQ[0]+"="+encodeURIComponent(decodeURIComponent(q))}else query+=tempQ[0]}if(query=0==query.indexOf("&")?query.substring(1):query,!query.match(/.*&c=\d{1,3}.*/)){var cc=modelConfig.cityCode;if(_OLR&&_OLR.index)try{eval("var ccd ="+_OLR.index),cc=ccd.content.code}catch(e){cc=modelConfig.cityCode}null==query.match(/tpl:/)&&(query+="&c="+cc)}var queryType=T.trim(qs[0]);switch("alamap"==param.from&&(query+="&provider=pc-aladin"),queryType){case"bt":query=query.replace(/wd1=(.*)&/,"sn=2$$$$$$$$$$$$$1$$$$$$&"),query=query.replace(/wd2=(.*)&/,"en=2$$$$$$$$$$$$$1$$$$$$&"),query&&query.indexOf("&exptype=")<0&&(query+="&exptype=dep&exptime=&version=5");case"nav":query=query.replace(/wd1=(.*)&/,"sn=2$$$$$$$$$$$$$1$$$$$$&"),query=query.replace(/wd2=(.*)&/,"en=2$$$$$$$$$$$$$1$$$$$$&"),/version=/.test(query)||(query+="&version=4"),/route_traffic=/.test(query)||(query+="&route_traffic=1"),/mrs=/.test(query)||(query+=/en=(.*to%3A)+(.*?)&/.test(query)?"$mrs=0":"&mrs=1");break;case"nse":/version=/.test(query)||(query+="&version=4"),/route_traffic=/.test(query)||(query+="&route_traffic=1"),/mrs=/.test(query)||(query+="&mrs=1");break;case"s":}opts.dom=T.g("MapInfo"),query.match(/tpl:City/)?comMgr.load("CityIndex",opts):comMgr.go(query,opts)},revertFullViewMap:function(){},revertStreetView:function(e){var r="",t="";if(e.pid?(t=e.pid,r=e.iid||""):"inter"===e.panotype?r=e.panoid:t=e.panoid,e.cpinfo){var o=T.json.parse(decodeURIComponent(e.cpinfo)),a=o[0].z;o[0].z=o[0].y,o[0].y=a;var n=encodeURIComponent(T.json.stringify(o))}PanoInterface.showPano({panoId:t,panoIId:r,panoType:e.panotype,panoHeading:e.heading,panoPitch:e.pitch,panoZoom:e.l,panoShareParam:e.psp,cpinfo:n||e.cpinfo,from:"share"})},revertPoiShare:function(e){comMgr.start_event=(new Date).getTime(),require.async("common:widget/com/PoiShare/PoiShare.js",function(r){var t=(new r({dom:baidu("#MapInfo")}),e.tn||e.mt);map.mapType!==t&&map.setMapType(t)})},init:function(){if(!this.revert()){var e=this.getCityInfo();comMgr.loadCity(e,function(){var e=util.getParam(location.href);e=util.extendHashParam(location.href,e),e&&e.paid&&MapRevert.revertFullViewMap(e.paid),e&&e.panoid&&e.panotype&&MapRevert.revertStreetView(e),document.fmwd.word.focus()})}},getCityInfo:function(){var e;return window._OLR&&(e=baidu.json.parse(window._OLR.index)||{},window._OLR.hot_city=e.hot_city,e.content&&e.content.code&&(modelConfig.defalutCityCode=e.content.code)),e}};module.exports=MapRevert});
;define("common:widget/ui/sms/sms.js",function(t,e,n){function o(t,e){var n=t.getDom(),o=map.getSize(),i=T.dom.getPosition(map.getContainer());width=o.width,height=o.height,x=width<=e.width?0:parseInt(width/2)-parseInt(e.width/2),y=height<=e.height?0:parseInt(height/2)-parseInt(e.height/2),x+=i.left,y+=i.top,e&&"undefined"!=typeof e.right?n.style.right=e.right+"px":n.style.left=e&&"undefined"!=typeof e.left?e.left+"px":x+"px",n.style.top=e&&"undefined"!=typeof e.top?e.top+"px":e&&"undefined"!=typeof e.bottom?e.bottom+"px":y+"px"}function i(e,n,i,p,s,d){o(r.spop,l),e==u.target||(n?u.uid==n:0)||(u.target=e,u.uid=n?n:null,a(function(o){t.async("common:widget/com/SMS/SMS.js",function(t){new t({dom:r.spop.content,cinfo:{infoWin:r.spop,tplUrl:o.tplUrl,oldUrl:o.oldUrl,curUrl:o.curUrl,target:e,uid:n||"",type:i||0,uidType:d}})})},n,i,p))}var p=t("common:widget/ui/constant/Constant.js"),s=(t("common:widget/ui/util/util.js"),t("common:widget/ui/mapShare/MapShare.js")),r={config:{DETAIL_URL:"http://map.baidu.com/?newmap=1&",NEWSEND_URL:"/ag/sms/sendnew/",READY_URL:"/ag/sms/readynew?url=",BMW_INFO:"http://"+location.host+"/?qt=inf&ie=utf-8",BMW_DATA_URL:"http://"+location.host+"/car/send"},spop:null},u={target:null,uid:null},l={isTitle:!1,content:"",extClass:"loginStyle",width:655,height:457,clickClose:!1,close:function(){u.target=null,u.uid=null,s.setSmSCode(0);var t=currentComponent;t&&t.cinfo.sms&&(t.cinfo.sms=null)},free:function(){delete r.spop}},d={POI:"s=inf%26uid%3D_UID_%26c%3D_CITY_%26newmap%3D1%26it%3D1",LINE:"s=bsl%26bsltp%3D0%26uid%3D_UID_%26c%3D_CITY_%26newmap%3D1"},c=function(t){switch(parseInt(t,10)){case p.POI_TYPE_NORMAL:return d.POI;case p.POI_TYPE_BUSSTOP:return d.POI;case p.POI_TYPE_BUSLINE:return d.LINE;case p.POI_TYPE_SUBSTOP:return d.POI;case p.POI_TYPE_SUBLINE:return d.LINE}},a=function(t,e,n,o){s.getLink(function(i){var p=encodeURIComponent(i),u={oldUrl:p};e&&"undefined"!=typeof n?(s.setSmSCode(e),u.curUrl="&current_url="+p):u.curUrl="",e&&"undefined"!=typeof n?u.tplUrl=encodeURIComponent(r.config.DETAIL_URL+c(n).replace("_UID_",e).replace("_CITY_",o)):(s.setSmSCode(e),u.tplUrl=p),t&&t(u)},!0,{sms:!0,uid:e})},f=function(e,n,o,p,s,u){if(r.spop){if(r.spop.visible)return;r.spop.render(),r.spop.show(),i(e,n,o,p,s,u)}else t.async("common:widget/ui/Popup/Popup.js",function(t){r.spop=new t(l),r.spop.addConnectDom(e),r.spop.render(),r.spop.hide(),i(e,n,o,p,s,u)});return!1};r.ready=f,n.exports=r});
;define("common:widget/ui/Traffic/Traffic.js",function(i,t,n){var f=i("pano:widget/PanoUtil/PanoUtil.js");n.exports={setHighLevel:function(){window.isPrint||"B_NORMAL_MAP"==map.mapType&&this.setBtn(this.need2ShowTraffic())},setBtnStatus:function(){var i=this.need2ShowTraffic();this.setBtn(i)},setBtn:function(i,t){var n=window,f=this,a=T("#traffic_control");i?t&&(f.loadTrafficCtrl(),a.addClass("active active-mark")):(n.trafficCtrl&&n.trafficCtrl.hide(),a.hide())},need2ShowTraffic:function(){if(window.PanoMap&&window.PanoMap.isOpen||f&&f.isOpen)return!1;{var i=map.getZoom();map.mapType}return!!i},exit:function(i){i=i||"",this.isOpen=!1,window.trafficCtrl&&window.trafficCtrl.close({type:i})},loadTrafficCtrl:function(){if(!window.isPrint){var t=this;i.async(["common:widget/ui/TrafficEvent/TrafficEvent.js","common:widget/com/TrafficControl/TrafficControl.js"],function(i,n){window.trafficCtrl=window.trafficCtrl||new n,trafficCtrl.show(),trafficCtrl.open(),t.isOpen=!0})}}}});
;define("common:widget/ui/Special/Special.js",function(a,n,e){var t=a("common:widget/ui/areaCfg/areaCfg.js"),i=a("common:widget/ui/config/config.js"),c=a("common:widget/com/componentManager.js"),i=a("common:widget/ui/config/config.js"),o=i.modelConfig,m=(i.mapConfig,{sectionDiscount:Math.floor((new Date-Date.parse("01/01/2012"))/864e5)+",+",data:{preferential:{title:"优惠券",maxTitle:"优惠券",wd:"餐饮",des:"提供北京市的餐饮类优惠券分布图","北京":"beijing"},tuan:{title:"团购",maxTitle:"团购",des:"提供北京市的美食、娱乐、生活服务、酒店旅游团购分布图",url:"http://www.nuomi.com?cid=map_pc_icon",sup:0},subway:{title:"地铁",maxTitle:"地铁专题",spTitle:"#cityName#地铁路线图",des:"共有北京，上海，广州，深圳，香港、南京、成都、重庆、天津、沈阳、杭州、武汉、苏州、大连、长春、西安、昆明、佛山、哈尔滨、郑州、宁波、无锡等二十多个城市的地铁路线图",url:"http://"+window.location.host+"/subways/index.html?c=","北京":"beijing","上海":"shanghai","广州":"guangzhou","深圳":"shenzhen","香港特别行政区":"hongkong","南京":"nanjing","成都":"chengdu","重庆":"chongqing","天津":"tianjin","沈阳":"shenyang","杭州":"hangzhou","武汉":"wuhan","苏州":"suzhou","大连":"dalian","长春":"changchun","西安":"xian","昆明":"kunming","佛山":"foshan","哈尔滨":"harbin","郑州":"zhengzhou","杭州":"hangzhou","长沙":"changsha","宁波":"ningbo","无锡":"wuxi"}},cityDataList:[{name:"repast",cnName:"餐饮"},{name:"beauty",cnName:"丽人"},{name:"caterorder",cnName:"餐厅订座"},{name:"viewpoint",cnName:"景点"},{name:"shopping",cnName:"购物"},{name:"atm",cnName:"ATM"},{name:"internet",cnName:"网吧"},{name:"coffee",cnName:"咖啡厅"},{name:"carpark",cnName:"停车场"},{name:"market",cnName:"超市"},{name:"ktv",cnName:"KTV"},{name:"bank",cnName:"银行"},{name:"fillingstation",cnName:"加油站"},{name:"hotelbar",cnName:"酒吧"},{name:"school",cnName:"学校"},{name:"hospital",cnName:"医院"},{name:"bath",cnName:"洗浴"}],getHtml:function(a){a=a||{};var n=a.cityName||o.cityName,e=a.showDescript,i=a.liEvent||"",c=a.from,s="",l="",u=a.dataName;if(1&a.sup){{encodeURIComponent(n)}m.data.tuan.des="提供"+n+"的美食、娱乐、生活服务、酒店旅游团购分布图",m.data.tuan.url="http://www.nuomi.com?cid=map_pc_icon",m.data.tuan.sup=1}else m.data.tuan.sup=0;n=n.replace(/市$/,"");var d=m.data[u],r="",p="",g=d.title,h=d.maxTitle,w="INDEX",f="",b=d.wd,y=Number(/^优惠券$/.test(g));if("box"==c&&(g=d.maxTitle,w="BOX"),d.url&&n){"weather"!=u&&d[n]&&(f=d[n]);var N=d.url+f,_="",x="";if("subway"==u){var C=t[n]||131;N=N+"&ccode="+C,x="addStat('citylistbtn', null, {'da_trd':'地铁'});",_=""}else"tuan"==u&&(x="addStat('citylistbtn', null, {'da_trd':'团购频道'});",_="");p='onclick = "'+_+"window.open('"+N+"')\""}else p="onclick = \"Special.searchWord('"+(b?b:h)+"',{type:'"+u+"',codeStr:'"+w+"'"+(y?",discount:"+y:"")+'});return false;"';return e&&(l="<p>"+d.des+"</p>"),("weather"==u||"lunch"==u||d[n]||"tuan"==u&&m.data.tuan.sup)&&(s+="preferential"==u||"tuan"==u&&m.data.tuan.sup?"tuan"==u&&m.data.tuan.sup?"<li "+i+p+' class="city-tuan"><a ><img src="'+o.timg+'" width="48" height="49" /></a><a >团购频道</a></li>':"<li "+i+p+' class="li_'+u+'"><a >('+a.dataCount+")</a></li>":"<li"+i+' class="li_'+u+'"><a '+r+p+'><img src="/wolfman/static/common/images/transparent.gif" class="'+u+'" /><b>'+g+"</b>"+l+"</a></li>"),s=s.replace(/#cityName#/g,n),{html:s}},getSubwayHtml:function(a){a=a||{};var n=a.cityName.replace(/市$/,""),e=a.cityCode||131,t=m.data.subway,i=t[n],c="http://"+window.location.host+"/subways/index.html?c="+i+"&ccode="+e,o="",s='onclick = "'+o+"window.open('"+c+"')\"",l='<li class="li_subway" data-name="地铁"><a '+s+'><img src="/wolfman/static/common/images/transparent.gif" class="subway" /><b>地铁</b></a></li>';return l},searchWord:function(a,n){n=n||{};var e=(n.type,n.codeStr,n.discount);if(!(a.length<1)){var t=o.cityCode||1,i="",m=0,s=map.getBounds();c.go("s&wd="+encodeURIComponent(a)+"&c="+t+"&src=0&wd2="+encodeURIComponent(i)+"&sug="+m+"&l="+map.getZoom()+"&b=("+s.minX+","+s.minY+";"+s.maxX+","+s.maxY+")"+(e?"&pl_discount2_section="+encodeURIComponent(this.sectionDiscount)+"&pl_data_type=cater&pl_sub_type="+encodeURIComponent(a):""))}}});e.exports=window.Special=m});
;define("common:widget/ui/Weather/Weather.js",function(e,t,i){var a=e("common:widget/ui/config/config.js"),n=a.modelConfig,r={active:!1,add:function(e){var t=baidu("#sideWrapper .weather-item"),i=t.find("img").get(0),a=t.find("span.wtext").get(0),r=null;try{if(r="string"==typeof e?baidu.json.parse(e):e,!r||1==n.cityType||0==n.cityType)return void t.hide();var o=r.temp0||r.temp1||"",c=r.weather0||r.weather1||"",d=r.pic01||r.pic11||"/wolfman/static/common/images/transparent.gif";o&&c?(t.attr("title",c),t.show(),i.src=d,a.innerHTML=o.replace(/\s*/g,"")):t.hide()}catch(p){}}};i.exports=r});
;define("common:widget/ui/AQIMgr/AQIMgr.js",function(n,o,e){var t=(n("common:widget/ui/util/util.js"),n("common:widget/ui/indexUtil/IndexUtil.js"),n("common:widget/ui/Weather/Weather.js"),n("common:widget/com/componentManager.js"),n("common:widget/ui/constant/Constant.js")),i=n("common:widget/ui/config/config.js"),c=(i.modelConfig,{1:{name:"优",bgColor:"#6ec129"},2:{name:"良",bgColor:"#e0cf22"},3:{name:"轻度污染",bgColor:"#fd5b30"},4:{name:"中度污染",bgColor:"#e10724"},5:{name:"重度污染",bgColor:"#8f0c50"},6:{name:"严重污染",bgColor:"#410468"}}),r=baidu("#weather_menu span.aqi-text").get(0),m={isOpen:!1,active:!1,aqiModel:null,init:function(){},show:function(){},setTool:function(n){if(r){var o;n.current_city&&n.current_city.city_type==t.CITY_TYPE_CITY?(o=c[n.current_city.level],r.innerHTML=o.name):r.innerHTML=""}},setAqi:function(){},set:function(n,o){n&&(this.show(),this.setTool(n),this.setAqi(n,o))},load:function(){},loadAQICmp:function(){},revert:function(){},isActive:function(){var n=window.currentComponent,o=!1;return o=n&&"AQIMap"==n._className?!0:!1}};e.exports=m});
;define("common:widget/ui/sateCityList/SateCityList.js",function(i,t,e){var n=i("common:widget/ui/config/config.js"),o=i("common:widget/ui/areaCfg/areaCfg.js"),a=n.modelConfig,c=[],s={},r={},f={cities:["北京","上海","广州","深圳","兰州","南京","苏州","沈阳","太原","杭州","武汉","石家庄","郑州","天津","合肥","西安","重庆","长沙","济南","成都","巢湖","阜阳","贵阳","惠州","湖州","焦作","吉林市","金华","晋中","柳州","南充","南通","芜湖","邢台","漳州","南宁","汕头","唐山","大连","西宁","嘉兴","泉州","温州","洛阳","南昌","舟山","安阳","涿州","银川","信阳","濮阳","新乡","临汾","泰州","衡阳","盐城","滁州","九江","常德","聊城","珠海","黑河","蚌埠","桂林","七台河","鸡西","宜春","萍乡","吉安","佳木斯","加格达奇","本溪","牡丹江","荆门","孝感","咸宁","中山","三明","宁德","福州","酒泉","金昌","陇南","庆阳","张掖","马鞍山","黄山","六安","荆州","襄樊","十堰","齐齐哈尔","广元","西昌","保山","香格里拉县","克拉玛依","伊宁","丽江","蒙自县","楚雄","娄底","绍兴","开封","北海","衢州","通辽","扬州","镇江","葫芦岛","辽阳","自贡","阳江","喀什","库尔勒","博乐","阿勒泰","哈密","延安","巴彦淖尔","鄂尔多斯","赤峰","盘锦","营口","鄂州","泸州","攀枝花","遵义","天水","安顺","百色","奉化","伊春","溧阳","铜川","昭通","安康","张家界","曲靖","汕尾","梧州","长治","扬中","梅州","莱芜","河源","揭阳","大同","诸暨","上虞","东阳","林芝","景洪","济宁","朔州","长葛","松原","玉溪","新沂","哈尔滨","包头","青岛","即墨","张家口","启东","临沂","景德镇","佛山","乐山","香港特别行政区","龙岩","平安县","商洛","德令哈","六盘水","锦州","汉中","宣城","郴州","南平","眉山","双鸭山","平凉","周口","吕梁","丽水","广安","怀化","潮州","保定","莆田","嘉峪关","朝阳","烟台","黄冈","临安","宿迁","安庆","巴中","滨州","亳州","昌吉","长春","承德","池州","慈溪","从化","大理","大庆","大冶","德州","定西","东莞","东营","抚顺","阜新","噶尔县城","固原","贵港","海门","合作","菏泽","鹤岗","黄骅","黄石","江门","江阴","靖江","凯里","昆明","拉萨","廊坊","连云港","临沧","临海","内江","宁波","彭州","平顶山","普洱","秦皇岛","清远","三河","三亚","商丘","韶关","邵阳","中卫","石嘴山","四平","遂宁","台州","太仓","通化","铜陵","威海","渭南","乌海","乌鲁木齐","吴忠","武威","厦门","徐州","宣化","阳泉","宜宾","永州","余姚","玉林","湛江","淄博","上饶","宜兴","临夏回族自治州","宿州","德阳","淮南","随州","新余","榆林","瑞安","淮安","运城","茂名","增城","雅安","盖州","泰兴","沙河","鹤壁","南阳","泰安","常州","无锡","呼和浩特","沧州","呼伦贝尔","抚州","锡林浩特","绥化","丹东","东台","辽源","白银","三门峡","海晏县","资阳","许昌","塔城","衡水","恩施","株洲","晋城","丹阳","金坛","潍坊","日照","延吉","莱西","招远","岳阳","忻州","钦州","云浮","句容","大丰","赣州","枣庄","宜昌","绵阳","白城","宝鸡","乌兰察布","阿拉善左旗","吐鲁番","吐鲁番地区","邯郸","肇庆","海口","澳门特别行政区","鞍山","阿坝藏族羌族自治州","阿坝","湘潭","咸阳","汉中","东营","仪征"],special:{"涿州":2234,"西昌":684,"香格里拉县":1080,"伊宁":767,"蒙自县":894,"楚雄":105,"喀什":793,"库尔勒":736,"博乐":772,"阿勒泰":783,"哈密":985,"奉化":2833,"溧阳":1747,"扬中":2820,"诸暨":2708,"上虞":1467,"东阳":1472,"林芝":813,"景洪":901,"长葛":1262,"新沂":2421,"即墨":2181,"启东":1508,"平安县":578,"德令哈":992,"临安":1878,"昌吉":93,"慈溪":1879,"从化":1585,"大理":919,"大冶":1291,"噶尔县城":311,"海门":2580,"合作":386,"黄骅":2262,"江阴":2819,"靖江":1333,"凯里":2025,"临海":1460,"彭州":617,"三河":2721,"太仓":1934,"宣化":2361,"余姚":2215,"宜兴":1336,"瑞安":1882,"增城":2319,"盖州":1369,"泰兴":2894,"沙河":1667,"锡林浩特":550,"绥化":44,"东台":1739,"海晏县":571,"丹阳":1337,"金坛":2118,"延吉":495,"莱西":1836,"招远":2692,"句容":1322,"大丰":2108,"乌兰察布":168,"阿拉善左旗":2883,"吐鲁番":744,"仪征":2424,"阿坝":1070}},g=function(){c=f.cities,s=f.special;for(var i=0,t=c.length;t>i;i++){var e=c[i];o[e]?r[o[e]]=e:s[e]&&(r[s[e]]=e)}};e.exports={isSateMapSupportCity:function(i){return 0==c.length&&g(),a.cityType<2?!0:(i=parseInt(i,10),i&&r[i]?!0:!1)}}});
;define("common:widget/ui/ClearBase/ClearBase.js",function(e,o,i){function n(){var e=baidu(".smp_poi_btn"),o=baidu("#clearMapArea");e.hide(),o.show(),o.off("click"),o.one("click",function(){e.show(),o.hide(),baidu("#PoiSearch").val(""),t.active=!1,listener.trigger("com.search","clear",{from:"clear"}),a.go("cur&wd="+encodeURIComponent(r.cityName),{cinfo:{from:"clear_btn",mapAreaChange:"no-change-map"}}),window.poi2RouteSearchName=void 0,listener.trigger("index.controls","close",{target:"search-in-view"})})}var a=e("common:widget/com/componentManager.js"),c=e("common:widget/ui/config/config.js"),r=c.modelConfig,t=e("common:widget/ui/FilterStatus/FilterStatus.js"),m={clearInit:function(){n()}};i.exports=m});
;define("common:widget/ui/CMSUtil/cmsControl.js",function(require,exports,module){var config=require("common:widget/ui/config/config.js"),MapConfig=config.mapConfig,CmsControl={getPc2MoStr:function(type){var json=_OLR?baidu.json.parse(_OLR.index)||{}:{},compileStr="",imgMap={bus:"banner_bus",nav:"banner_driving",poi:"banner_poi"},cnMap={bus:"公交",nav:"驾车",poi:"POI"},imgStr=imgMap[type]?imgMap[type]:"",imgUrl="",template="",cn=cnMap[type]?cnMap[type]:"";return json.mo&&json.mo.data&&("city"==type?json.mo.data.banner_home&&(imgUrl=MapConfig.host(json.mo.data.banner_home),template=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div class="addrBottomImg" ><a onclick="PcToMobile.open(\'IMG\', \'城市推广图片\');return false;" ><img src="',"undefined"==typeof img_url?"":img_url,'" width="304" height="100" /></a>    <a onclick="PcToMobile.open(\'BTN\', \'城市推广安卓按钮\', {qudao: \'1009177q\'});" class="pc2MoAndriod" href="http://map.baidu.com/maps/download/index.php?app=map&qudao=1009177q" target="andriodApk" title="点击将安装包下载到电脑，通过数据线安装到手机"></a>    <a onclick="PcToMobile.open(\'BTN\', \'城市推广ios按钮\');" class="pc2MoIphone" href="http://itunes.apple.com/cn/app/id452186370?ls=1&mt=8" title="点击前往苹果官方商店下载" target="_blank"></a></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],compileStr=template({img_url:imgUrl})):imgStr&&json.mo.data[imgStr]&&(imgUrl=MapConfig.host(json.mo.data[imgStr]),template=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<a onclick="addStat(&#39;downloadapp.infowin.searchresultpromote&#39;);PcToMobile.open(&#39;IMG&#39;, &#39;',"undefined"==typeof log?"":log,'推广图片&#39;);" href="javascript:void(0);">    <img src="',"undefined"==typeof img_url?"":img_url,'" width="304" height="100"/></a><a class="pc2MoAndriodSearch" onclick="addStat(&#39;downloadappsucess.infowin.android&#39;);PcToMobile.open(&#39;BTN&#39;, &#39;',"undefined"==typeof log?"":log,'安卓按钮&#39;, {qudao: &#39;1009177q&#39;});" href="http://map.baidu.com/maps/download/index.php?app=map&qudao=1009177q"  target="andriodApk" title="点击将安装包下载到电脑，通过数据线安装到手机"></a><a class="pc2MoIphoneSearch" onclick="addStat(&#39;downloadappsucess.infowin.ios&#39;);PcToMobile.open(&#39;BTN&#39;, &#39;',"undefined"==typeof log?"":log,'ios按钮&#39;);" href="http://itunes.apple.com/cn/app/id452186370?ls=1&mt=8" title="点击前往苹果官方商店下载" target="_blank"></a>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],compileStr=template({img_url:imgUrl,log:cn}))),compileStr}};module.exports=CmsControl});
;define("common:widget/com/RouteSearch/RouteSearch.js",function(require,exports,module){function addTabStat(){T("#route_header").click(function(t){var t=t||window.event;switch(t.target.textContent){case"公交":addStat("navgation.nav.bus","click",{da_e_name:"pcmap3"});break;case"驾车":addStat("navgation.nav.driving","click",{da_e_name:"pcmap3"});break;case"步行":addStat("navgation.nav.walking","click",{da_e_name:"pcmap3"});break;case"骑行":window.addStat("navgation.nav.bike","click",{da_e_name:"pcmap3"})}})}var stat=require("common:widget/ui/stat/CodeStat.js"),util=require("common:widget/ui/util/util.js"),comMgr=require("common:widget/com/componentManager.js"),config=require("common:widget/ui/config/config.js"),modelConfig=config.modelConfig,indexUtil=require("common:widget/ui/indexUtil/IndexUtil.js"),mapInfoScrollPanel=require("common:widget/ui/mapInfoScroll/mapInfoScroll.js"),sizeUtil=require("common:widget/ui/config/size.js"),driveSearchTab=require("common:widget/com/RouteSearch/DriveSearchTab.js"),searchBox=require("common:widget/ui/ui3SearchBox/ui3SearchBox.js"),hisMgr=require("common:widget/ui/searchHistory/hisMgr.js"),toast=require("common:widget/ui/toast/toast.js"),userMgr=require("common:widget/ui/userMgr/userMgr.js"),operateMediator=require("common:widget/ui/operateMediator/operateMediator.js"),MapComponent=require("common:widget/com/MapComponent.js"),CLS_SELECTED="selected",CLS_CONFIG={1:"bus",2:"drive",3:"walk",4:"bike"},mainWrapper=baidu("#MapInfo"),routeWrapper=baidu("#RouteHeadWrapper");module.exports=function(window){function RouteSearch(t){t=t||{},T.lang.Class.call(this,t),this.curSelIndex=1,this.preSelIndex=1,this.inputInfo={bus_start_input:{},bus_end_input:{},drive_start_input:{},drive_end_input:{},walk_start_input:{},walk_end_input:{},bike_start_input:{},bike_end_input:{},iw_ssn:{},iw_esn:{}},sizeUtil.routeMode=!0}return T.lang.inherits(RouteSearch,T.lang.Class,"RouteSearch"),T.object.extend(RouteSearch.prototype,{init:function(){this.render(),this.initialize()},render:function(){try{var tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div id="route_search_box"><div id="route_header">        <ul class="route-ntab bus cf" id="route_tab">            <span class="arrow-wrap">            </span><li class="tab-item bus-tab" data-index="1"><a class="border-line"><i></i><span>公交</span></a></li><li class="tab-item drive-tab"  data-index="2"><a class="border-line" ><i></i><span>驾车</span></a></li>            <li class="tab-item walk-tab"  data-index="3">                <a><i></i><span>步行</span></a>            </li>           <li class="tab-item bike-tab"  data-index="4"><a><i></i><span>骑行</span></a></li></ul></div><div class="route-search-box" id="search_wrapper"><div id="bus_search_box"><form class="route-search-form" name="bus_form" data-index="1"><div class="route-switch" title="切换公交起终点"><a></a></div><div class="route-input-box">              <p class="route-input start">              <i></i><input  type="text" name="bus_start_wd" id="bus_start_input" value="" placeholder="请输入公交起点"  autocomplete="off"  maxlength="256" data-from="start"/>              </p>              <p class="route-input end">                <i></i><input type="text" name="bus_end_wd" id="bus_end_input" value="" placeholder="请输入公交终点"  autocomplete="off"  maxlength="256" data-from="end"/>              </p></div><input value="搜索" class="route-submit" id="busSearchBtn" title="" type="submit" /></form></div><div id="walk_search_box"><form class="route-search-form"  name="walk_form" data-index="3"><div class="route-switch" title="切换步行起终点"><a></a></div><div class="route-input-box">              <p class="route-input start">              <i></i><input type="text" name="walk_start_wd" id="walk_start_input" value=""  placeholder="请输入步行起点" autocomplete="off"  maxlength="256" data-from="start"/>              </p>              <p class="route-input end">                <i></i><input type="text" name="walk_end_wd" id="walk_end_input" value=""  placeholder="请输入步行终点" autocomplete="off"  maxlength="256" data-from="end"/>              </p></div><input value="搜索" class="route-submit" id="walkSearchBtn" title="" type="submit" /></form></div>        <div id="bike_search_box"><form class="route-search-form"  name="bike_form" data-index="4"><div class="route-switch" title="切换骑行起终点"><a></a></div><div class="route-input-box">              <p class="route-input start">              <i></i><input type="text" name="bike_start_wd" id="bike_start_input" value=""  placeholder="请输入骑行起点" autocomplete="off"  maxlength="256" data-from="start"/>              </p>              <p class="route-input end">                <i></i><input type="text" name="bike_end_wd" id="bike_end_input" value=""  placeholder="请输入骑行终点" autocomplete="off"  maxlength="256" data-from="end"/>              </p></div><input value="搜索" class="route-submit" id="bikeSearchBtn" title="" type="submit" /></form>        </div></div></div><div id="my_place_wrapper" style="display:none;"></div><div class="history_route" id="history_bus_walk"></div><div id="route_result_wrapper"></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],tobj={},html=tpl(tobj);routeWrapper.empty().append(html),baidu("#walk_search_box").before(driveSearchTab.render())}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"common:widget/com/RouteSearch/RouteSearch.js",ln:112})}},initialize:function(){try{mapInfoScrollPanel.hide(),this.el=baidu("#route_search_box"),this.routeTab=this.el.find("#route_tab"),this.searchBox=this.el.find("#search_wrapper"),this.busBox=this.el.find("#bus_search_box"),this.driveBox=this.el.find("#drive_search_box"),this.walkBox=this.el.find("#walk_search_box"),this.bikeBox=this.el.find("#bike_search_box"),this.historyRoute=baidu("#history_bus_walk"),this.placeBox=baidu("#my_place_wrapper"),this.busForm=this.busBox.find("form"),this.driveForm=this.driveBox.find("form"),this.walkForm=this.walkBox.find("form"),this.bikeForm=this.bikeBox.find("form"),this.busStartInput=this.busForm.find("#bus_start_input"),this.busEndInput=this.busForm.find("#bus_end_input"),this.driveStartInput=this.driveForm.find("#drive_start_input"),this.driveEndInput=this.driveForm.find("#drive_end_input"),this.walkStartInput=this.walkForm.find("#walk_start_input"),this.walkEndInput=this.walkForm.find("#walk_end_input"),this.bikeStartInput=this.bikeForm.find("#bike_start_input"),this.bikeEndInput=this.bikeForm.find("#bike_end_input"),this.bindListener(),this.bindDOMEvent(),this.bindSuggestion(),addTabStat(),driveSearchTab.initialize()}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"common:widget/com/RouteSearch/RouteSearch.js",ln:161})}},unload:function(){listener.off("com.route","search")},show:function(){window.isPrint||(routeWrapper.show(),mainWrapper.empty(),mapInfoScrollPanel.update())},hide:function(){window.isPrint||(mainWrapper.show(),routeWrapper.hide(),this.initInput())},resetInputs:function(t,e,i){t=t||1;var n=(searchBox.getQuery(),this.searchBox.find('form[data-index="'+t+'"]')),a=n.find('input[data-from="end"]'),s=n.find('input[data-from="start"]'),o=n.find("p.through");4===t&&(e?(n.data("lastCityCode",i),s.data("lastCityValue",s.val()),a.data("lastCityValue",a.val())):(n.data("lastCityCode",""),s.data("lastCityValue",""),a.data("lastCityValue",""))),this.setValue(a,""),this.setValue(s,""),o.remove(),s.focus(),2===t&&driveSearchTab.clearThroughInput()},resetLastCityValue:function(t){if(4===t){var e=this.searchBox.find('form[data-index="'+t+'"]'),i=e.find('input[data-from="end"]'),n=e.find('input[data-from="start"]'),a=n.data("lastCityValue"),s=i.data("lastCityValue");a&&n.val(a),s&&i.val(s)}},bindListener:function(){var t=this,e=window.listener;e.on("com.route","search",function(e,i){t.setCurIndex(i.type),t.setInputs(i.model,i.type,i.data),t.buildQuery(i.model,{from:i.type})}),e.on("com.routeaddr","search",function(e,i){t.setInputs(i.model,i.type,i.data)}),e.on("com.route","menusearch",function(e,i){t.setInputsByMenu(i.model,i.type,i.data)}),e.on("com.route","dragsearch",function(e,i){t.setInputsByMenu(i.model,i.type,i.data)}),e.on("com.search","clear",function(){t.initInput()})},bindDOMEvent:function(){var t=this;this.routeTab.delegate("li","click",function(){var e=parseInt(baidu(this).data("index"));t.switchTab(e)}),this.busForm.find(".route-switch").on("click",function(){t.exchangeBus(),addStat("busscheme.exterminal.exterminal","click",{da_e_name:"pcmap3"})}),this.driveForm.find(".route-switch").on("click",function(){t.exchangeDrive(),addStat("navscheme.exterminal.exterminal","click",{da_e_name:"pcmap3"})}),this.walkForm.find(".route-switch").on("click",function(){t.exchangeWalk(),addStat("walkscheme.exterminal.exterminal","click",{da_e_name:"pcmap3"})}),this.bikeForm.find(".route-switch").on("click",function(){t.exchangeBike(),addStat("bikescheme.exterminal.exterminal","click",{da_e_name:"pcmap3"})}),this.historyRoute.delegate(".clear-login-link","click",function(){addStat("multi.history.login","click",{da_e_name:"pcmap3",da_trd:"routehis"}),userMgr.login(void 0,void 0,"route-his")}),this.historyRoute.delegate(".clear-link","click",function(){hisMgr.clearRouteData(),t.historyRoute.empty().hide(),toast.show("删除成功"),addStat("route.history.clear","click",{da_e_name:"pcmap3"})}),this.historyRoute.delegate("li","click",function(){var e,i=baidu("#route_header #route_tab"),n=baidu(this);if(!n.hasClass("clear-history")){var a=n.attr("data-key"),s=n.attr("data-from");a=a.split(" - ");for(var o=0;o<a.length;o++)a[o]=a[o].split("$$");if(i.hasClass("bus"))t.busStartInput.val(a[0][0]),a[0][1]&&t.setInputInfo("bus_start_input",{note:a[0][0],point:a[0][1]}),t.busEndInput.val(a[a.length-1][0]),a[1][1]&&t.setInputInfo("bus_end_input",{note:a[1][0],point:a[1][1]}),t.busSearch(t);else if(i.hasClass("drive")){if(t.driveStartInput.val(a[0][0]),t.driveEndInput.val(a[a.length-1][0]),a[0][1]&&t.setInputInfo("drive_start_input",{note:a[0][0],point:a[0][1]}),a[a.length-1][1]&&t.setInputInfo("drive_end_input",{note:a[a.length-1][0],point:a[a.length-1][1]}),a.length>2)for(var o=1;o<a.length-1;o++)e=driveSearchTab.addThroughInput({name:a[o][0],point:a[o][1]}),e.val(a[o][0]);t.driveSearch(t)}else i.hasClass("walk")?(t.walkStartInput.val(a[0][0]),t.walkEndInput.val(a[a.length-1][0]),a[0][1]&&t.setInputInfo("walk_start_input",{note:a[0][0],point:a[0][1]}),a[1][1]&&t.setInputInfo("walk_end_input",{note:a[1][0],point:a[1][1]}),t.walkSearch(t)):i.hasClass("bike")&&(t.bikeStartInput.val(a[0][0]),t.bikeEndInput.val(a[a.length-1][0]),a[0][1]&&t.setInputInfo("bike_start_input",{note:a[0][0],point:a[0][1]}),a[1][1]&&t.setInputInfo("bike_end_input",{note:a[1][0],point:a[1][1]}),t.bikeSearch(t));t.historyRoute.hide(),addStat("route.history.click","click",{da_e_name:"pcmap3",da_trd:s})}}),this.searchBox.delegate(".route-switch","mousedown",function(t){t.preventDefault()}),this.searchBox.delegate('input[type="text"]',"keydown",function(e){t.inputKeydown(this,e)}),this.searchBox.delegate('input[type="text"]',"keyup",function(e){t.inputFoucs(this,e)}),this.searchBox.find('input[type="text"]').focus(function(e){t.inputFoucs(this,e)}),this.searchBox.find('input[type="text"]').blur(function(e){t.inputBlur(this,e)}),T.browser.ie&&document.attachEvent?this.searchBox.delegate('input[type="text"]',"propertychange",function(e){t.propertychange(this,e)}):this.searchBox.delegate('input[type="text"]',"input",function(e){t.inputInput(this,e)}),this.busForm.submit(function(e){t.busSearch(this),e.preventDefault()}),this.driveForm.submit(function(e){t.driveSearch(this),e.preventDefault()}),this.walkForm.submit(function(e){t.walkSearch(this),e.preventDefault()}),this.bikeForm.submit(function(e){t.bikeSearch(this),e.preventDefault()}),driveSearchTab.addEventListener("addtp",function(){t.driveSearch(this)}),(8==T.browser.ie||9==T.browser.ie)&&T.each([this.busStartInput,this.busEndInput,this.driveStartInput,this.driveEndInput,this.walkStartInput,this.walkEndInput],function(){util.placeHolder(this)})},bindSuggestion:function(){var t=this;require.async("common:widget/ui/ui3MapSuggest/ui3MapSuggest.js",function(e){t.busSugg(e),t.driveSugg(e),t.walkSugg(e),t.bikeSugg(e)}),this.initInput()},initInput:function(){T.browser.ie<10?(this.busStartInput.val(this.busStartInput.attr("placeholder")||""),this.busEndInput.val(this.busEndInput.attr("placeholder")||""),this.driveStartInput.val(this.driveStartInput.attr("placeholder")||""),this.driveEndInput.val(this.driveEndInput.attr("placeholder")||""),this.walkStartInput.val(this.walkStartInput.attr("placeholder")||""),this.walkEndInput.val(this.walkEndInput.attr("placeholder")||"")):(this.busStartInput.val(""),this.busEndInput.val(""),this.driveStartInput.val(""),this.driveEndInput.val(""),this.walkStartInput.val(""),this.walkEndInput.val(""))},busSugg:function(t){var e=this;t.initialize({input:e.busStartInput,showMyPlace:!0,isAutoWidth:!1,left:66,top:172,width:302,from:"route",onSelect:function(t,i){T.isObject(t)?(e.setInputInfo("bus_start_input",{note:t.name,point:t.point}),e.busStartInput.val(t.name),e.searchBySugPlace(1)):(e.inputInfo.bus_start_input._wd2=i,e.searchBySugPlace(1))},onClose:function(){}}),t.initialize({input:e.busEndInput,showMyPlace:!0,isAutoWidth:!1,left:66,top:213,width:302,from:"route",onSelect:function(t,i){T.isObject(t)?(e.setInputInfo("bus_end_input",{note:t.name,point:t.point}),e.busEndInput.val(t.name),e.searchBySugPlace(1)):(e.inputInfo.bus_end_input._wd2=i,e.searchBySugPlace(1))},onClose:function(){}})},driveSugg:function(t){var e=this;t.initialize({input:e.driveStartInput,showMyPlace:!0,isAutoWidth:!1,left:66,top:172,width:302,from:"route",onSelect:function(t){T.isObject(t)?(e.setInputInfo("drive_start_input",{note:t.name,point:t.point}),e.driveStartInput.val(t.name),e.searchBySugPlace(2)):e.searchBySugPlace(2)},onClose:function(){}}),t.initialize({input:e.driveEndInput,showMyPlace:!0,isAutoWidth:!1,left:66,adjustTop:10,width:302,from:"route",onSelect:function(t){T.isObject(t)?(e.setInputInfo("drive_end_input",{note:t.name,point:t.point}),e.driveEndInput.val(t.name),e.searchBySugPlace(2)):e.searchBySugPlace(2)},onClose:function(){}})},walkSugg:function(t){var e=this;t.initialize({input:e.walkStartInput,showMyPlace:!0,isAutoWidth:!1,left:66,top:172,width:302,from:"route",onSelect:function(t){T.isObject(t)?(e.setInputInfo("walk_start_input",{note:t.name,point:t.point}),e.walkStartInput.val(t.name),e.searchBySugPlace(3)):e.searchBySugPlace(3)},onClose:function(){}}),t.initialize({input:e.walkEndInput,showMyPlace:!0,isAutoWidth:!1,left:66,top:213,width:302,from:"route",onSelect:function(t){T.isObject(t)?(e.setInputInfo("walk_end_input",{note:t.name,point:t.point}),e.walkEndInput.val(t.name),e.searchBySugPlace(3)):e.searchBySugPlace(3)},onClose:function(){}})},bikeSugg:function(t){var e=this;t.initialize({input:e.bikeStartInput,showMyPlace:!0,isAutoWidth:!1,left:66,top:172,width:302,from:"route",onSelect:function(t){T.isObject(t)?(e.setInputInfo("bike_start_input",{note:t.name,point:t.point}),e.bikeStartInput.val(t.name),e.searchBySugPlace(4)):e.searchBySugPlace(4)},onClose:function(){}}),t.initialize({input:e.bikeEndInput,showMyPlace:!0,isAutoWidth:!1,left:66,top:213,width:302,from:"route",onSelect:function(t){T.isObject(t)?(e.setInputInfo("bike_end_input",{note:t.name,point:t.point}),e.bikeEndInput.val(t.name),e.searchBySugPlace(4)):e.searchBySugPlace(4)},onClose:function(){}})},searchBySugPlace:function(t,e){switch(e=e||"",t){case 1:this.search(this.busStartInput,this.busEndInput,{qt:"bt",from:"input_sug"});break;case 2:this.search(this.driveStartInput,this.driveEndInput,{qt:"nav",from:"input_sug"});break;case 3:this.search(this.walkStartInput,this.walkEndInput,{qt:"walk",from:"input_sug"})}},switchTab:function(t,e){if(e=e||{},this.preSelIndex=this.curSelIndex,this.preSelIndex!=t||4===t){this.curSelIndex=t,this.switchTabBox(t),this.switchInputInfo(this.curSelIndex,this.preSelIndex);var i=this.switchValue(this.preSelIndex,this.curSelIndex);this.switchQuery(this.curSelIndex),i||(this.disposeOpBanner(t),this.disposeHistory(),this.addHistoryScrollBar())}},setMapStatus:function(){map.clearOverlays(),window.GRControll&&(window.GRControll.clearCache(),window.GRControll.clearGRMap())},disposeOpBanner:function(t){T(".route-op-banner").remove();var e=T('<div class="route-op-banner"></div>').appendTo("#RouteHeadWrapper"),i=[{bannerWrap:e,opid:"op"+(t+2)}];operateMediator.initOpBanner(i)},switchTabBox:function(t){switch(this.setCls(t),t){case 1:this.driveBox.hide(),this.walkBox.hide(),this.busBox.show(),this.bikeBox.hide();break;case 2:this.busBox.hide(),this.walkBox.hide(),this.driveBox.show(),this.bikeBox.hide();break;case 3:this.busBox.hide(),this.driveBox.hide(),this.walkBox.show(),this.bikeBox.hide();break;case 4:this.busBox.hide(),this.driveBox.hide(),this.walkBox.hide(),this.bikeBox.show(),mapInfoScrollPanel.update()}},setCls:function(t){var e=CLS_CONFIG[t+""];this.routeTab.get(0).className="route-ntab",this.routeTab.addClass(e).addClass("cf")},switchInputInfo:function(t,e){var i=this.inputInfo.bus_start_input,n=this.inputInfo.bus_end_input,a=this.inputInfo.drive_start_input,s=this.inputInfo.drive_end_input,o=this.inputInfo.walk_start_input,r=this.inputInfo.walk_end_input;bikes=this.inputInfo.bike_start_input,bikee=this.inputInfo.bike_end_input,1==t?2==e?(!i.point&&a.point&&(this.inputInfo.bus_start_input=T.object.extend({},a)),!n.point&&s.point&&(this.inputInfo.bus_end_input=T.object.extend({},s))):3==e?(!i.point&&o.point&&(this.inputInfo.bus_start_input=T.object.extend({},o)),!n.point&&r.point&&(this.inputInfo.bus_end_input=T.object.extend({},r))):4==e&&(!i.point&&bikes.point&&(this.inputInfo.bus_start_input=T.object.extend({},bikes)),!n.point&&bikee.point&&(this.inputInfo.bus_end_input=T.object.extend({},bikee))):2==t?1==e?(!a.point&&i.point&&(this.inputInfo.drive_start_input=T.object.extend({},i)),!s.point&&n.point&&(this.inputInfo.drive_end_input=T.object.extend({},n))):3==e?(!a.point&&o.point&&(this.inputInfo.drive_start_input=T.object.extend({},o)),!s.point&&r.point&&(this.inputInfo.drive_end_input=T.object.extend({},r))):4==e&&(!a.point&&bikes.point&&(this.inputInfo.drive_start_input=T.object.extend({},bikes)),!s.point&&bikee.point&&(this.inputInfo.drive_end_input=T.object.extend({},bikee))):3==t?1==e?(!o.point&&i.point&&(this.inputInfo.walk_start_input=T.object.extend({},i)),!r.point&&n.point&&(this.inputInfo.walk_end_input=T.object.extend({},n))):2==e?(!o.point&&a.point&&(this.inputInfo.walk_start_input=T.object.extend({},a)),!r.point&&s.point&&(this.inputInfo.walk_end_input=T.object.extend({},s))):4==e&&(!o.point&&bikes.point&&(this.inputInfo.walk_start_input=T.object.extend({},bikes)),!r.point&&bikee.point&&(this.inputInfo.walk_end_input=T.object.extend({},bikee))):4==t&&(1==e?(!bikes.point&&i.point&&(this.inputInfo.bike_start_input=T.object.extend({},i)),!bikee.point&&n.point&&(this.inputInfo.bike_end_input=T.object.extend({},n))):2==e?(!bikes.point&&a.point&&(this.inputInfo.bike_start_input=T.object.extend({},a)),!bikee.point&&s.point&&(this.inputInfo.bike_end_input=T.object.extend({},s))):3==e&&(!bikes.point&&o.point&&(this.inputInfo.bike_start_input=T.object.extend({},o)),!bikee.point&&o.point&&(this.inputInfo.bike_end_input=T.object.extend({},r))))},switchValue:function(t,e){var i,n,a=this.searchBox.find('form[data-index="'+t+'"]'),s=a.find('input[data-from="start"]'),o=a.find('input[data-from="end"]');8==T.browser.ie||9==T.browser.ie?(i=s.val()===s.attr("placeholder")?"":s.val(),n=o.val()===o.attr("placeholder")?"":o.val()):(i=s.val(),n=o.val());var r=this.searchBox.find('form[data-index="'+e+'"]'),u=r.find('input[data-from="start"]'),d=r.find('input[data-from="end"]');return T.trim(i)&&u.val(i),T.trim(n)&&d.val(n),d.focus(),u.focus(),i&&n?!0:void 0},disposeHistory:function(){var t=this;this.routeHis=hisMgr.getRouteData(),this.routeHis.done(function(e){t.showRouteHistory(e)})},showRouteHistory:function(t){var e=this,i=baidu("#history_bus_walk"),n=(T("#nav_container"),T(".route_contentWrapper"),['<div id="history-route-scroll">',"<ul>"]);0===t.length?T("#history_bus_walk").hide():T("#history_bus_walk").show(),T.each(t,function(t,i){var a=e.processItem(i);n.push(a)},e);var a=['<li class="clear-history">','<span class="clear-login"><a class="clear-login-link">立即登录</a>可查看更多历史记录</span>','<a class="clear-link">删除历史</a>',"</li>"];n.push(a.join("")),n.push("</ul>"),n.push("</div>"),i.empty().append(n.join("")),userMgr.defferd.fail(function(){i.find(".clear-login").show()})},processItem:function(t){var e=t.sn.keyword,i=t.platform||"3",n=this.pt2Key(t.sn);if(t.wp&&t.wp.length)for(var a=0;a<t.wp.length;a++)e+=" - "+t.wp[a].keyword,n+=" - "+this.pt2Key(t.wp[a]);e+=" - "+t.en.keyword,n+=" - "+this.pt2Key(t.en);var s=['<li data-from="',i,'" data-key="',n,'" title="',e,'">',"   <a>",'        <i class="his-route-icon">',this.escapeXSS(e),"</i>","   </a>","</li>"];return s.join("")},pt2Key:function(t){var e=t.keyword;return e+="$$",t.xy&&(e+=t.xy),e+="$$",t.uid&&(e+=t.uid),e},escapeXSS:function(t){return(t||"").replace(/</g,"&lt;").replace(/>/g,"&gt;")},addHistoryScrollBar:function(){this.routeHis.done(function(){var t=T("#history-route-scroll"),e=document.documentElement.clientHeight-T("#search").height()-T("#route_search_box").height()-140,i=t.find("ul").height();t.height(Math.min(e,i));var n=new baidu.ui.ScrollPanel({container:"history-route-scroll",overflow:"overflow-y",autoUpdate:!1,margin:[0,-9,0,0]});n.render("history-route-scroll"),n.update()})},switchQuery:function(t){T("#nav_container"),T(".route_contentWrapper");switch(t){case 1:this.toBus(t);break;case 2:this.toDrive(t);break;case 3:this.toWalk(t);break;case 4:this.toBike(t);break;default:this.searchRoute()}},searchRoute:function(t){t&&comMgr.go(t,{cinfo:{switchTab:!1}})},toBus:function(){var t=window.currentComponent._className;if("NavTrans"==t){var e=comMgr.get("NavTrans");e&&this.driveStartInput.val()==e.start.wd&&this.driveEndInput.val()==e.end.wd?comMgr.go(this.buildBusQuery(),{cinfo:{switchTab:!0}}):this.search(this.busStartInput,this.busEndInput,{qt:"bt",from:""})}else if("NavWalk"==t){var i=comMgr.get("NavWalk");i&&this.busStartInput.val()==i.start.wd&&this.busEndInput.val()==i.end.wd&&comMgr.go(this.buildBusQuery(),{cinfo:{switchTab:!0}})}else this.search(this.busStartInput,this.busEndInput,{qt:"bt",from:""})},toDrive:function(){var t=window.currentComponent._className;if("BusTrans"==t){var e=comMgr.get("BusTrans");if(e&&e.start&&this.busStartInput.val()==e.start.wd&&this.busEndInput.val()==e.end.wd){var i=this.buildNavQuery();comMgr.go(i,{cinfo:{switchTab:!0}})}else this.search(this.driveStartInput,this.driveEndInput,{qt:"nav",from:""})}else if("CBusTrans"==t){var n=comMgr.get("CBusTrans");if(n&&this.busStartInput.val()==n.start.wd&&this.busEndInput.val()==n.end.wd){var i=this.buildNavQuery();comMgr.go(i,{cinfo:{switchTab:!0}})}}else if("NavWalk"==t){var a=comMgr.get("NavWalk");if(a&&this.walkStartInput.val()==a.start.wd&&this.walkEndInput.val()==a.end.wd){var i=this.buildNavQuery();comMgr.go(i,{cinfo:{switchTab:!0}})}}else this.search(this.driveStartInput,this.driveEndInput,{qt:"nav",from:""})},toWalk:function(){var t=window.currentComponent._className;if("BusTrans"==t){var e=comMgr.get("BusTrans");e&&e.start&&this.busStartInput.val()==e.start.wd&&this.busEndInput.val()==e.end.wd?comMgr.go(this.buildWalkQuery(),{cinfo:{switchTab:!0}}):this.search(this.walkStartInput,this.walkEndInput,{qt:"walk",from:""})}else if("CBusTrans"==t){var i=comMgr.get("CBusTrans");i&&this.busStartInput.val()==i.start.wd&&this.busEndInput.val()==i.end.wd&&comMgr.go(this.buildWalkQuery(),{cinfo:{switchTab:!0}})}else if("NavTrans"==t){var n=comMgr.get("NavTrans");n&&this.driveStartInput.val()==n.start.wd&&this.driveEndInput.val()==n.end.wd?comMgr.go(this.buildWalkQuery(),{cinfo:{switchTab:!0}}):this.search(this.walkStartInput,this.walkEndInput,{qt:"walk",from:""})}else if("NavBike"==t){var a=comMgr.get("NavBike");if(a&&this.bikeStartInput.val()==a.start.wd&&this.bikeEndInput.val()==a.end.wd){var s=this.buildWalkQuery();comMgr.go(s,{cinfo:{switchTab:!0}})}}else this.search(this.walkStartInput,this.walkEndInput,{qt:"walk",from:""})},toBike:function(){var t=window.currentComponent._className;if("BusTrans"==t){var e=comMgr.get("BusTrans");e&&e.start&&this.busStartInput.val()==e.start.wd&&this.busEndInput.val()==e.end.wd?comMgr.go(this.buildBikeQuery(),{cinfo:{switchTab:!0}}):this.search(this.bikeStartInput,this.bikeEndInput,{qt:"cycle",from:""})}else if("CBusTrans"==t){var i=comMgr.get("CBusTrans");i&&this.busStartInput.val()==i.start.wd&&this.busEndInput.val()==i.end.wd&&comMgr.go(this.buildBikeQuery(),{cinfo:{switchTab:!0}})}else if("NavTrans"==t){var n=comMgr.get("NavTrans");n&&this.driveStartInput.val()==n.start.wd&&this.driveEndInput.val()==n.end.wd?comMgr.go(this.buildBikeQuery(),{cinfo:{switchTab:!0}}):this.search(this.bikeStartInput,this.bikeEndInput,{qt:"cycle",from:""})}else if("NavWalk"==t){var a=comMgr.get("NavWalk");if(a&&this.walkStartInput.val()==a.start.wd&&this.walkEndInput.val()==a.end.wd){var s=this.buildBikeQuery();comMgr.go(s,{cinfo:{switchTab:!0}})}}else this.search(this.bikeStartInput,this.bikeEndInput,{qt:"cycle",from:""})},buildBusQuery:function(){var t=indexUtil.getBusExpTime(),e=window.BusTransInst?BusTransInst.exptype:"dep",i=window.BusTransInst?BusTransInst.version:"100",n=this.searchQuery||{};n.exptime=t,n.exptype=e,n.version=i,n.bttp=1;var a="bt&"+baidu.url.jsonToQuery(n,encodeURIComponent);return a},buildNavQuery:function(){var t=this.searchQuery||{};t.navtp=0,t.version=4,t.mrs=1,t.route_traffic=1;var e=driveSearchTab.getLastTPQueryParam(),i=driveSearchTab.getLastCityCode();t.ec=decodeURIComponent(i)+t.ec,t.en=decodeURIComponent(e)+t.en;var n="nav&"+baidu.url.jsonToQuery(t,encodeURIComponent);return n},buildWalkQuery:function(){var t=this.searchQuery||{};t.version="2.0";var e="walk&"+baidu.url.jsonToQuery(t,encodeURIComponent);return e},buildBikeQuery:function(){var t=this.searchQuery||{};t.version="2.0";var e="cycle&"+baidu.url.jsonToQuery(t,encodeURIComponent);return e},buildQuery:function(t){var e,i,n=t,a=(t._className,n.currentCity||modelConfig.cityCode);if(n.sCity?(e=n.sCity.code,i=n.eCity.code):n.startCity&&n.endCity&&(e=n.startCity.code,i=n.endCity.code),n.start&&n.end)var s=1==n.start.bus_stop?0:1,o=1==n.end.bus_stop?0:1,r=n.start.uid||"",u=n.end.uid||"",d=n.startPoint,c=n.endPoint,p=n.start.wd||"",l=n.end.wd||"",h=s+"$$"+r+"$$"+d+"$$"+p+"$$$$$$",f=o+"$$"+u+"$$"+c+"$$"+l+"$$$$$$",b=n.s_query,v=n.e_query;var m={sy:0,drag:0,c:a,sc:e,ec:i,sn:h,en:f,sq:b,eq:v};this.searchQuery=m},exchangeBus:function(){this.exchange();var t=this.busStartInput,e=this.busEndInput,i=t.val(),n=e.val(),a=comMgr.get("BusTrans"),s=comMgr.get("CBusTrans"),o=window.currentComponent,r=o._className,u="BusTrans"==r&&a&&i==a.start.wd&&n==a.end.wd,d="CBusTrans"==r&&s&&!s.noResult&&i==s.start.wd&&n==s.end.wd;u||d?"BusTrans"==r?a.returnBus():"CBusTrans"==r&&s._back():(t.val(n),e.val(i)),""==t.val()?t.focus():""==e.val()&&e.focus()},exchangeDrive:function(){this.exchange();var t=this.driveStartInput,e=this.driveEndInput,i=t.val(),n=e.val(),a=window.currentComponent,s=a._className,o=comMgr.get("NavTrans"),r="NavTrans"==s&&o&&!!o.total&&i==o.start.wd&&n==o.end.wd;r?o.returnDr():(t.val(n),e.val(i)),""==t.val()?t.focus():""==e.val()&&e.focus()},exchangeWalk:function(){var t=this.walkStartInput,e=this.walkEndInput,i=t.val(),n=e.val(),a=window.currentComponent,s=a._className,o=comMgr.get("NavWalk"),r="NavWalk"==s&&o&&i==o.start.wd&&n==o.end.wd;r?o.returnDr():(t.val(n),e.val(i)),""==t.val()?t.focus():""==e.val()&&e.focus()},exchangeBike:function(){var t=this.bikeStartInput,e=this.bikeEndInput,i=t.val(),n=e.val(),a=window.currentComponent,s=a._className,o=comMgr.get("NavBike"),r="NavBike"==s&&o&&i==o.start.wd&&n==o.end.wd;r?o.returnDr():(t.val(n),e.val(i)),""==t.val()?t.focus():""==e.val()&&e.focus()},exchange:function(){var t=this,e=T.object.extend({},t.inputInfo.bus_start_input),i=T.object.extend({},t.inputInfo.bus_end_input),n=T.object.extend({},t.inputInfo.drive_start_input),a=T.object.extend({},t.inputInfo.drive_end_input),s=T.object.extend({},t.inputInfo.walk_start_input),o=T.object.extend({},t.inputInfo.walk_end_input);t.inputInfo.bus_start_input=i,t.inputInfo.bus_end_input=e,t.inputInfo.drive_start_input=a,t.inputInfo.drive_end_input=n,t.inputInfo.walk_start_input=o,t.inputInfo.walk_end_input=s},setValue:function(t,e,i){e=e||"";var t=baidu(t);t.val(e),"sug"!=i&&t.blur()},busSearch:function(){this.search(this.busStartInput,this.busEndInput,{qt:"bt",from:"button",da_src:"searchBox.button",type:"BusTrans"})},driveSearch:function(){this.search(this.driveStartInput,this.driveEndInput,{qt:"nav",from:"button",da_src:"searchBox.button",type:"NavTrans"})},walkSearch:function(){this.search(this.walkStartInput,this.walkEndInput,{qt:"walk",from:"button",da_src:"searchBox.button",type:"NavWalk"})},bikeSearch:function(){this.search(this.bikeStartInput,this.bikeEndInput,{qt:"cycle",from:"button",da_src:"searchBox.button",type:"NavBike"})},resizeBusContent:function(t){var e=util.getMapSize(),i=e.height,n=comMgr.isRouteModel(t)?routeWrapper.outerHeight():0;mainWrapper.height(i-n)},search:function(t,e,i){if(t.val()&&e.val()&&t.val()!==t.attr("placeholder")&&e.val()!==e.attr("placeholder")){i=i||{};var n=(i.from||"","&da_src=pcmappg."+(i.da_src||"unknown")),a=modelConfig.cityCode||1,s=2,o=2,r=a,u=a,d=i.qt,c="",p="",l="",h={},f=t.get(0).id,b=e.get(0).id,v=baidu.string(t.val()).trim(),m=baidu.string(e.val()).trim();if(this.setValue(t,util.filtQuery(v)),this.setValue(e,util.filtQuery(m)),""==v)return t.focus(),!1;if(""==m)return e.focus(),!1;var _=this.inputInfo,w=_[f]._wd2||"",I=_[b]._wd2||"",k=w?1:0,g=I?1:0;if(_[f]._wd2=null,_[b]._wd2=null,v===m&&w===I)return void toast.show("起终点不能完全相同");T(".route-op-banner").remove(),T("#history_bus_walk").hide(),this.resizeBusContent(i.type),mapInfoScrollPanel.update(),window.listener.trigger("loading","start",T("#MapInfo"));var y=_[f],S=_[b],x=y&&y.point&&y.note==v,B=S&&S.point&&S.note==m,C={};if(x&&B||!x&&!B){x&&B?(s=1,o=1,c=y.point,p=S.point,a=y.ccode||a,r=y.ccode||a,u=S.ccode||a):(_[f]={},_[b]={});var $=encodeURIComponent(v),E=encodeURIComponent(w),M=encodeURIComponent(m),j=encodeURIComponent(I);C={c:a,sn:s+"$$$$"+c+"$$"+$+"$$"+k+"$$"+E+"$$",en:o+"$$$$"+p+"$$"+M+"$$"+g+"$$"+j+"$$",sc:r,ec:u,pn:0,rn:5}}else if(x||B)if("bt"==d&&(d="bt"==d?"bse":"nse"),"bse"==d||"nse"==d){var N,R,W,P,q,Q="";x?(N=y.point,R=y.note,W=m,P="sn",q=1,a=y.ccode||a,_[b]={},Q=I):B&&(N=S.point,R=S.note,W=v,P="en",q=0,a=B.ccode||a,_[f]={},Q=w);var C={c:a,t:q,poiType:"0",isSingle:"true",ptx:N.split(",")[0],pty:N.split(",")[1],wd:encodeURIComponent(W),name:encodeURIComponent(R),wd2:encodeURIComponent(Q)};C[P]="1$$$$"+N+"$$"+encodeURIComponent(R)+"$$$$$$",h.cinfo={q:l,c:a,t:0,isSingle:!0,kwn:{name:R,pt:util.getPoiPoint(N),poiType:0}}}else{var s=2,o=2,c="",p="",r=a,u=a;x?(c=y.point,s=1,r=y.ccode||a,_[b]={}):B&&(p=S.point,o=1,u=B.ccode||a,_[f]={});var $=encodeURIComponent(v),E=encodeURIComponent(w),M=encodeURIComponent(m),j=encodeURIComponent(I);C={c:a,sn:s+"$$$$"+c+"$$"+$+"$$"+k+"$$"+E+"$$",en:o+"$$$$"+p+"$$"+M+"$$"+g+"$$"+j+"$$",sc:r,ec:u,pn:0,rn:5}}if("bt"==d||"bse"==d)C.exptype="dep",C.exptime=indexUtil.getBusExpTime(),C.version=5;else if("nav"==d||"nse"==d){var V=driveSearchTab.getTPQueryParam()||"";C.mrs=V?"0":"1",C.en=V+C.en,C.ec=driveSearchTab.getCityCode()+C.ec,C.version=4,C.route_traffic=1,C.sy=driveSearchTab.getStrategy()+""}else"walk"==d&&(C.version="2.0");C.da_src=n,l=d+"&"+util.jsonToQuery(C),comMgr.go(l,h)}},setCurIndex:function(t){switch(t){case"BusTrans":case"CBusTrans":case"RouteAddr":this.curSelIndex=1;break;case"NavTrans":this.curSelIndex=2;
break;case"NavWalk":this.curSelIndex=3;break;case"NavBike":this.curSelIndex=4}},setInputs:function(t,e){var i=t.json;if(i&&i.result)switch(e){case"BusTrans":case"CBusTrans":this.setBusTrans(i.result);break;case"NavTrans":this.setNavTrans(i.result);break;case"NavWalk":this.setWalk(i.result);break;case"NavBike":this.setBike(i.result);break;case"RouteAddr":this.setRouteAddr(i.result)}},setInputsByMenu:function(t,e,i){if(i)switch(e){case"BusTrans":case"CBusTrans":this.setBusByMenu(i);break;case"NavTrans":this.setDriveByMenu(i);break;case"NavWalk":this.setWalkByMenu(i);break;case"NavBike":this.setBikeByMenu(i)}},setBusByMenu:function(t){this.switchTabBox(1),t.startFlag&&(this.setValue(this.busStartInput,t.note),this.setInputInfo("bus_start_input",{note:t.note,point:t.point})),t.endFlag&&(this.setValue(this.busEndInput,t.note),this.setInputInfo("bus_end_input",{note:t.note,point:t.point}))},setDriveByMenu:function(t){this.switchTabBox(2),t.startFlag&&(this.setValue(this.driveStartInput,t.note),this.setInputInfo("drive_start_input",{note:t.note,point:t.point})),t.endFlag&&(this.setValue(this.driveEndInput,t.note),this.setInputInfo("drive_start_input",{note:t.note,point:t.point}))},setWalkByMenu:function(t){this.switchTabBox(3),t.startFlag&&(this.setValue(this.walkStartInput,t.note),this.setInputInfo("walk_start_input",{note:t.note,point:t.point})),t.endFlag&&(this.setValue(this.walkEndInput,t.note),this.setInputInfo("walk_start_input",{note:t.note,point:t.point}))},setBikeByMenu:function(t){this.switchTabBox(4),t.startFlag&&(this.setValue(this.bikeStartInput,t.note),this.setInputInfo("bike_start_input",{note:t.note,point:t.point})),t.endFlag&&(this.setValue(this.bikeEndInput,t.note),this.setInputInfo("bike_start_input",{note:t.note,point:t.point}))},setBusTrans:function(t){var e=t.start.wd||"",i=t.end.wd||"";this.switchTabBox(1),this.setValue(this.busStartInput,e),this.setValue(this.busEndInput,i)},setNavTrans:function(t){var e=t.start,i=baidu.isArray(t.end)&&t.end.length>0?t.end[t.end.length-1]:t.end,n=e.wd||"",a=i.wd||"";this.switchTabBox(2),this.setValue(this.driveStartInput,n),this.setValue(this.driveEndInput,a)},setWalk:function(t){var e=t.start,i=baidu.isArray(t.end)&&t.end.length>0?t.end[t.end.length-1]:t.end,n=e.wd||"",a=i.wd||"";this.switchTabBox(3),this.setValue(this.walkStartInput,n),this.setValue(this.walkEndInput,a)},setBike:function(t){var e=t.start,i=baidu.isArray(t.end)&&t.end.length>0?t.end[t.end.length-1]:t.end,n=e.wd||"",a=i.wd||"";this.switchTabBox(4),this.setValue(this.bikeStartInput,n),this.setValue(this.bikeEndInput,a)},setRouteAddr:function(t,e){e=e||{};var i="",n="";19==t.type||29==t.type?(19==t.type&&(i=t.s_wd?t.s_wd:"",n=t.e_wd&&t.e_wd[t.e_wd.length-1]?t.e_wd[t.e_wd.length-1]:""),this.switchTabBox(2),this.setValue(this.driveStartInput,i),this.setValue(this.driveEndInput,n)):13==t.type||24==t.type||23==t.type?((13==t.type||23==t.type)&&(i=t.s_wd||"",n=t.e_wd||""),this.switchTabBox(1),this.setValue(this.busStartInput,i),this.setValue(this.busEndInput,n)):49==t.type&&(i=t.s_wd||"",n=t.e_wd||"",this.switchTabBox(3),this.setValue(this.walkStartInput,i),this.setValue(this.walkEndInput,n))},setInputInfo:function(t,e){var i=this.inputInfo[t];for(var n in e)e.hasOwnProperty(n)&&(i[n]=e[n])},inputKeydown:function(){},inputFoucs:function(){},inputBlur:function(){},propertychange:function(){},inputInput:function(){}}),new RouteSearch}(window)});
;define("common:widget/com/RouteSearch/DriveSearchTab.js",function(require,exports,module){function DriveSearchTab(){T.lang.Class.call(this),this.tpList=[],this.lastTpList=[],this.strategy=0}var util=require("common:widget/ui/util/util.js"),tpUtil=require("common:widget/ui/throughpoint/tpUtil.js"),config=require("common:widget/ui/config/config.js"),modelConfig=config.modelConfig,mapUtil=require("common:widget/ui/mapUtil/mapUtil.js");T.lang.inherits(DriveSearchTab,T.lang.Class,"DriveSearchTab"),T.object.extend(DriveSearchTab.prototype,{render:function(){try{var tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div id="drive_search_box"><form class="route-search-form"  name="drive_form" data-index="2"><div class="route-switch" title="切换驾车起终点"><a></a></div><div class="route-input-box">        <p class="route-input start">            <i></i                ><input type="text" name="drive_start_wd" id="drive_start_input" value=""  placeholder="请输入驾车起点" autocomplete="off"  maxlength="256" data-from="start"/>                <span id="drive-add-btn" class="route-input-add" title="添加途经点"></span>        </p>        <p class="route-input end">            <i></i><input type="text" name="drive_end_wd" id="drive_end_input" value=""  placeholder="请输入驾车终点" autocomplete="off"  maxlength="256" data-from="end"/>        </p></div><input class="route-submit" value="搜索" id="driveSearchBtn" title="" type="submit" /></form></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],html=tpl();return this.$el=T(html),this.$el}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"common:widget/com/RouteSearch/DriveSearchTab.js",ln:21})}},initialize:function(){try{var me=this;this.driveAddBtn=this.$el.find("#drive-add-btn"),this.throughInputTmpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<p class="route-input through">    <i></i><input type="text" name="drive_through_wd" value=""  placeholder="请输入驾车途经点" autocomplete="off"  maxlength="256" data-from="through"/><span class="route-input-mask-for-ie8"></span><span class="route-input-remove" data-index="',"undefined"==typeof index?"":baidu.template._encodeHTML(index),'" title="移除途经点"></span></p>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],this.bindDOMEvent(),tpUtil.addEventListener("tpremove",function(t){me.removeTPInput(parseInt(t.index))})}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"common:widget/com/RouteSearch/DriveSearchTab.js",ln:32})}},bindDOMEvent:function(){var t=this;this.driveAddBtn.click(function(){t.addThroughInput()}),this.$el.delegate(".route-input-remove","click",function(){var e=this.getAttribute("data-index");t.removeThroughPoint(e)})},addThroughInput:function(t){if(!window.isPrint&&(4!==this.tpList.length||this.driveAddBtn.hasClass("hide")||this.driveAddBtn.addClass("hide"),!(this.tpList.length>=5)||t)){addStat("navscheme.navscheme.addtp","click",{da_e_name:"pcmap3"});var e=T(this.throughInputTmpl({index:this.tpList.length})),i=!1;if(t)for(var a=0;a<this.tpList.length;a++)if(this.isEmptyTp(this.tpList[a])){e=this.$el.find(".through").eq(a),this.tpList[a]=t,i=!0;break}var n=e.find("input");return(8==T.browser.ie||9==T.browser.ie)&&util.placeHolder(n),t?n.val(t.name):t={},i||(this.tpList.push(t),this.$el.find(".end").before(e),require.async("common:widget/ui/ui3MapSuggest/ui3MapSuggest.js",function(e){e.initialize({input:n,showMyPlace:!0,isAutoWidth:!1,left:66,adjustTop:10,width:302,from:"route",onSelect:function(e,i){T.isObject(e)?(n.val(e.name),t.name=e.name,t.point=e.point):(t.name=e,t.apddr=i)},onClose:function(){}})})),n}},removeThroughPoint:function(t){this.driveAddBtn.hasClass("hide")&&this.driveAddBtn.removeClass("hide"),t=parseInt(t),tpUtil.removeTp(t+1)},removeTPInput:function(t){var e=this.tpList.splice(t,1);this.$el.find(".through").eq(t).remove(),this.$el.find(".route-input-remove").each(function(t,e){e.setAttribute("data-index",t)}),e=e[0]},clearThroughInput:function(){this.driveAddBtn.hasClass("hide")&&this.driveAddBtn.removeClass("hide"),this.$el.find(".through").remove(),this.lastTpList=this.tpList,this.tpList=[]},getTPQueryParam:function(){for(var t,e=[],i=0;t=this.tpList[i];i++){var a=this.$el.find(".through input").eq(i);t.name||a.val()&&(t.name=(8==T.browser.ie||9==T.browser.ie)&&a.val()===a.attr("placeholder")?"":a.val()),t.name==a.val()||t.sure||(t=8==T.browser.ie||9==T.browser.ie?{name:a.val()===a.attr("placeholder")?"":a.val()}:{name:a.val()}),(t.name||t.point)&&e.push(tpUtil.getTPointQueryParam(t))}return e.join("")},getLastTPQueryParam:function(){for(var t,e=[],i=0;t=this.lastTpList[i];i++)(t.name||t.point)&&e.push(tpUtil.getTPointQueryParam(t));return e.join("")},getCityCode:function(){for(var t,e=[],i=modelConfig.cityCode||1,a=0;t=this.tpList[a];a++)(t.name||t.point)&&e.push(i+"+to:");return e.join("")},getLastCityCode:function(){for(var t,e=[],i=modelConfig.cityCode||1,a=0;t=this.lastTpList[a];a++)(t.name||t.point)&&e.push(i+" to:");return e.join("")},getTpCount:function(){for(var t=0,e=0;e<this.tpList.length;e++)this.tpList[e].name&&t++;return t},getTpAddedCount:function(){for(var t=0,e=0;e<this.tpList.length;e++)t++;return t},getTpList:function(){return this.tpList},addTPointByPoint:function(t){var e,i={point:t.lng+","+t.lat},a=this,n=tpUtil.addTpMarker({p:t},this.getTpCount(),map,!0,"marker-raise");n.enableDragging(),n.addEventListener("dragend",function(t){mapUtil.getGEORevertAddress(t.point,function(t){if(e&&t.content){var a=t.content;i.name=a.address,a.point&&(i.point=a.point.x+","+a.point.y),n.setTitle(i.name),e.val(i.name)}})}),addStat("navscheme.navscheme.addtp","click",{da_e_name:"pcmap3"}),mapUtil.getGEORevertAddress(t,function(t){if(t.content){var r=t.content;i.name=r.address,r.point&&(i.point=r.point.x+","+r.point.y),n.setTitle(i.name)}e=a.addThroughInput(i),a.dispatchEvent("addtp")})},setStrategy:function(t){this.strategy=t},getStrategy:function(){return this.strategy},isEmptyTp:function(t){return void 0===t.name&&void 0===t.uid&&void 0===t.point}}),module.exports=new DriveSearchTab});
;define("common:widget/ui/throughpoint/tpUtil.js",function(e,t,n){function i(){T.lang.Class.call(this),this.markers=[]}var o=e("common:widget/ui/util/util.js");T.lang.inherits(i,T.lang.Class,"TpUtil"),T.object.extend(i.prototype,{getIconByIndex:function(e){return new BMap.Icon("http://webmap2.map.bdstatic.com/wolfman/static/common/images/tpicon_ea18b98.png",new BMap.Size(36,36),{imageOffset:new BMap.Size(-62-36*e,0)})},addTpMarker:function(e,t,n,i,r){var a=this,m=this.getIconByIndex(t),s=baidu.encodeHTML(e.n),c=o.getPoiPoint(e.p),d=new BMap.Marker(c,{icon:m,title:s,startAnimation:r});return d.__index=t,n.addOverlay(d),d.setTop(!0,3e8),i&&(d.addEventListener("mouseover",function(e){o.stopBubble(e),a.getRemoveIconInMap(this,t),d.rm&&a.clearRmTimeout(d.rm)}),d.addEventListener("mouseout",function(){d.rm&&a.hideRemoveIconInMap(d.rm)})),this.markers.push(d),d},getRemoveIconInMap:function(e){var t=this;return e.rm=new BMap.Label("<div style='position:relative;'><div id='tppoint_remove_icon' class='tppoint_remove_icon' title='删除途经点'></div></div>",{offset:{width:40,height:-10}}),e.setLabel(e.rm),e.rm.setStyle({zIndex:25}),e.rm.addEventListener("mouseover",function(){t.clearRmTimeout(e.rm)}),e.rm.addEventListener("mouseout",function(){t.hideRemoveIconInMap(e.rm)}),e.rm.addEventListener("click",function(){t.removeTp(e.__index+1)}),e.rm},hideRemoveIconInMap:function(e){this.clearRmTimeout(e),e.hideTimeout=setTimeout(function(){map.removeOverlay(e)},500)},clearRmTimeout:function(e){e&&e.hideTimeout&&(clearTimeout(e.hideTimeout),e.hideTimeout=null)},getTPointQueryParam:function(e){var t=2,n="",i="",o="",r="0",a="",m="",s="1";return e.point&&(t=1,i=e.point,e.uid&&(t=2,n=e.uid)),e.name&&(o=encodeURIComponent(e.name)),e.addr&&(r="1",a=encodeURIComponent(e.addr)),t+"$$"+n+"$$"+i+"$$"+o+"$$"+r+"$$"+a+"$$"+m+"$$"+s+"$$ to:"},removeTp:function(e){var t=this.markers.splice(e-1,1);t.length&&(map.removeOverlay(t[0]),this.refreshMarkers()),this.dispatchEvent("tpremove",{index:e-1,isTpSure:!!t.length}),addStat("navscheme.navscheme.removetp","click",{da_e_name:"pcmap3"})},refreshMarkers:function(){for(var e=0;e<this.markers.length;e++)this.markers[e].__index=e,this.markers[e].setIcon(this.getIconByIndex(e))},clearMarkers:function(){this.markers=[]}}),n.exports=new i});
;define("common:widget/ui/nav/nav.js",function(e,t,i){var o=e("common:widget/com/componentManager.js"),n=(e("common:widget/ui/AQIMgr/AQIMgr.js"),e("common:widget/ui/config/size.js")),a=e("common:widget/ui/config/config.js"),s=a.modelConfig,r=e("common:widget/ui/BoxContainer/BoxContainer.js"),d=e("common:widget/ui/history/history.js"),c=(e("common:widget/ui/userMgr/userMgr.js"),e("common:widget/com/RouteSearch/RouteSearch.js")),u=e("common:widget/ui/fav/favMgr.js"),l=e("common:widget/ui/ui3SearchBox/ui3SearchBox.js"),h=e("common:widget/ui/operateMediator/operateMediator.js"),w=e("common:widget/ui/FilterStatus/FilterStatus.js"),p="nav-list__tab--selected",m={el:null,selIndex:1,preSelIndex:0,routeModel:null,init:function(){this.el=baidu("#nav_menu"),this.mapInfo=baidu("#MapInfo"),this.routeSearchBox=baidu("#RouteHeadWrapper"),this.navBgSlider=T("#nav_bg_slider"),this.setStatus(),this.bind()},bind:function(){var e=this;this.el.delegate("li:not(.weather-box)","click",function(t){e.setSwitchTab(T(this).find("a")[0]),t.preventDefault()}),listener.on("com.city","change",function(e,t){window.currentCity=t}),this.bindSilderAnimation()},bindSilderAnimation:function(){var e,t=this,i=this.el.find("li"),o=i.length,n=this.el,a=this,s=!0;this.el.delegate("li:not(.weather-box)","mouseenter",function(){e=!0;{var i=T(this),r=i.index();t.el.find(".selected").removeClass(p),t.navBgSlider.css("top").slice(0,-2)}r!=o-1||s?(a.navBgSliderAtBottom?t.navBgSlider.css({top:60*r}):t.navBgSlider.stop().animate({top:60*r},100,"linear"),a.navBgSliderAtBottom=!1):(t.navBgSlider.css({top:n.height()-60}),a.navBgSliderAtBottom=!0)}),this.el.delegate("li:not(.weather-box)","mouseleave",function(){e=!1;var i=T(this);setTimeout(function(){if(!e){var r=i.index(),d=t.el.find(".selected"),c=d.index();r!==c?c!==o-1||s?(a.navBgSliderAtBottom=!1,r==o-1?(t.navBgSlider.stop(),t.navBgSlider.css({top:60*c}),d.addClass(p)):t.navBgSlider.stop().animate({top:60*c},{duration:100,easing:"linear",done:function(){d.addClass(p)}})):(t.navBgSlider.stop(),t.navBgSlider.css({top:n.height()-60}),d.addClass(p),a.navBgSliderAtBottom=!0):(a.navBgSliderAtBottom=c!==o-1||s?!1:!0,d.addClass(p))}},10)})},setStatus:function(){{var e=parseInt(this.el.find(".nav-search-item").data("index"));baidu.json.parse(window._OLR.index)||{}}this.selIndex=e,this.preSelIndex=0,this.navBgSlider.show(),this.switchTab(e),this.setSubway()},setSubway:function(){var t=this;t.isNowSubway=!0,e.async("common:widget/com/Subway/SbwMgr.js",function(e){e.init()})},setSwitchTab:function(e){listener.trigger("fav.poi","canceledit");var t=parseInt(T(e).data("index"));(1===t||2===t)&&window.streetViewTool&&streetViewTool.isOpen&&streetViewTool.resetStatus(),this.isNowSubway&&"subway-item"!==e.className&&listener.trigger("com.subway","change"),this.switchTab(t),this.switchAction(t,{}),this.setMapStatus(),T(window).trigger("resize",{from:"switchtab",navIndex:t})},switchTab:function(e){this.preSelIndex=this.selIndex,this.selIndex=e;var t=this.el.find("li").removeClass("selected "+p),i=t.eq(e-1);i.addClass("selected "+p),this.navBgSlider.stop().animate({top:60*(e-1)},100,"linear"),this.navBgSliderAtBottom=!1},switchAction:function(e,t){if(this.preSelIndex==e)return 1!==e||T("#city_index_box").length||(l.setQuery(""),T("#clearMapArea").hide(),window.poi2RouteSearchName=void 0,w.active=!1,o.go("cur&wd="+encodeURIComponent(s.cityName),{cinfo:{from:"nav"}})),void(2===e&&(window.startPoi=!1,window.endPoi=!1,c.resetInputs(1),c.resetInputs(2),c.resetInputs(3),c.resetInputs(4),t.noReQuery=!0,t.setEndQuery=!1,this.showRoute(t),d.clearRouteQuery()));switch(r.opened&&r.exit(),this.preSelIndex=this.selIndex,this.selIndex=e,e){case 1:this.showIndex(t);break;case 2:this.showRoute(t);break;case 3:this.showSubway(t);break;case 4:this.showFav(t);break;case 5:this.showAQI(t)}},disposeChangeTabPop:function(e){var t=T("#route_pop");T("#route_outer_pop").hide(),2==e?this.disposeRoutePop(t,3e3):t.hide()},disposeRoutePop:function(e,t){function i(){T.supportCss3("transition")?e.addClass("route-pop-scale"):e.hide()}var o=e.attr("id");if(!T.cookie.get(o)&&!window.isPrint){T.cookie.set(o,"hasPoP",{expires:864e5});var n=setTimeout(function(){i()},t);e.show().click(function(){clearTimeout(n),i()}),e.bind(T.whichTransitionEvent(),function(){e.hide()})}},switchRouteBox:function(e){2==e?c.show(1):c.hide(1)},showIndex:function(){n.routeMode=!1;var e=d.getSearchQuery();e||(e="cur&wd="+encodeURIComponent(s.cityName));var t=/(&c=)(\d*)/;if("string"==typeof e){var i=t.exec(e),a=window.currentCity.code;i&&i[2]&&+i[2]!==a&&(e=e.replace(t,function(e,t){return t+a}))}T(".route-op-banner").remove(),o.go(e,{cinfo:{from:"nav_menu"}})},showRoute:function(e){n.routeMode=!0,"setEndQuery"in e||(e.setEndQuery=!0);var t=this;c.disposeHistory(),o.loadRoute(function(i){function o(){var e={bus:3,drive:4,walk:5};T(".route-op-banner").remove();var t=T('<div class="route-op-banner"></div>').appendTo("#RouteHeadWrapper"),i=[{bannerWrap:t,opid:"op"+e[s]}];h.initOpBanner(i)}c.addHistoryScrollBar(),t.routeModel=i;var n=d.getRouteQuery(),a=T("#route_tab"),s=a.attr("class").match(/bus|drive|walk|bike/)[0];if("string"==typeof n){var r=/&c=(\d*)/.exec(n);if(r&&r[1]){if(r[1]!=window.currentCity.code)return o(),c.resetInputs(1),c.resetInputs(2),c.resetInputs(3),void c.resetInputs(4,!0,r[1]);c.resetLastCityValue(4)}}return void 0!==window.poi2RouteSearchName&&!n&&e.setEndQuery?(T("#"+s+"_end_input").val(window.poi2RouteSearchName),void o()):void(n&&!e.noReQuery?(baidu("#history_bus_walk").hide(),t.routeModel.searchRoute(n)):(o(),addStat("route.history.show","show",{da_e_name:"pcmap3"})))}),addStat("navgation.nav.nav","click",{da_e_name:"pcmap3"})},showSubway:function(){T(".route-op-banner").remove(),this.switchRouteBox(3),listener.trigger("com.subway","click"),addStat("navgation.nav.subway","click",{da_e_name:"pcmap3"})},showFav:function(){n.routeMode=!1,r.opened?r.exit():u.openPanel(),addStat("navgation.nav.fav","click",{da_e_name:"pcmap3"})},showAQI:function(){n.routeMode=!1},setMapStatus:function(){map.clearOverlays(),window.GRControll&&(window.GRControll.clearCache(),window.GRControll.clearGRMap())}};listener.on("index.nav",function(e,t){m.switchTab(t.index),m.switchAction(t.index,t)}),i.exports=m});
;define("common:widget/ui/BoxContainer/BoxContainer.js",function(n,o,e){var i=n("common:widget/ui/config/config.js"),t=(i.modelConfig,i.mapConfig,{scrollBar:null,container:T.g("FavInfoWrapper"),contentDom:T.g("FavInfo"),opened:!1,show:function(n){n=n||{};var o=this;o.container.style.display="block",o.opened=!0},hidden:function(){t.container&&(t.container.style.display="none"),t.opened=!1},exit:function(){t.hidden()},setContent:function(n){T(t.contentDom).empty().append(n)}});e.exports=t});
;define("common:widget/com/Subway/SbwMgr.js",function(n,o,e){var c=n("common:widget/ui/config/config.js"),t=c.modelConfig,s="",i={loaded:!1,init:function(){listener.on("com.subway","click",function(){i.load({cInfo:{ccode:t.cityCode,cname:t.cityName},lineQuery:s})}),listener.on("com.subway","zindexchange",function(){i.loaded=!1,T.g("sbw_map").style.zIndex=-1}),listener.on("com.subway","linequery",function(n,o){s=o.req}),listener.on("com.subway","citychange",function(n,o){i.sbwInst&&i.loaded&&(i.sbwInst.unload(),i.sbwInst.load({cInfo:o.cInfo}))})},load:function(o){o=o||{},i.sbwInst?(i.loaded=!0,i.sbwInst.load(o)):n.async("common:widget/com/Subway/Subway.js",function(n){i.loaded=!0,i.sbwInst=new n(o),i.sbwInst.load()})},unload:function(){i.sbwInst&&(i.loaded=!1,i.sbwInst.unload())},getQuery:function(){return s}};e.exports=i});
;define("common:widget/search/filters/SearchFilter/FilterConfig.js",function(e,a,n){var o={cater:{name:"cater",cn_name:"餐馆"},hotel:{name:"hotel",cn_name:"酒店"},hospital:{name:"hospital",cn_name:"医院"},scope:{name:"scope",cn_name:"景点",sTag:{}},beauty:{name:"beauty",cn_name:"丽人"},life:{name:"life",cn_name:"休闲娱乐"},shopping:{name:"shopping",cn_name:"超市"},bank:{name:"bank",cn_name:"银行"}},t={"data_type,0":"默认排序","total_score,0":"按好评排序","overall_rating,0":"按评分排序","hot_value,0":"按人气排序","price,1":"价格低到高","price,0":"价格高到低","level,1":"等级低到高","level,0":"等级高到低","comment_num,0":"评论数多到少"},c={premium:"pl_discount2_section",groupon:"pl_groupon_section",book:"pl_cater_book_pc_section"},i=/^(hotel|cater|scope|hospital|life|education|enterprise|shopping|beauty|bank)$/,p=/^(cater|life|beauty)$/,l=/^(cater|hospital|life|beauty)$/,r=/^(cater|scope)$/,s=/^(hotel|cater|scope|beauty|shopping|life)$/,m=/电影院|影院|剧场|影城|剧院/g;n.exports={placeData:o,filterMap:c,sortNameMap:t,hasFilterReg:i,hasPremiumReg:p,hasGrouponReg:l,hasBookReg:r,hasSortReg:s,movieReg:m}});
;define("common:widget/search/SearchUtil.js",function(e,t,o){var n=e("common:widget/ui/sateCityList/SateCityList.js"),c=e("common:widget/ui/config/config.js"),r=(c.mapConfig,c.modelConfig,{placeRe:/^(hotel|cater|hospital|house|life|education|enterprise|scope|shopping|beauty)$/,isCater:function(e){return e.ext&&/cater/.test(e.ext.src_name)},isHotel:function(e){return e.ext&&/hotel/.test(e.ext.src_name)},isScenery:function(e){return e.ext&&/scope/.test(e.ext.src_name)},isMovie:function(e){return e.ext&&"090300"==e.new_catalog_id},getTicketSection:function(e){var t="0-+"==e.d_ticket_book_flag_section?"0,+":e.d_ticket_book_flag_section;return t},getMovieSection:function(e){var t="0-+"==e.d_ticket_book_flag_section?"0,+":e.d_ticket_book_flag_section;return t},getBizCount:function(e){for(var t=0,o=0,n=e.length;n>o;o++)1===e[o].biz_type&&t++;return t},changeMap:function(e){var t=map.mapType;t!=BMAP_NORMAL_MAP&&map.mapType==BMAP_SATELLITE_MAP&&(n.isSateMapSupportCity(e)||maptypeCtrl.select(BMAP_NORMAL_MAP))},returnLType:function(e){var t=[[0,2,3,4,5,6,7,9,10,11],[1,12,13,14],[8]],o=t.length;for(i=0;o>i;i++){var n=t[i];for(j=0;j<n.length;j++){var c=n[j];if(c==e)return i}}},sendSateSuggestQuery:function(e,t){map.setMapType(BMAP_NORMAL_MAP),comMgr.go("con&contp=0&wd="+encodeURIComponent(e)+"&pn=0&c="+t+"&check_sate=0")},setTop:function(e,t,o,n){return e&&e.setTop?(n=n||{},t&&!e._isTop?(e._isTop=!0,void(o?e.setTop(!0,1000100):n.isSon?e.setTop(!0,1000101):e.setTop(!0))):void(t||(e._isTop=null,e.setTop(!1)))):void 0}});o.exports=r});
;define("common:widget/search/SearchUrlParam.js",function(e,t,o){var a=e("common:widget/search/SearchUtil.js"),r=e("common:widget/search/filters/SearchFilter/FilterConfig.js"),s=r.placeData,_=r.movieReg,c={},n="pl_",i={cater:{},hotel:{},movie:{},scope:{},bank:{},life:{},shopping:{},hospital:{},beauty:{},urlParam:{},getParam:function(e){var t;return t=0===e.indexOf(n)?c[e]||"":c[n+e]||""},setParam:function(e,t){0===e.indexOf(n)?c[e]=t:c[n+e]=t},setParams:function(e){for(var t in e)e.hasOwnProperty(t)&&null!==e[t]&&this.setParam(t,e[t])},removeParam:function(e){0===e.indexOf(n)?(c[e]=null,delete c[e]):(c[n+e]=null,delete c[n+e])},getParams:function(){return c},clearParams:function(){for(var e in c)c.hasOwnProperty(e)&&this.removeParam(e)},getUrlParamString:function(e){var e=e||c,t=[];for(var o in e)e.hasOwnProperty(o)&&t.push("&"+o+"="+encodeURIComponent(e[o]));return t.join("")},setPlaceParams:function(e){var t=e.place_info,o=e.place_param,r=(e.result.wd||"",t.d_data_type),_=t.d_sub_type||"",c="",n="",i=t.d_price_section.replace("-",","),p=t.d_discount2_section.replace("-",","),l=t.d_groupon_section.replace("-",","),d=t.d_cater_book_pc_section.replace("-",","),u=t.d_hotel_book_pc_section.replace("-",","),m=a.getTicketSection(t);return s[r]?("hotel"==r?c="default":/^(cater|life|beauty)$/.test(r)&&(c="data_type"),t.d_sort_type&&(c=t.d_sort_type),o&&o[0].sort_rule?n=e.place_param[0].sort_rule:t.d_sort_rule&&(n=t.d_sort_rule),this.setParams({data_type:r,sub_type:_,price_section:i,sort_type:c,sort_rule:n,discount2_section:p,groupon_section:l,cater_book_pc_section:d,hotel_book_pc_section:u,ticket_book_flag_section:m,movie_book_section:a.getMovieSection(t),business_type:t.d_business_type,business_id:t.d_business_id}),void this.setBusinessParams(e,r,_)):""},setBusinessParams:function(e,t,o){var r=e.place_info,s=(e.place_param,e.result.wd||""),n=r.d_cater_book_pc_section.replace("-",","),p=r.d_hotel_book_pc_section.replace("-",","),l=a.getTicketSection(r);switch(i[t]=T.extend({wd:s,pl_data_type:t,pl_sub_type:o},c),t){case"cater":i[t]=T.extend({pl_cater_book_pc_section:n},c);break;case"hotel":i[t]=T.extend({pl_hotel_book_pc_section:p},c);break;case"scope":i[t]=T.extend({pl_ticket_book_flag_section:l,pl_free_section:"0,+"},c);break;case"life":r.d_sub_type&&r.d_sub_type.match(_)&&(i[t]=T.extend({pl_movie_book_section:a.getMovieSection(r)},c))}}};o.exports=i});
;define("common:widget/ui/ui3Tools/ui3Tools.js",function(require,exports,module){function fullScreen(t){this._map=t.map||map,this.defaultCursor=this._map.config.defaultCursor,this.draggingCursor=this._map.config.draggingCursor,this.startTop=10,this.startRight=9,this.defaultAnchor=BMAP_ANCHOR_TOP_RIGHT,this.defaultOffset=new BMap.Size(this.startRight,this.startTop)}function viewSearch(t){this._map=t.map||map,this.defaultCursor=this._map.config.defaultCursor,this.draggingCursor=this._map.config.draggingCursor,this.startTop=10,this.startRight=65,this.defaultAnchor=BMAP_ANCHOR_TOP_RIGHT,this.defaultOffset=new BMap.Size(this.startRight,this.startTop)}function trafficSt(t){this._map=t.map||map,this.defaultCursor=this._map.config.defaultCursor,this.draggingCursor=this._map.config.draggingCursor,this.startTop=42,this.startRight=9,this.defaultAnchor=BMAP_ANCHOR_TOP_RIGHT,this.defaultOffset=new BMap.Size(this.startRight,this.startTop)}function toolCollection(t){this._map=t.map||map,this.defaultCursor=this._map.config.defaultCursor,this.draggingCursor=this._map.config.draggingCursor,this.startTop=74,this.startRight=9,this.defaultAnchor=BMAP_ANCHOR_TOP_RIGHT,this.defaultOffset=new BMap.Size(this.startRight,this.startTop)}function cityChange(t){this._map=t.map||map,this.defaultCursor=this._map.config.defaultCursor,this.draggingCursor=this._map.config.draggingCursor,this.startTop=12,this.startLeft=12,this.defaultAnchor=BMAP_ANCHOR_TOP_LEFT,this.defaultOffset=new BMap.Size(this.startLeft,this.startTop)}function allControlsBundle(t){this._map=t.map||map,this.defaultCursor=this._map.config.defaultCursor,this.draggingCursor=this._map.config.draggingCursor,this.startTop=10,this.startRight=9,this.defaultAnchor=BMAP_ANCHOR_TOP_RIGHT,this.defaultOffset=new BMap.Size(this.startRight,this.startTop)}var signMgr=require("common:widget/ui/signMgr/signMgr.js"),constant=require("common:widget/ui/constant/Constant.js"),config=require("common:widget/ui/config/config.js"),mapInfo=require("common:widget/ui/mapInfo/mapInfo.js"),modelConfig=config.modelConfig,wrapper=T("#MapHolder"),style=".ui3-control-shadow{}.ui3-tool-collection-wrap{border:1px solid #c4c7cc;background-color:#fff}.ui3-tool-collection{display:inline-block;width:47px;height:24px;line-height:24px}.ui3-tool-collection em{width:11px;height:11px;background-image:url(http://webmap0.map.bdstatic.com/wolfman/static/common/images/ui3/tools/tools_47a3ea9.png);background-position:0 -316px;margin-left:5px;margin-right:4px}.ui3-tool-collection:hover em{background-position:-11px -316px}.ui3-tool-collection-wrap a{color:#666}.ui3-tool-collection-wrap ul{display:none;height:0;overflow:hidden;position:absolute;top:-1px;left:-58px;border:1px solid #c4c7cc;width:50px;background-color:#fff}.ui3-tool-collection-wrap li a{display:block;height:24px;line-height:24px;border-bottom:1px solid #e9eaec;text-decoration:none}.ui3-tool-collection-wrap em{background-image:url(http://webmap0.map.bdstatic.com/wolfman/static/common/images/ui3/tools/tools_47a3ea9.png);display:inline-block;vertical-align:middle}.ui3-tool-collection-wrap a span{vertical-align:middle}.ui3-tool-collection-wrap a:hover span{color:#0C88E8}.ui3-tool-collection-wrap .ui3-1 em{width:7px;height:11px;margin-left:8px;margin-right:6px;background-position:-10px -177px}.ui3-tool-collection-wrap .ui3-1:hover em{background-position:-59px -177px}.ui3-tool-collection-wrap .ui3-2 em{width:12px;height:12px;margin-left:6px;margin-right:3px;background-position:-31px -177px}.ui3-tool-collection-wrap .ui3-2:hover em{background-position:-80px -177px}.ui3-tool-collection-wrap .ui3-3 em{width:7px;height:12px;margin-left:8px;margin-right:6px;background-position:0 -304px}.ui3-tool-collection-wrap .ui3-3:hover em{background-position:-7px -304px}.ui3-tool-collection-wrap .ui3-4 em{width:12px;height:12px;margin-left:5px;margin-right:4px;background-position:-31px -200px}.ui3-tool-collection-wrap .ui3-4:hover em{background-position:-80px -200px}.ui3-tool-collection-wrap .ui3-5{border-bottom:0}.ui3-tool-collection-wrap .ui3-5 em{width:12px;height:12px;margin-left:5px;margin-right:5px;background-position:-7px -200px}.ui3-tool-collection-wrap .ui3-5:hover em{background-position:-56px -200px}.ui3-control-color:hover{color:#0c88e8}.ui3-control-color{color:#666;text-decoration:none}.ui3-control-color em,.ui3-control-color span{display:inline-block;vertical-align:middle;letter-spacing:-1px}.ui3-full-screen{width:47px;height:24px;border:1px solid #c4c7cc;background-color:#fff;line-height:24px;display:inline-block}.ui3-full-screen em{height:11px;width:11px;margin-left:6px;margin-right:4px;background-image:url(http://webmap0.map.bdstatic.com/wolfman/static/common/images/ui3/tools/tools_47a3ea9.png);background-position:-6px -8px}.ui3-full-screen:hover em{background-position:-17px -8px}.exit-fullscreen{width:47px;height:26px;background-position:-73px -265px}.ui3-view-search-wrap{border:1px solid #c4c7cc;background-color:#fff}.ui3-view-search{width:84px;height:24px;line-height:24px;display:inline-block}.ui3-view-search em{height:13px;width:12px;margin-left:6px;margin-right:5px;background-image:url(http://webmap0.map.bdstatic.com/wolfman/static/common/images/ui3/tools/tools_47a3ea9.png);background-position:-6px -125px}.ui3-view-search:hover em{background-position:-18px -125px}.viewSearchTool-click em{background-position:-18px -125px}.ui3-traffic-st-wrap{border:1px solid #c4c7cc;background-color:#fff}.ui3-traffic-st{width:47px;height:24px;line-height:24px;display:inline-block}.ui3-traffic-st:hover em{background-position:-14px -150px}.ui3-traffic-st em{height:14px;width:7px;margin-left:7px;margin-right:7px;background-image:url(http://webmap0.map.bdstatic.com/wolfman/static/common/images/ui3/tools/tools_47a3ea9.png);background-position:-7px -150px}.trafficStTool-click em{background-position:-14px -150px}.ui3-street-view{display:inline-block;width:45px;padding:1px;text-decoration:none;border:1px solid #9B9EA4;background-color:#fff}.ui3-street-view-top{height:26px;background-image:url(http://webmap0.map.bdstatic.com/wolfman/static/common/images/ui3/tools/tools_47a3ea9.png);background-position:0 -327px}.ui3-street-view-bottom{color:#666;text-align:center;height:16px;line-height:16px;_line-height:18px}.ui3-street-view:hover{zoom:1}.ui3-street-view:hover .ui3-street-view-bottom{background-color:#0c88e8;color:#fff}.streetViewTool-click .ui3-street-view-bottom{background-color:#0c88e8;color:#fff}.ui3-city-change-left{height:24px;padding-left:10px;display:inline-block;vertical-align:middle;background-image:url(http://webmap0.map.bdstatic.com/wolfman/static/common/images/ui3/tools/city-change_999eb1a.png);background-position:left 0}a.ui3-city-change-right{color:#fff;font-size:12px;text-decoration:none;line-height:24px;height:24px;padding-right:23px;display:inline-block;vertical-align:middle;background:url(http://webmap0.map.bdstatic.com/wolfman/static/common/images/ui3/tools/city-change_999eb1a.png) no-repeat right -26px;background:url(http://webmap0.map.bdstatic.com/wolfman/static/common/images/ui3/tools/city-change_999eb1a.png) no-repeat right -52px \\9;position:relative;position:static \\9}.ui3-city-change-click .ui3-city-change-right{background-position:right -76px\\9}.ui3-city-change-inner{display:inline-block;height:24px;line-height:24px;border:1px solid #c4c7cc;background-color:#fff;padding:0 23px 0 10px;color:#666;font-size:12px;text-decoration:none;vertical-align:middle;position:relative}.ui3-city-change-inner i{width:8px;height:6px;display:inline-block;position:absolute;bottom:9px;right:10px;-webkit-transition:all ease-in-out .15s;transition:all ease-in-out .15s;display:none\\9}.ui3-city-change-inner em{position:absolute;width:0;height:0;top:1px;left:0;border-color:rgba(255,255,255,0);border-top-color:#D0D4DA;border-style:solid;border-width:4px}.ui3-city-change-inner b{width:7px;height:4px;position:absolute;bottom:9px;right:10px;background-image:url(http://webmap0.map.bdstatic.com/wolfman/static/common/images/ui3/tools/tools_47a3ea9.png);background-position:0 -353px;display:none;display:inline-block\\9}.ui3-city-change-click .ui3-city-change-inner b{background-position:-7px -353px}.ui3-city-change-inner:hover{color:#0C88E8}.ui3-city-change-inner:hover em{border-top-color:#0C88E8}.ui3-city-change-click .ui3-city-change-inner i,.ui3-city-change-click-close .ui3-city-change-inner i{-webkit-transform:rotate(180deg);-moz-transform:rotate(180deg);-o-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg)}.ui3-blue,.ui3-blue span{color:#0C88E8}.ui3-control-wrap .left,.ui3-control-wrap .right{border:1px solid #c4c7cc;background:#fff}.ui3-control-wrap .left{margin-right:4px}.ui3-control-wrap .left span,.ui3-control-wrap .right span{float:left;height:26px;width:26px;border-right:1px solid #ecedef;background-image:url(http://webmap0.map.bdstatic.com/wolfman/static/common/images/ui3/tools/tools_47a3ea9.png);background-repeat:no-repeat}.ui3-control-wrap .left span.active,.ui3-control-wrap .right span.active{background-color:#3385ff}.ui3-control-wrap .left span p,.ui3-control-wrap .right span p{height:26px;cursor:pointer}.ui3-control-wrap .last{border:0!important}.ui3-control-wrap .search-in-view{background-position:-49px -332px}.ui3-control-wrap .search-in-view.active{background-position:-49px -301px}.ui3-control-wrap .traffic{background-position:-75px -332px}.ui3-control-wrap .traffic.active{background-position:-75px -301px}.ui3-control-wrap .share{background-position:-106px -332px}.ui3-control-wrap .share.active{background-position:-106px -301px}.ui3-control-wrap .measure{background-position:-134px -332px}.ui3-control-wrap .measure.active{background-position:-134px -301px}.ui3-control-wrap .screen-shot{background-position:-163px -332px}.ui3-control-wrap .screen-shot.active{background-position:-163px -301px}.ui3-control-wrap .mark{background-position:-186px -332px}.ui3-control-wrap .mark.active{background-position:-186px -301px}.ui3-control-wrap .print{background-position:-212px -332px}.ui3-control-wrap .print.active{background-position:-212px -301px}.ui3-control-wrap .fullscreen{background-position:-239px -332px}.ui3-control-wrap .fullscreen.active{background-position:-239px -301px}.ui3-control-wrap .fullscreen.exit-fullscreen{background-position:-213px -268px}";require.loadCss({content:style,name:"ui3Tools"});var toolsBundle={doMeasure:function(){this.endCaptureMap(),signMgr.exituserSign();var t=this;if(!t.distanceControl){BMap.PolylineTItem=BMap.DistanceTool;var i=new BMap.PolylineTItem(map,{styleCodes:{lnCode:constant.OVERLAY_STYLE.DIS_LINE,spCode:constant.OVERLAY_STYLE.DIS_DOT,slCode:constant.OVERLAY_STYLE.DIS_LBL,tlCode:constant.OVERLAY_STYLE.DIS_T_LBL}});t.distanceControl=i}this.doMeasure._initialized||(t.distanceControl&&t.distanceControl.addEventListener("drawend",function(){listener.trigger("index.controls","close",{target:"measure"})}),this.doMeasure._initialized=!0),t.distanceControl&&(t.distanceControl._isOpen?this.closeMeasure():t.distanceControl.open())},closeMeasure:function(){var t=this;t.distanceControl&&t.distanceControl.close()},captureMap:function(){var t=this;this.closeMeasure(),signMgr.exituserSign(),require.async("common:widget/com/Capture/Capture.js",function(i){t.startCaptureMap(i)})},startCaptureMap:function(t){t._initialized||(t.initialize(map),t._initialized=!0),t._inUse?t.endCapture():t.beginCapture()},endCaptureMap:function(){window.captureCtrl&&window.captureCtrl._initialized&&window.captureCtrl.endCapture()},selectCity:function(t,i){if(window.temp.cityPop)return void window.temp.cityPop.close();var o={title:"城市列表",content:"",height:402,width:395,open:function(){t.addClass("ui3-city-change-click")},close:function(){t.removeClass("ui3-city-change-click"),window.temp.cityPop=null}};for(var e in i)o[e]=i[e];require.async(["common:widget/ui/Popup/Popup.js","common:widget/ui/Storage/Storage.js","common:widget/com/SelectCity/SelectCity.js"],function(e,a,n){var r=window.temp.cityPop=new e(o);r.addConnectDom(t[0]),r.render(),r.hide(),o&&"undefined"!=typeof o.right?r.getDom().style.right=o.right+"px":r.getDom().style.left=o&&"undefined"!=typeof o.left?o.left+"px":"close"==mapInfo.status?"12px":"396px",o&&"undefined"!=typeof o.top?r.getDom().style.top=o.top+"px":o&&"undefined"!=typeof o.bottom?r.getDom().style.top=o.bottom+"px":map.fullScreenMode?(r.getDom().style.top="28px",r.getDom().style.left="12px"):r.getDom().style.top="136px",i.baiduStorage=a,i.exitLargeMapMode=!1;var c=new n({dom:r.content,cinfo:i,pop:r});c.show()}),window.place&&place.resetArea&&place.resetArea()}},toolsMediator=window.toolsMediator={getOthers:function(t){var i={viewSearchTool:1,trafficStTool:1,streetViewTool:1},o=[];return delete i[t],T.each(i,function(t){window[t]&&window[t].btn&&o.push(window[t].btn[0])}),T(o)},removeActive:function(t){var i=t.attr("data-model"),o=i+"-click";t.removeClass("ui3-blue").removeClass(o)},addActive:function(t){var i=t.attr("data-model"),o=i+"-click";t.addClass("ui3-blue").addClass(o)},checkStatus:function(t){var i=t.attr("data-model"),o=i+"-click";return t.hasClass("ui3-blue")?(t.removeClass("ui3-blue").removeClass(o),window[i].hideDialog(),!1):(t.addClass("ui3-blue "+o),this.checkOthers(i),!0)},checkOthers:function(t){var i;i="string"==typeof t?t:"undefined"==typeof t?"others":t.attr("data-model");var o=this.getOthers(i),e=o.filter(".ui3-blue");if(e.length){var a=e.attr("data-model");e.removeClass("ui3-blue").removeClass(a+"-click"),window[a].hideDialog()}}};fullScreen.prototype=new BMap.Control,fullScreen.prototype.initialize=function(){try{var t=['<a id="ui3_tool_fullScr" class="ui3-full-screen ui3-control-color ui3-control-shadow" href="#" onclick="return false;">',"    <em></em><span>全屏</span>","</a>"],i=T(t.join("")).appendTo(this._map.getContainer());return this.process(),i[0]}catch(o){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:o.message||o.description,path:"common:widget/ui/ui3Tools/ui3Tools.js",ln:309})}},fullScreen.prototype.process=function(){require.async("common:widget/ui/fullScreen/fullScreen.js",function(t){t.init()})},viewSearch.prototype=new BMap.Control,viewSearch.prototype.initialize=function(){try{var t=['<div id="ui3_tool_sehInView_wrap" class="ui3-control-shadow ui3-view-search-wrap">','    <a data-model="viewSearchTool" class="ui3-view-search ui3-control-color" href="#" onclick="return false" id="ui3_tool_sehInView">',"        <em></em><span>视野内搜索</span>","    </a>","</div>"],i=T(t.join("")).appendTo(this._map.getContainer());return this.wrap=i,this.btn=i.find("[data-model]"),this.process(),i[0]}catch(o){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:o.message||o.description,path:"common:widget/ui/ui3Tools/ui3Tools.js",ln:356})}};var viewSearchControl={process:function(){this.searchInView()},searchInView:function(){if(window.searchInViewCtrl){var t=window.searchInViewCtrl;0==t.isOpen?(t.prepare(),addStat("indextool.searchinview.opensearchinview","click",{da_e_name:"pcmap3"})):t.setStatus(),t.hasClickButton=!0}else{var i=require("common:widget/ui/genericRequest/GenericRequest.js"),o=require("common:widget/ui/searchInViewControl/SearchInViewControl.js");window.GRControll||(window.GRControll=new i({toolAreaId:"GR_Select"}));var t=window.searchInViewCtrl=new o;t.prepare(),t.hasClickButton=!0,addStat("indextool.searchinview.opensearchinview","click",{da_e_name:"pcmap3"})}},hideDialog:function(){var t=window.searchInViewCtrl;t.isOpen&&t.setStatus(),t.hasClickButton=!0}};trafficSt.prototype=new BMap.Control,trafficSt.prototype.initialize=function(){try{var t=T('<div id="ui3_tool_traffic_wrap" class="ui3-traffic-st-wrap ui3-control-shadow">        <a data-model="trafficStTool" class="ui3-traffic-st ui3-control-color" href="#" onclick="return false" id="ui3_tool_traffic">            <em></em><span>路况</span></a>        </div>').appendTo(this._map.getContainer());return this.wrap=t,this.btn=t.find("[data-model]"),this.process(),t[0]}catch(i){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"common:widget/ui/ui3Tools/ui3Tools.js",ln:449})}},trafficSt.prototype.process=function(){var t=this;require.async("common:widget/ui/Traffic/Traffic.js",function(i){var o=i.need2ShowTraffic(),e=window,a=t.btn;o?a.click(function(){toolsMediator.checkStatus(a)&&i.loadTrafficCtrl()}):e.trafficCtrl&&e.trafficCtrl.hide()})},trafficSt.prototype.hideDialog=function(){trafficCtrl.close({type:"popClose"})},toolCollection.prototype=new BMap.Control,toolCollection.prototype.initialize=function(){try{var t=['<div class="ui3-tool-collection-wrap ui3-control-shadow" id="ui3_tool_collection">','    <a class="ui3-tool-collection ui3-control-color">',"        <em></em","        ><span>工具</span>","    </a>","    <ul>",'        <li><a href="#" onclick="return false" id="ui3_measure" class="ui3-1" title="测距"><em></em><span>测距</span></a></li>','        <li><a href="#" onclick="return false" id="ui3_capwrap" class="ui3-2" title="截图"><em></em><span>截图</span></a></li>','        <li><a href="#" onclick="return false" id="ui3_mark" class="ui3-3" title="标记"><em></em><span>标记</span></a></li>','        <li><a href="#" onclick="return false" id="ui3_print" class="ui3-4" title="打印"><em></em><span>打印</span></a></li>','        <li><a data-model="ui3LinkTool" href="#" onclick="return false" id="ui3_link" class="ui3-5" title="分享"><em></em><span>分享</span></a></li>',"    </ul>","</div>"];return t=this.container=T(t.join("")).appendTo(this._map.getContainer()),this.process(),t[0]}catch(i){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"common:widget/ui/ui3Tools/ui3Tools.js",ln:514})}},toolCollection.prototype.process=function(){var t=this.container;setTimeout(function(){t.css({"z-index":11})},10);var i,o,e=t.find("ul"),a=t.find(".ui3-tool-collection");e.mouseenter(function(){i=!0}).mouseleave(function(){i=!1,clearTimeout(o),e.animate({height:0},200,"linear",function(){i||e.hide()})}),a.mouseenter(function(){i=!0,e.clearQueue(),e.show().animate({height:125},200,"linear",function(){addStat("indextool.toolbar.toolCollection","click",{da_e_name:"pcmap3"})})}).mouseleave(function(){i=!1,o=setTimeout(function(){i||e.animate({height:0},200,"linear",function(){i||e.hide()})},200)});var n=T("#ui3_measure"),r=T("#ui3_capwrap"),c=T("#ui3_mark"),l=T("#ui3_link");n.bind("click",function(){addStat("indextool.toolbar.ruler","click",{da_e_name:"pcmap3"}),toolsBundle.doMeasure(this)}),r.bind("click",function(){addStat("indextool.toolbar.capture","click",{da_e_name:"pcmap3"}),toolsBundle.captureMap(this)}),c.bind("click",function(){toolsMediator.checkOthers(),signMgr("mapSign"),addStat("indextool.toolbar.mark","click",{da_e_name:"pcmap3"})}),l.bind("click",function(){toolsMediator.checkOthers(),require.async("common:widget/ui/toolShare/ToolShare.js",function(t){t.open(l[0]),window.ui3LinkTool={hideDialog:function(){window.temp.linkPop.hide()},btn:l},addStat("indextool.toolbar.share","click",{da_e_name:"pcmap3"})})})},cityChange.prototype=new BMap.Control,cityChange.prototype.initialize=function(){try{var t=['<div class="ui3-city-change-wrap" id="ui3_city_change_wrap">',' <div id="ui3_city_change" class="ui3-city-change">','  <a href="#" onclick="return false"  class="ui3-city-change-inner ui3-control-shadow">',"<span></span><i><em></em></i>","<b></b>","</a>"," </div>","</div>"];return this.wrap=t=T(t.join("")).appendTo(this._map.getContainer()),this.process(),t[0]}catch(i){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"common:widget/ui/ui3Tools/ui3Tools.js",ln:684})}},cityChange.prototype.process=function(){var t=T("#ui3_city_change");t.click(function(){toolsBundle.selectCity(t,{styleSwitch:!0}),addStat("indexcityex.cityexchange.cityexchangeentrance","click",{da_e_name:"pcmap3"})}),listener.on("com.city","change",function(i,o){var e="中国"==o.name?"全国":o.name;t.find(".ui3-city-change-inner>span").text(e)})};var streetViewTool={init:function(){var t=window;this.isSupportStreetView2()?(window.maptypeCtrl&&window.maptypeCtrl.setOffset(new BMap.Size(9,100)),t.streetViewTool?(t.streetViewTool.show(),t.streetViewTool.setPostion()):require.async("pano:widget/StreetViewTool/StreetViewTool.js",function(i){t.streetViewTool=new i({map:map}),map.addControl(t.streetViewTool),t.streetViewTool.addEventListener("hide",function(){window.maptypeCtrl.setOffset(new BMap.Size(9,50))}),t.streetViewTool.addEventListener("show",function(){window.maptypeCtrl.setOffset(new BMap.Size(9,100))}),map.getMapType()===BMAP_EARTH_MAP?t.streetViewTool.hide():t.streetViewTool.show()})):(t.streetViewTool&&t.streetViewTool.hide(),window.maptypeCtrl&&window.maptypeCtrl.setOffset(new BMap.Size(9,50)))},isSupportStreetView2:function(){var t=window.G_POC||[],i=modelConfig.cityCode;if(i>=9e3&&9378>=i)return!1;for(var o=0;o<t.length;o++)if(i==t[o]||-9999==t[o])return!0;return!1}};allControlsBundle.prototype=new BMap.Control,T.extend(allControlsBundle.prototype,{initialize:function(){try{var tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div class="ui3-control-wrap" id="ui3_control_wrap">    <div class="controls-wrap">        <div class="left float-l">            <span map-on-click="searchInView" id="search_in_view" class="search-in-view"><p title="视野内搜索"></p></span>            <span map-on-click="traffic" id="traffic_control" class="last traffic"><p title="路况"></p></span>        </div>        <div class="right float-l">            <span map-on-click="share" class="share"><p title="分享"></p></span>            <span map-on-click="measure" class="measure"><p title="测距"></p></span>            <span map-on-click="screenShot" class="screen-shot"><p title="截图"></p></span>            <span map-on-click="mark" class="mark"><p title="标记"></p></span>                        <span map-on-click="fullscreen" class="last fullscreen"><p title="全屏"></p></span>        </div>    </div></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],container=this.container=T(tpl()).appendTo(this._map.getContainer());return T.on(document,"keyup",function(t){27==t.keyCode&&(toolsBundle.closeMeasure(),toolsBundle.endCaptureMap())}),this.process(),container[0]}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"common:widget/ui/ui3Tools/ui3Tools.js",ln:801})}},process:function(){var t=this.container.find(".controls-wrap"),i=this.controls=t.find("span"),o=this;t.delegate("span","click",function(){var t=T(this),e=i.filter(".active-mark");!function(){if(t.hasClass("active-mark"))t.removeClass("active active-mark");else{if(t.hasClass("fullscreen"))return void t.toggleClass("exit-fullscreen");if(e.hasClass("traffic")&&t.hasClass("share")){var i=window.temp.linkPop;o.keepTraffic=i&&i.visible?!1:!0}else!o.keepTraffic||t.hasClass("traffic")||t.hasClass("share")||(o.share(),o.keepTraffic=!1),e.length&&e.trigger("click"),t.addClass("active active-mark")}}();var a=o[t.attr("map-on-click")];"function"==typeof a&&a.call(o,t)}).delegate("span","mouseover",function(){i.removeClass("active"),T(this).addClass("active")}).delegate("span","mouseout",function(){i.removeClass("active").filter(".active-mark").addClass("active")}),listener.on("index.controls","close",function(t,e){i.filter("."+e.target).removeClass("active active-mark"),"share"===e.target&&(o.keepTraffic=!1)})},facade:function(){},searchInView:function(){viewSearchControl.process()},traffic:function(){require.async("common:widget/ui/Traffic/Traffic.js",function(t){var i=t.need2ShowTraffic();i?window.trafficCtrl?trafficCtrl.opened?trafficCtrl.close():trafficCtrl.open():t.loadTrafficCtrl():t.exit()})},share:function(){var t=this;require.async("common:widget/ui/toolShare/ToolShare.js",function(i){var o=window.temp.linkPop;o&&o.visible?o.close():i.open({keepTraffic:t.keepTraffic}),addStat("indextool.toolbar.share","click",{da_e_name:"pcmap3"})})},measure:function(){addStat("indextool.toolbar.ruler","click",{da_e_name:"pcmap3"}),toolsBundle.doMeasure()},screenShot:function(){addStat("indextool.toolbar.capture","click",{da_e_name:"pcmap3"}),toolsBundle.captureMap()},mark:function(){signMgr("mapSign"),addStat("indextool.toolbar.mark","click",{da_e_name:"pcmap3"})},print:function(){},fullscreen:function(){require.async("common:widget/ui/fullScreen/fullScreen.js",function(t){t.hasInit?t.toggleFullScreen():t.init()})}}),module.exports=T.extend(toolsBundle,{init:function(){window.isPrint||(window.allControlsBundleTool=new allControlsBundle({map:map}),map.addControl(allControlsBundleTool),map.getMapType()===BMAP_EARTH_MAP?allControlsBundleTool.hide():allControlsBundleTool.show(),allControlsBundleTool.container.css("zIndex",1001),window.cityChangeTool=new cityChange({map:map}),map.addControl(cityChangeTool),cityChangeTool.show())},cityChange:cityChange,fullScreen:fullScreen,viewSearch:viewSearch,trafficSt:trafficSt,toolCollection:toolCollection,streetViewTool:streetViewTool})});
;define("common:widget/ui/ui3SearchBox/ui3SearchBox.js",function(e,a,o){var n=e("common:widget/ui/config/config.js"),t=n.modelConfig,i=e("common:widget/com/componentManager.js"),c=e("common:widget/ui/util/util.js"),r=e("common:widget/ui/ClearBase/ClearBase.js"),s=T("#PoiSearch"),u=e("pano:widget/PanoUtil/PanoUtil.js"),m="",d=function(){try{var a,o=a={work:function(){e.async("common:widget/ui/ui3MapSuggest/ui3MapSuggest.js",function(e){e.initialize({input:s,adjustLeft:-8,adjustTop:9,adjustWidth:35,from:"search",onSelect:function(e,o,n){a.search.call(a,{key:e,extra:n,da_src:"pcmappg.searchBox.sugg"},o)}})}),this.bindBtnEvents()},bindBtnEvents:function(){T("#locSearch").on("submit",function(e){e.preventDefault();var o=T.trim(s.val());if(""!==o){var n=s.data("sugData"),t=n?n.extra:"";a.search({key:o,extra:t,da_src:"searchBox.button"}),window.isPrint||r.clearInit(),window.addStat("searchbox.search.all","show",{da_e_name:"pcmap3"})}}),T(".search_input_text").on("focus",function(e){e.preventDefault()})},search:function(e,a){var o=e.key,n=t.cityCode||1,r=e.da_src,s=document.fmwd,m=o?1:0,d=map.getBounds(),f="",l={cinfo:{from:"searchBox"},dom:T.g("MapInfo")};if(f=s.word.value=c.filtQuery(s.word.value),""==s.word.value)return s.word.focus(),!1;g(f);var h=Math.min(d.minX,d.maxX),p=Math.max(d.minX,d.maxX),w=Math.min(d.minY,d.maxY),x=Math.max(d.minY,d.maxY),v=a||T.g("PoiSearch")&&T.g("PoiSearch")._wd2||"",m=v?1:0,S="s&da_src="+r+"&wd="+encodeURIComponent(s.word.value)+"&c="+n+"&src=0&wd2="+encodeURIComponent(v)+"&sug="+m+"&l="+map.getZoom()+"&b=("+h+","+w+";"+p+","+x+")&from=webmap&force=newsample",B="forceApiNewSample";~location.href.indexOf(B)&&(S+="&"+B),S+="&sug_forward="+e.extra,i.go(S,l),u.closePano("search")}};o.work()}catch(n){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:n.message||n.description,path:"common:widget/ui/ui3SearchBox/ui3SearchBox.js",ln:122})}},f=function(){return m},g=function(e){m=e||"",s.val(m)};o.exports={initialize:d,getQuery:f,setQuery:g}});
;define("common:widget/ui/FilterStatus/FilterStatus.js",function(t,e,i){var a={active:!1,businessName:"",districtName:"",tag:"",PriceTag:""};i.exports=a});
;define("common:widget/view/BusSubLine/LineView.js",function(require,exports,module){function LineView(data){View.call(this),this.busStopTmpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push("<div>    "),expandable&&_template_fun_array.push('    <div class="fold-wrap">        <a class="fold" href="javascript:void(0)" map-on-click="hideBusLine">            <span >                途径站点            </span>        </a>    </div>    '),_template_fun_array.push('    <ol class="station-list ',"undefined"==typeof type?"":baidu.template._encodeHTML(type),'-list">        ');for(var i=0;i<stations.length;i++){if(_template_fun_array.push('              <li class="',"undefined"==typeof(i===stations.length-1?"last-child":"")?"":baidu.template._encodeHTML(i===stations.length-1?"last-child":""),'">                  <a href="javascript:void(0)" data-busStopIndex="',"undefined"==typeof i?"":baidu.template._encodeHTML(i),'" class="street-view-point"></a>                  <div class="name-wrap">                      <a class="station-name" href="javascript:void(0)" data-busStopIndex="',"undefined"==typeof i?"":baidu.template._encodeHTML(i),'" map-on-click="selectBusStop">                          '),"sub"===type&&stations[i].transfer?_template_fun_array.push('                          <span class="station-transfer"></span>                          '):_template_fun_array.push('                          <span class="station-seq">',"undefined"==typeof(i+1)?"":baidu.template._encodeHTML(i+1),"</span>                          "),_template_fun_array.push("                          ","undefined"==typeof("nbus"===type?". ":"")?"":baidu.template._encodeHTML("nbus"===type?". ":""),"","undefined"==typeof stations[i].name?"":baidu.template._encodeHTML(stations[i].name),"                      </a>                      "),stations[i].subways){_template_fun_array.push("                      ");var subways=stations[i].subways;_template_fun_array.push("                      ");for(var j=0;j<subways.length;j++)_template_fun_array.push('                          <span class="subway-label" style="background:',"undefined"==typeof subways[j].background_color?"":baidu.template._encodeHTML(subways[j].background_color),'">',"undefined"==typeof subways[j].name?"":subways[j].name,"</span>                      ");_template_fun_array.push("                      ")}_template_fun_array.push("                  </div>              </li>        ")}_template_fun_array.push("    </ol></div>"),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],this.data=data}var View=require("common:widget/view/View.js");T.inherits(LineView,View,"LineView"),T.object.extend(LineView.prototype,{render:function(){try{return this.$el=this.busStopTmpl(this.data),this.$el}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"common:widget/view/BusSubLine/LineView.js",ln:19})}},initialize:function(){try{}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"common:widget/view/BusSubLine/LineView.js",ln:21})}}}),module.exports=LineView});