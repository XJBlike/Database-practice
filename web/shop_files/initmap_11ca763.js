!function(){function aO(e,t){if("string"==typeof e&&(e=document.getElementById(e)),!e)throw"invalid container element";if(aJ.call(this),this.container=e,this._setStyle(e),e.unselectable="on",e.innerHTML="",e.appendChild(this.render()),this.width=0,this.height=0,this.offsetX=0,this.offsetY=0,this.platform=e.children[0],this.maskLayer=this.platform.children[0],this._panes={},this._bind(),this.centerPoint=null,this.zoomLevel=0,this.lastLevel=0,this.defaultZoomLevel=null,this.defaultCenter=null,this.currentOperation=0,t=t||{},this.config={clickInterval:200,enableDragging:!0,enableKeyboard:!1,enableClickPan:!1,enableDblclickZoom:!0,enableContinuousZoom:!1,enableWheelZoom:!1,enableMouseDown:!0,fps:25,zoomerDuration:240,actionDuration:450,defaultCursor:bk.defaultCursor,draggingCursor:bk.draggingCursor,isOverviewMap:!1,zoomLevelMin:3,zoomLevelMax:19,coordType:BMAP_COORD_MERCATOR,mapType:BMAP_NORMAL_MAP,restrictBounds:!1,drawer:BMAP_SYS_DRAWER,enableInertialDragging:!1,drawMargin:500,enableFulltimeSpotClick:!1,enableResizeOnCenter:!1,enableDeepZoom:this.detectModernBrowser(),enableEarth:N(),defaultMaxBounds:new a1(-21364736,-10616832,23855104,15859712)},this.setConfig(t),bE[this.config.mapType]||(this.config.mapType=BMAP_NORMAL_MAP),this.config.mapType!==BMAP_EARTH_MAP||this.config.enableEarth||this.forceEnableEarth()===!1&&(this.config.mapType=BMAP_NORMAL_MAP),this.config.zoomLevelMin=t.zoomLevelMin||bE[this.config.mapType].zoomLevelMin,this.config.zoomLevelMax=t.zoomLevelMax||bE[this.config.mapType].zoomLevelMax,this.mapType=this.config.mapType,this.preMapType=null,this.config.enableEarth){var i=this.maskLayer.style;i.opacity=0,i.background="#000",setTimeout(function(){i.WebkitTransition=i.transition="opacity .6s"},100)}if(this._isHybridShow=!0,this.temp={operating:!1,arrow:0,lastDomMoveTime:0,lastLoadTileTime:0,lastMovingTime:0,canKeyboard:!1,I:function(e){return q.I(e)},curSpots:[],curSpotsArray:[],spotsGuid:1,registerIndex:-1,hoverOnSpot:null,isStdCtrlBusy:!1},window.InstanceCore=this.temp.I,this.platform.style.cursor=this.config.defaultCursor,q.Browser.ie)try{document.execCommand("BackgroundImageCache",!1,!0)}catch(n){}for(var o=0;o<bO._register.length;o++)bO._register[o](this);this.temp.registerIndex=o;var a=this;bL.load("oppc",function(){a._asyncRegister()}),e=null,this.enableLoadTiles=!0,this.dispatchEvent(l()?new aH("onwebglsupport"):new aH("onwebglnotsupport"))}function k(e){var t={duration:1e3,fps:30,delay:0,transition:W.linear};if(e)for(var i in e)t[i]=e[i];if(this._callbacks=[],this._options=t,t.delay){var n=this;setTimeout(function(){n._doStart()},t.delay)}else this._doStart()}function bL(){}function bu(){this._map=null,this._container,this._type="control",this.blockInfoWindow=!0,this._visible=!0}function Q(e){bu.call(this),e=e||{},this._opts={printable:!1},q.extend(this._opts,e),this._copyrightCollection=[],this.defaultAnchor=BMAP_ANCHOR_BOTTOM_LEFT,this.defaultOffset=new af(5,2),this.setAnchor(e.anchor),this._canShow=!0,this.sateMapStyle=!1,this.blockInfoWindow=!1,this._asyncLoadCode()}function a0(e){bu.call(this),e=e||{},this._opts={printable:!1},this._opts=q.extend(q.extend(this._opts,{color:"black",unit:"metric"}),e),this.defaultAnchor=BMAP_ANCHOR_BOTTOM_LEFT,this.defaultOffset=new af(81,18),this.setAnchor(e.anchor),this._units={metric:{name:"metric",conv:1,incon:1e3,u1:"米",u2:"公里"},us:{name:"us",conv:3.2808,incon:5280,u1:"英尺",u2:"英里"}},this.sateMapStyle=!1,this._units[this._opts.unit]||(this._opts.unit="metric"),this._scaleText=null,this._numberArray={},this._asyncLoadCode()}function B(e){bu.call(this),e=e||{},this._opts={printable:!1},q.extend(this._opts,e),this.controlHeight=[{width:65,height:227,zoomHeight:227,zoomWidth:37,sliderHeight:180},{width:65,height:47,zoomHeight:47,zoomWidth:37,sliderHeight:0},{width:37,height:57,zoomHeight:0,zoomWidth:0,sliderHeight:0},{width:26,height:47,zoomHeight:47,zoomWidth:6,sliderHeight:0},{width:56,height:47,zoomHeight:47,zoomWidth:37,sliderHeight:180}],this.defaultAnchor=BMAP_ANCHOR_TOP_LEFT,this.defaultOffset=new af(10,10),this.setAnchor(e.anchor),this.setType(e.type),this._maxTotalZoomLv=19,this._minZoomLevel=-1,this._maxZoomLevel=-1,this._totalZoomLv=-1,this._sliderInterval=10,this._sliderHeight=180,this._minBarY=1,this._maxBarY=-1,this._curBarY=-1,this._zoomDom=null,this._zoomBtnDom=null,this._sliderDom=null,this._sliderBaseDom=null,this._cZIndex="1100",this._asyncLoadCode()}function ak(e){bu.call(this),e=e||{},this._opts={printable:!1},this.defaultAnchor=BMAP_ANCHOR_TOP_RIGHT,this.defaultOffset=new af(10,10),this.setAnchor(e.anchor),this._opts=q.extend(q.extend(this._opts,{offset:this.defaultOffset,enableSwitch:!0}),e);var t=this;bL.load("control",function(){t._asyncDraw()})}function bK(e){aJ.call(this),this._opts={container:null,cursor:"default"},this._opts=q.extend(this._opts,e),this._type="contextmenu",this._map=null,this._container,this._shadow,this._left=0,this._top=0,this._items=[],this._rItems=[],this._dividers=[],this._enable=!0,this.curPixel=null,this.curPoint=null,this._isOpen=!1;var t=this;bL.load("menu",function(){t._draw()})}function aG(e,t,i){if(e&&t&&"function"==typeof t){aJ.call(this),this._opts={width:100,id:""},i=i||{},this._opts.width=1*i.width?i.width:100,this._opts.id=i.id?i.id:"",this._text=e+"",this._callback=t,this._map=null,this._type="menuitem",this._contextmenu=null,this._container=null,this._enabled=!0;var n=this;bL.load("menu",function(){n._draw()})}}function a1(e,t,i,n){this.minX=e,this.minY=t,this.maxX=i,this.maxY=n}function bl(e,t){isNaN(e)&&(e=a9(e),e=isNaN(e)?0:e),"string"==typeof e&&(e=parseFloat(e)),isNaN(t)&&(t=a9(t),t=isNaN(t)?0:t),"string"==typeof t&&(t=parseFloat(t)),this.lng=e,this.lat=t}function az(){}function at(e,t){for(-90>e?e=-90:e>90&&(e=90);-180>t;)t+=360;for(;t>180;)t-=360;this.lat=e||0,this.lng=t||0}function X(e,t){e&&!t&&(t=e),this._sw=this._ne=null,this._swLng=this._swLat=null,this._neLng=this._neLat=null,e&&(this._sw=new at(e.lat,e.lng),this._ne=new at(t.lat,t.lng),this._swLng=e.lng,this._swLat=e.lat,this._neLng=t.lng,this._neLat=t.lat)}function aT(){this._type="overlay"}function H(){q.BaseClass.call(this),aT.call(this),this._visible=!0,this.infoWindow=null,this._dblclickTime=0}function bC(e){this.map=e,this._overlays={},this._customOverlays=[],e._overlays=this._overlays,e._customOverlays=this._customOverlays,this._init()}function bP(e){H.call(this),this._config={strokeColor:"#3a6bdb",strokeWeight:5,strokeOpacity:.65,strokeStyle:"solid",strokeLineCap:"round",strokeLineJoin:"round",enableMassClear:!0,getParseTolerance:null,getParseCacheIndex:null,enableParse:!0,enableEditing:!1,mouseOverTolerance:15},this.setConfig(e),this._config.strokeWeight<=0&&(this._config.strokeWeight=5),(this._config.strokeOpacity<0||this._config.strokeOpacity>1)&&(this._config.strokeOpacity=.65),(this._config.fillOpacity<0||this._config.fillOpacity>1)&&(this._config.fillOpacity=.65),"solid"!=this._config.strokeStyle&&"dashed"!=this._config.strokeStyle&&"dotted"!=this._config.strokeStyle&&(this._config.strokeStyle="solid"),this.domElement=null,this._bounds=new bO.Bounds(0,0,0,0),this._parseCache=[],this.vertexMarkers=[],this._temp={}}function o(e){H.call(this),this.map=null,this.domElement=null,this._config={width:0,height:0,offset:new af(0,0),opacity:1,background:"transparent",lineStroke:1,lineColor:"#000",lineStyle:"solid",point:null},this.setConfig(e),this.point=this._config.point}function C(e,t,i){if(e&&t){this.imageUrl=e,this.size=t;var n=new af(Math.floor(t.width/2),Math.floor(t.height/2)),o={offset:n,imageOffset:new af(0,0)};i=i||{};for(var a in i)typeof o[a]==typeof i[a]&&(o[a]=i[a]);this.offset=o.offset,this.imageOffset=o.imageOffset,this.infoWindowOffset=i.infoWindowOffset||this.offset,this.printImageUrl=i.printImageUrl||"",this.imageSize=i.imageSize,this.setImageSrcset(i.srcSet)}}function a2(e,t){q.BaseClass.call(this),this.content=e,this.map=null,this._config={width:0,height:0,maxWidth:600,offset:new af(0,0),title:"",maxContent:"",enableMaximize:!1,enableAutoPan:!0,enableCloseOnClick:!0,margin:[10,10,40,10],collisions:[[10,10],[10,10],[10,10],[10,10]],ifMaxScene:!1,onClosing:function(){return!0}},this.setConfig(t),0!=this._config.width&&(this._config.width<220&&(this._config.width=220),this._config.width>730&&(this._config.width=730)),0!=this._config.height&&(this._config.height<60&&(this._config.height=60),this._config.height>650&&(this._config.height=650)),0!=this._config.maxWidth&&(this._config.maxWidth<220&&(this._config.maxWidth=220),this._config.maxWidth>730&&(this._config.maxWidth=730)),this.isWinMax=!1,this.IMG_PATH=bk.imgPath,this.overlay=null;var i=this;bL.load("infowindow",function(){i._draw()})}function M(e,t){H.call(this),this.content=e,this.map=null,this.domElement=null,this._config={width:0,offset:new af(0,0),styles:{backgroundColor:"#fff",border:"1px solid #f00",padding:"1px",whiteSpace:"nowrap",font:"12px arial,simsun",zIndex:"80",MozUserSelect:"none"},point:null,enableMassClear:!0},t=t||{},this.setConfig(t),this._config.width<0&&(this._config.width=0),this.point=this._config.point;var i=this;bL.load("marker",function(){i._draw()})}function K(e,t){H.call(this),t=t||{},this.point=e,this.map=null,this._animation=null,this.domElement=null,this.iconDom=null,this.infoWindowDom=null,this.siblingElement=null,this._config={offset:new af(0,0),opacity:1,icon:null,title:"",infoWindow:null,label:null,baseZIndex:0,clickable:!0,zIndexFixed:!1,isTop:!1,enableMassClear:!0,enableDragging:!1,raiseOnDrag:!1,restrictDraggingArea:!1,startAnimation:""},this.setConfig(t),t.icon||(this._config.icon=new bO.Icon(bk.imgPath+"marker_red.png",new af(23,25),{offset:new af(10,25),infoWindowOffset:new af(10,0)})),this._isDragging=!1;var i=this;bL.load("marker",function(){i._draw()})}function j(e,t){bP.call(this,t),this.setPoints(e);var i=this;bL.load("poly",function(){i._draw()})}function ae(e,t){bP.call(this,t),this.setPoints(e);var i=this;bL.load("poly",function(){i._draw()})}function bs(e,t){bP.call(this,t),t=t||{},this._config.fillOpacity=t.fillOpacity?t.fillOpacity:.65,this._config.fillColor=""==t.fillColor?"":t.fillColor?t.fillColor:"#fff",this.setPoints(e);var i=this;bL.load("poly",function(){i._draw()})}function a(e,t,i){this.point=e,this.radius=Math.abs(t),bs.call(this,[],i)}function bh(e,t){bs.call(this,e,t);var i=this;bL.load("poly",function(){i._draw()})}function aM(e,t){e=isNaN(e)?0:e,t=isNaN(t)?0:t,this.x=e,this.y=t}function af(e,t){this.width=parseFloat(e)||0,this.height=parseFloat(t)||0}function a8(e,i,n,o,a){this.mgr=e,this.position=n,this._cbks=[],this.name=e.getTileName(o,a),this.info=o,this._transparentPng=a.isTransparentPng();var r=I("img");bI(r),r.galleryImg=!1;var s=r.style;s.position="absolute",s.width=e.tileSize+"px",s.height=e.tileSize+"px",s.left=n[0]+"px",s.top=n[1]+"px",this.img=r,this.src=i,v&&0===n._offsetX&&(s.opacity=0);var l=this;this.img.onload=function(e){if(l.mgr){var i=l.mgr,o=i.bufferTiles;i.bufferNumber>0&&(o[l.name]=l,o.push(l.name));for(var r=o.length-i.bufferNumber,s=0;r>0&&s<o.length;s++){var h=o[s];if(!i.mapTiles[h]){if(o[h]){o[h].mgr=null;var c=o[h].img;c.parentNode&&(z(c),c.parentNode.removeChild(c)),c=null,o[h].img=null,o[h]=null,delete o[h]}o.splice(s,1),s--,r--}}if(l.loaded=!0,i.imgNumber++,!t(l.img)&&a.tilesDiv&&(a.tilesDiv.appendChild(l.img),FeBrowser.ie<=6&&FeBrowser.ie>0&&1==a.isTransparentPng())){var p=l.img.style,f=p.width,u=p.height,d='position:absolute;FILTER: progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+l.src+'",sizingMethod=scale);';p.cssText=d,p.width=f,p.height=u,p.left=l.position[0]+"px",p.top=l.position[1]+"px"}var e=new aH("onimagechange");e.action="show",e.tile=l.name,i.map.dispatchEvent(e),v&&0===n._offsetX&&new k({fps:20,duration:200,render:function(e){l.img&&l.img.style&&(l.img.style.opacity=1*e)},finish:function(){l.img&&l.img.style&&delete l.img.style.opacity}}),l._callCbks()}},this.img.onerror=function(){if(l.error=!0,l._callCbks(),l.mgr){var e=(l.mgr,bE[a.mapType]);e.errorUrl&&(l.img.src=e.errorUrl),t(l.img)||a.tilesDiv&&a.tilesDiv.appendChild(l.img)}},r=null;var h=new aH("onimagebefore");h.tile=l.name,e.map.dispatchEvent(h)}function a4(e){this.tileLayers=[],this.map=e,this.bufferNumber=300,this.mapTiles=[],this.bufferTiles=[],this.config=bE[this.map.mapType],this.errorUrl=this.config.errorUrl,this.tileSize=this.config.tileSize,this.baseUnits=this.config.baseUnits,this.baseZoomLevel=this.config.zoomLevelBase,this.tileURLs=this.config.tileUrls,this.imgNumber=0,this.numLoading=0,this.temp={};var t=3,i=256,n=Math.pow(2,18-t)*i,o=2,a=(o+1)*n,r=az.convertLL2MC(new bl(180,0)),s=r.lng,l=a-s,h=-3,c=h*n,p=az.convertLL2MC(new bl(-180,0)),f=p.lng,u=f-c;this._mc180X=s,this._mcM180X=f,this._loopOffset=l+u,this._mcTSpan=s-f}function p(e){this.opts=e||{},this.copyright=this.opts.copyright||{},this.transparentPng=this.opts.transparentPng||!1,this.baseLayer=this.opts.baseLayer||!1,this.offset=[0,0],this._type="tilelayer",this.scaler=window.devicePixelRatio&&window.devicePixelRatio>=2?2:1}function V(e,t,i){this.bounds=e,this.content=t,this.mapType=i}function w(e){aJ.call(this),e&&(this._opts={},this._map=e)}function aX(e,t){w.call(this,e),t=t||{},this._opts=q.extend(q.extend(this._opts||{},{autoClear:!1,tips:"测距",followText:"单击确定起点，双击结束绘制",unit:"metric",showResult:!0,lineColor:"blue",lineStroke:2,opacity:1,lineStyle:"solid",cursor:bk.imgPath+"ruler.cur",styleCodes:{lnCode:0,spCode:0,slCode:0,tlCode:0},enableMassClear:!0}),t),0==this._opts.showResult&&("undefined"==typeof t.tips&&(this._opts.tips="绘制折线"),t.cursor||(this._opts.cursor="crosshair")),this._opts.lineStroke<=0&&(lineStroke=2),this._opts.opacity>1?this._opts.opacity=1:this._opts.opacity<0&&(this._opts.opacity=0),"solid"!=this._opts.lineStyle&&"dashed"!=this._opts.lineStyle&&(this._opts.lineStyle="solid"),this._checked=!1,this._drawing=null,this.followTitle=null,this._totalDis={},this._points=[],this._paths=[],this._dots=[],this._segDistance=[],this._overlays=[],this._units={metric:{name:"metric",conv:1,incon:1e3,u1:"米",u2:"公里"},us:{name:"us",conv:3.2808,incon:5279.856,u1:"英尺",u2:"英里"}},this._units[this._opts.unit]||(this._opts.unit="metric"),this._dLineColor="#ff6319",this._dLineStroke=3,this._dOpacity=.8,this._dLineStyle="solid",this._dCursor=bk.imgPath+"ruler.cur",this._opts.showResult&&(this._opts.followText="单击确定起点"),this._followTextM="单击确定地点，双击结束",this._movingTimerId=null,this.text=this._opts.showResult?"测距":"绘线",this._isOpen=!1;var i=this;bL.load("tools",function(){i._draw()})}function bc(e){return e.style}function aV(e,t){var i=bc(e);i.left=d(t[0]),i.top=d(t[1])}function O(e,t){var i=bc(e);i.opacity=t,i.MozOpacity=t,i.KhtmlOpacity=t,i.filter="alpha(opacity="+100*t+")",i=null}function d(e){if("number"==typeof e)return e+"px";if("string"==typeof e){var t=/"\\s","g"/,i=/"^\\d+(px|%)+$","i"/,n=e.replace(t,"");if(i.exec(n))return n;var o=new RegExp("^\\d+$");return o.exec(n)?n+"px":"0px"}}function bI(e){q.Browser.ie>0?(e.unselectable="on",e.selectstart=function(){return!1}):bc(e).MozUserSelect="none"}function D(e,t){var i=bc(e);i.width=d(t[0]),i.height=d(t[1])}function t(e){return e&&e.parentNode&&11!=e.parentNode.nodeType}function T(e,t){return e.insertAdjacentHTML("beforeEnd",t),e.lastChild}function be(e){for(var t={left:0,top:0};e&&e.offsetParent;)t.left+=e.offsetLeft,t.top+=e.offsetTop,e=e.offsetParent;return t}function al(e){var e=window.event||e;e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function bN(e){var e=window.event||e;return e.preventDefault?e.preventDefault():e.returnValue=!1,!1}function bt(e){return al(e),bN(e)}function bR(){var e=document.documentElement,t=document.body;return e&&(e.scrollTop||e.scrollLeft)?[e.scrollTop,e.scrollLeft]:t?[t.scrollTop,t.scrollLeft]:[0,0]}function z(e){if(e){e.onload=e.onerror=null;var t,i,n,o=e.attributes;if(o)for(i=o.length,t=0;i>t;t+=1)n=o[t].name,"function"==typeof e[n]&&(e[n]=null);if(o=e.children)for(i=o.length,t=0;i>t;t+=1)z(e.children[t])}}function av(e,t,i){var n=t.lng-i.lng,o=t.lat-i.lat;if(0==n)return Math.abs(e.lng-t.lng);if(0==o)return Math.abs(e.lat-t.lat);var a=o/n,r=t.lat-a*t.lng;return Math.abs(a*e.lng-e.lat+r)/Math.sqrt(a*a+1)}function bD(e,t){return e&&t?Math.round(Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))):void 0}function E(e,t){var i=[];t=t||function(e){return e};for(var n in e)i.push(n+"="+t(e[n]));return i.join("&")}function I(e,t,i){var n=document.createElement(e);i&&(n=document.createElementNS(i,e)),t=t||{};for(var o in t){var a={"for":"htmlFor","class":"cssClass"}[o]||o;if("style"!=o)if("class"!=o)if(n.setAttribute)n.setAttribute(a,t[o]);else try{n[a]=t[o]}catch(n){}else q.ac(n,t[o]);else n.style.cssText=t[o]}return n}function ah(e){return e.currentStyle?e.currentStyle:e.ownerDocument&&e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):void 0}function ab(){return(new Date).getTime()}function x(e){return"function"==typeof e}function aj(e){return"number"==typeof e}function a9(e){var t,i,n,o,a,r="",s="",l="",h=0,c=/[^A-Za-z0-9\+\/\=]/g;if(!e||c.exec(e))return e;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do n=bm.indexOf(e.charAt(h++)),o=bm.indexOf(e.charAt(h++)),a=bm.indexOf(e.charAt(h++)),l=bm.indexOf(e.charAt(h++)),t=n<<2|o>>4,i=(15&o)<<4|a>>2,s=(3&a)<<6|l,r+=String.fromCharCode(t),64!=a&&(r+=String.fromCharCode(i)),64!=l&&(r+=String.fromCharCode(s)),t=i=s="",n=o=a=l="";while(h<e.length);return r}function ad(e,t){var i=document.createElement("div"),n="Webkit Moz O ms".split(" "),o=n.length,a="",r=i.style;e in r&&(a=e),e=e.replace(/^[a-z]/,function(e){return e.toUpperCase()});for(;o--;){var s=n[o]+e;if(s in r){a=s;break}}return t?a:a.length>0?!0:!1}function aa(){return aB()||by()}function aB(){var e=navigator.userAgent;return e.indexOf("iPhone")>-1||e.indexOf("iPad")>-1?!0:!1}function by(){var e=navigator.userAgent;return e.indexOf("Android")>-1?!0:!1}function L(e){return e*Math.PI/180}function n(e){return e/Math.PI*180}function bw(e,t){var i=Math.pow(10,t);if("number"==typeof e)return Math.round(e*i)/i;for(var n=0;n<e.length;n++)e[n]=bw(e[n],t);return e}function bp(e,t,i){return t>e?e=t:e>i&&(e=i),e}function P(e,t){for(;0>e;)e+=t;return e%t}function aZ(e,t){return e>=0&&t>=0||0>e&&0>t}function bM(e){var t=e.getContext("webgl",{alpha:!1,antialias:!0})||e.getContext("experimental-webgl",{alpha:!1,antialias:!0});return t}function aE(e,t){for(var i=0;i<t.length;i++)q.on(e,t[i],al)}function s(e,t,i){t[i]=e.getUniformLocation(t,i)}function c(e,t,i,n,o){var a="";switch(o){case"mat4":return void e.uniformMatrix4fv(t[i],!1,n);case"v3":a="uniform3fv";break;case"f":a="uniform1f";break;case"i":a="uniform1i"}if(""===a)throw"error";e[a](t[i],n)}function F(e,t){for(;0>e;)e+=360;e%=360;var i=t.width,n=t.height,o=i,a=n;if(90>e)var r=Math.sin(L(e))*i,s=Math.sin(L(e))*n,l=Math.cos(L(e))*i,h=Math.cos(L(e))*n,o=Math.ceil(l+s),a=Math.ceil(r+h);else if(180>e)var e=e-90,r=Math.sin(L(e))*i,s=Math.sin(L(e))*n,l=Math.cos(L(e))*i,h=Math.cos(L(e))*n,o=Math.ceil(r+h),a=Math.ceil(l+s);else if(270>e)var e=e-180,r=Math.sin(L(e))*i,s=Math.sin(L(e))*n,l=Math.cos(L(e))*i,h=Math.cos(L(e))*n,o=Math.ceil(l+s),a=Math.ceil(r+h);else var e=e-270,r=Math.sin(L(e))*i,s=Math.sin(L(e))*n,l=Math.cos(L(e))*i,h=Math.cos(L(e))*n,o=Math.ceil(r+h),a=Math.ceil(l+s);var c=o-i,p=a-n;return[0-c/2,0-p/2,i+c/2,n+p/2]}function bd(e,t){for(var i=e.offsetX||e.layerX,n=e.offsetY||e.layerY,o=e.srcElement||e.target,a=null;o&&o!==t;)i+=o.offsetLeft||0,n+=o.offsetTop||0,o.hashCode&&q.I(o.hashCode)instanceof H&&(a=q.I(o.hashCode)),o=o.offsetParent;return{x:i,y:n,overlay:a}}function Z(e,t){for(var i=e.clientX||e.pageX,n=e.clientY||e.pageY,o=e.srcElement||e.target,a=null;o&&o!==t;)o.hashCode&&q.I(o.hashCode)instanceof H&&(a=q.I(o.hashCode)),o=o.offsetParent;var r=0,s=0;if(t)for(;t.offsetParent;)r+=t.offsetLeft,s+=t.offsetTop,t=t.offsetParent;return{x:i-r,y:n-s,overlay:a}}function aA(e){return e.toDataURL()==aA._blankData?!0:!1}function bx(e,t,i){var n=[i.lng-e.lng,i.lat-e.lat],o=[t.lng-e.lng,t.lat-e.lat];return n[0]*o[1]-n[1]*o[0]}function ac(e,t,i){var n,o,a,r;return e.lng<t.lng?(n=e.lng,a=t.lng):(n=t.lng,a=e.lng),e.lat<t.lat?(o=e.lat,r=t.lat):(o=t.lat,r=e.lat),i.lng<n||i.lng>a||i.lat<o||i.lat>r?!1:!0}function bH(e,t,i,n){var o=bx(i,n,e),a=bx(i,n,t),r=bx(e,t,i),s=bx(e,t,n);return 0>o*a&&0>r*s?!0:0===o&&ac(i,n,e)?!0:0===a&&ac(i,n,t)?!0:0===r&&ac(e,t,i)?!0:0===s&&ac(e,t,n)?!0:!1}function au(e,t){var i=t.parentNode;i.lastChild==t?i.appendChild(e):i.insertBefore(e,t.nextSibling)}function l(){if("boolean"==typeof l._supportWebGL)return l._supportWebGL;if(!window.WebGLRenderingContext)return l._supportWebGL=!1,!1;var e=document.createElement("canvas"),t=null;try{t=e.getContext("webgl")}catch(i){l._supportWebGL=!1}return l._supportWebGL=null===t?!1:!0,l._supportWebGL}function N(e){if(!e&&"boolean"==typeof N._enable)return N._enable;if(l()&&q.Platform.macintosh)return N._enable=!0,!0;if(l()){if(/force=earth/i.test(window.location.href))return N._enable=!0,!0;if(e)return N._enable=!0,!0;try{for(var t=document.cookie.split(";"),i=0;i<t.length;i++)if(t[i].indexOf("BAIDUID=")>-1){var n=t[i].split("=")[1];if(!n)return N._enable=!1,!1;var o=n.charCodeAt(0),a=n.charCodeAt(1);if((o+a)%5===2)return N._enable=!0,!0}}catch(r){return N._enable=!1,!1}}return N._enable=!1,!1}function bn(e,t){if(0==t)return e;var i=0,n=0;if(!e)throw"异常";if(0===e.length)return[];for(var o=1,a=e.length-1;a>o;o++){var r=av(e[o],e[0],e[e.length-1]);r>i&&(n=o,i=r)}var s=[];if(i>=t){for(var l=e.slice(0,n),h=e.slice(n,e.length),c=bn(l,t),p=bn(h,t),o=0,a=c.length;a>o;o++)s.push(c[o]);for(var o=0,a=p.length;a>o;o++)s.push(p[o])}else s.push(e[0]),s.push(e[e.length-1]);return s}var q=q||{version:"20150702",emptyFn:function(){}};if(function(){q._log=[];var e=0,t={};q.BaseClass=function(e){t[this.hashCode=e||q.BaseClass.guid()]=this},q.BaseClass.guid=function(){return"mz_"+(e++).toString(36)},q.BaseClass.create=function(){var e=new q.BaseClass;return e.decontrol(),e};q.instance=q.I=function(e){return t[e]};q.BaseClass.prototype.dispose=function(){this.hashCode&&delete t[this.hashCode];for(var e in this)"function"!=typeof this[e]&&delete this[e]},q.BaseClass.prototype.getHashCode=function(){return this.hashCode||(t[this.hashCode=q.BaseClass.guid()]=this),this.hashCode},q.BaseClass.prototype.decontrol=function(){delete t[this.hashCode]},q.BaseClass.prototype.toString=function(){return"[object "+(this._className||"Object")+"]"},q.BaseClass.prototype._wlog=function(e,t){var i=q._log;i.length>100&&(i.reverse().length=50,i.reverse()),i[i.length]="["+e+"]["+(this._className||"Object")+" "+this.hashCode+"] "+t}}(),Function.prototype.inherits=function(e,t){var i,n,o=this.prototype,a=function(){};a.prototype=e.prototype,n=this.prototype=new a,"string"==typeof t&&(n._className=t);for(i in o)n[i]=o[i];return this.prototype.constructor=o.constructor,o=a=null,n},q.BaseEvent=function(e,t){this.type=e,this.returnValue=!0,this.target=t||null,this.currentTarget=this.srcElement=null,this.cancelBubble=!1,this.domEvent=null},q.BaseClass.prototype.on=q.BaseClass.prototype.addEventListener=function(e,t,i){if("function"!=typeof t)return this._wlog("error","addEventListener:"+t+" is not a function");this._listeners||(this._listeners={});var n,o=this._listeners;"string"==typeof i&&i&&(/[^\w\-]/.test(i)?this._wlog("warning","nonstandard key:"+i):(t.hashCode=i,n=i)),0!=e.indexOf("on")&&(e="on"+e),"object"!=typeof o[e]&&(o[e]={}),n=n||q.BaseClass.guid(),t.hashCode=n,o[e][n]&&this._wlog("warning","repeat key:"+n),o[e][n]=t},q.BaseClass.prototype.off=q.BaseClass.prototype.removeEventListener=function(e,t){if("function"==typeof t)t=t.hashCode;else if("string"!=typeof t)return;this._listeners||(this._listeners={}),0!=e.indexOf("on")&&(e="on"+e);var i=this._listeners;i[e]&&i[e][t]&&delete i[e][t]},q.BaseClass.prototype.fire=q.BaseClass.prototype.dispatchEvent=function(e){this._listeners||(this._listeners={});var t,i=this._listeners,n=e.type;if(e.target=e.srcElement=e.target||e.srcElement||this,e.currentTarget=this,"function"==typeof this[n]&&this[n](e),"object"==typeof i[n])for(t in i[n])"function"==typeof i[n][t]&&i[n][t].call(this,e);return e.returnValue},q.BaseEvent.prototype.inherit=function(e){var t=this;return this.domEvent=e=window.event||e,t.clientX=e.clientX||e.pageX,t.clientY=e.clientY||e.pageY,t.offsetX=e.offsetX||e.layerX,t.offsetY=e.offsetY||e.layerY,t.screenX=e.screenX,t.screenY=e.screenY,t.ctrlKey=e.ctrlKey||e.metaKey,t.shiftKey=e.shiftKey,t.altKey=e.altKey,t},q.Browser=function(){var e=navigator.userAgent,t=0,i=0,n=0,o=0,a=0,r=0,s=0;return"object"==typeof window.opera&&/Opera(\s|\/)(\d+(\.\d+)?)/.test(e)?i=parseFloat(RegExp.$2):/MSIE (\d+(\.\d+)?)/.test(e)?t=parseFloat(RegExp.$1):/Firefox(\s|\/)(\d+(\.\d+)?)/.test(e)?o=parseFloat(RegExp.$2):"Netscape"==navigator.vendor&&/Netscape(\s|\/)(\d+(\.\d+)?)/.test(e)?s=parseFloat(RegExp.$2):e.indexOf("Safari")>-1&&/Version\/(\d+(\.\d+)?)/.test(e)&&(n=parseFloat(RegExp.$1)),e.indexOf("Gecko")>-1&&-1==e.indexOf("KHTML")&&/rv\:(\d+(\.\d+)?)/.test(e)&&(r=parseFloat(RegExp.$1)),/chrome\/(\d+\.\d)/i.test(e)&&(a=parseFloat(RegExp.$1)),{ie:t,firefox:o,gecko:r,netscape:s,opera:i,safari:n,chrome:a}}(),window.FeBrowser=q.Browser,q.Dom={},q.Dom.createDom=function(e,t){q.isIE&&t&&t.name&&(e="<"+e+' name="'+q.String.escapeHTML(t.name)+'">');var i=document.createElement(e);return t&&q.Dom.setProperties(i,t),i},q.Dom.getOffset=function(e){var t=q.Dom.getOwnerDocument(e),i=q.isGecko>0&&t.getBoxObjectFor&&"absolute"==q.Dom.getStyle(e,"position")&&(""===e.style.top||""===e.style.left),n={left:0,top:0},o=q.isIE&&!q.isStrict?t.body:t.documentElement;if(e==o)return n;var a,r=null;if(e.getBoundingClientRect)a=e.getBoundingClientRect(),n.left=a.left+Math.max(t.documentElement.scrollLeft,t.body.scrollLeft),n.top=a.top+Math.max(t.documentElement.scrollTop,t.body.scrollTop),n.left-=t.documentElement.clientLeft,n.top-=t.documentElement.clientTop,q.isIE&&!q.isStrict&&(n.left-=2,n.top-=2);else if(t.getBoxObjectFor&&!i){a=t.getBoxObjectFor(e);var s=t.getBoxObjectFor(o);n.left=a.screenX-s.screenX,n.top=a.screenY-s.screenY}else{r=e;do{if(n.left+=r.offsetLeft,n.top+=r.offsetTop,q.isWebkit>0&&"fixed"==q.Dom.getStyle(r,"position")){n.left+=t.body.scrollLeft,n.top+=t.body.scrollTop;break}r=r.offsetParent}while(r&&r!=e);for((q.isOpera>0||q.isWebkit>0&&"absolute"==q.Dom.getStyle(e,"position"))&&(n.top-=t.body.offsetTop),r=e.offsetParent;r&&r!=t.body;)n.left-=r.scrollLeft,q.isOpera&&"TR"==r.tagName||(n.top-=r.scrollTop),r=r.offsetParent}return n},q.Dom.getOwnerDocument=function(e){return 9==e.nodeType?e:e.ownerDocument||e.document},q.Dom.setProperties=function(e,t){q.each(t,function(t,i){q.Dom._setProperty(e,i,t)})},q.Dom._setProperty=function(e,t,i){"style"==t?e.style.cssText=i:"class"==t?e.className=i:"for"==t?e.htmlFor=i:t in q.Dom._DIRECT_ATTRIBUTE_MAP?e.setAttribute(q.Dom._DIRECT_ATTRIBUTE_MAP[t],i):e[t]=i},q.Dom._DIRECT_ATTRIBUTE_MAP={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder"},q.G=function(){for(var e=[],t=arguments.length-1;t>-1;t--){var i=arguments[t];e[t]=null,"object"==typeof i&&i&&i.dom?e[t]=i.dom:"object"==typeof i&&i&&i.tagName||i==window||i==document?e[t]=i:"string"==typeof i&&(i=document.getElementById(i))&&(e[t]=i)}return e.length<2?e[0]:e},q.ac=function(e,t){(e=this.G(e))&&(t=this.trim(t),new RegExp("(^| )"+t.replace(/(\W)/g,"\\$1")+"( |$)").test(e.className)||(e.className=e.className.split(/\s+/).concat(t).join(" ")))},q.addClassName=q.ac,q.each=function(e,t){if("function"!=typeof t)return e;if(e)if(void 0===e.length)for(var i in e)t.call(e[i],e[i],i);else for(var n=0,o=e.length;o>n;n++)t.call(e[n],e[n],n);return e},q.extend=function(e,t){if(e&&t&&"object"==typeof t){for(var i in t)e[i]=t[i];for(var n,o=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],a=0;a<o.length;a++)n=o[a],Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},q.hide=function(){q.each(arguments,function(e){(e=q.G(e))&&(e.style.display="none")})},q.inherit=function(e,t,i){var n=e.prototype,o=function(){};o.prototype=t.prototype;var a=e.prototype=new o;"string"==typeof i&&(a._className=i);for(var r in n)a[r]=n[r];return e.prototype.constructor=n.constructor,n=null,a},q.isIE=0,function(){navigator.userAgent.indexOf("MSIE")>0&&!window.opera&&(/MSIE (\d+(\.\d+)?)/.test(navigator.userAgent),q.isIE=parseFloat(RegExp.$1))}(),q.rc=function(e,t){if(e=this.G(e)){t=this.trim(t);var i=e.className.replace(new RegExp("(^| +)"+t.replace(/(\W)/g,"\\$1")+"( +|$)","g"),"$2");e.className!=i&&(e.className=i)}},q.removeClassName=q.rc,q.show=function(){this.each(arguments,function(e){(e=q.G(e))&&(e.style.display="")})},q.trim=function(e){return e.replace(/(^[\s\t\xa0\u3000]+)|([\u3000\xa0\s\t]+$)/g,"")},"undefined"!=typeof HTMLElement&&HTMLElement.prototype.__lookupGetter__&&!HTMLElement.prototype.__lookupGetter__("children")&&!window.opera)try{HTMLElement.prototype.__defineGetter__("children",function(){for(var e,t=[],i=0,n=0,o=this.childNodes.length;o>n;n++)e=this.childNodes[n],1==e.nodeType&&(t[i++]=e,e.name&&(t[e.name]||(t[e.name]=[]),t[e.name][t[e.name].length]=e),e.id&&(t[e.id]=e));return t})}catch(a6){}"undefined"==typeof HTMLElement||window.opera||!HTMLElement.prototype||HTMLElement.prototype.insertAdjacentHTML||(HTMLElement.prototype.insertAdjacentHTML=function(e,t){var i=this.ownerDocument.createRange();switch(i.setStartBefore(this),i=i.createContextualFragment(t),e){case"beforeBegin":this.parentNode.insertBefore(i,this);break;case"afterBegin":this.insertBefore(i,this.firstChild);break;case"beforeEnd":this.appendChild(i);break;case"afterEnd":this.nextSibling?this.parentNode.insertBefore(i,this.nextSibling):this.parentNode.appendChild(i)}}),"undefined"==typeof HTMLElement||window.opera||(HTMLElement.prototype.contains=function(e){if(e==this)return!0;for(;e=e.parentNode;)if(e==this)return!0;return!1}),q.Browser.ie||"undefined"==typeof Event||window.opera||(Event.prototype.__defineSetter__("returnValue",function(e){return e||this.preventDefault(),e}),Event.prototype.__defineSetter__("cancelBubble",function(e){return e&&this.stopPropagation(),e})),q.each=function(e,t){if(x(t))for(var i=0,n=e.length;n>i&&t.call(e,e[i],i)!==!1;i++);return e},q.Platform={x11:0,macintosh:0,windows:0,android:0,iphone:0,ipad:0};for(var a3 in q.Platform)q.Platform.hasOwnProperty(a3)&&(q.Platform[a3]=new RegExp(a3,"i").test(window.navigator.userAgent)?1:0);"undefined"==typeof q.Dom&&(q.Dom={}),q.Dom.getComputedStyle=function(e,t){var i,n=9==e.nodeType?e:e.ownerDocument||e.document;if(n.defaultView&&n.defaultView.getComputedStyle){if(i=n.defaultView.getComputedStyle(e,null))return i[t]||i.getPropertyValue(t)}else if(e.currentStyle)return e.currentStyle[t]||"";return""};var aH=q.BaseEvent,aJ=q.BaseClass;aJ.prototype.toString=function(){return this._className||""},q.on=function(e,t,i){return(e=q.G(e))?(t=t.replace(/^on/,"").toLowerCase(),e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent&&e.attachEvent("on"+t,i),e):e},q.un=function(e,t,i){return(e=q.G(e))?(t=t.replace(/^on/,"").toLowerCase(),e.removeEventListener?e.removeEventListener(t,i,!1):e.detachEvent&&e.detachEvent("on"+t,i),e):e},q.hc=function(e,t){if(!e||!e.className||"string"!=typeof e.className)return!1;var i=-1;try{i=e.className==t||e.className.search(new RegExp("(\\s|^)"+t+"(\\s|$)"))}catch(n){return!1}return i>-1};var bk={imgPath:"http://webmap0.map.bdimg.com/image/api/"};q.Browser.firefox?q.extend(bk,{distCursor:"url("+bk.imgPath+"ruler.cur),crosshair",defaultCursor:"-moz-grab",draggingCursor:"-moz-grabbing"}):q.Browser.chrome||q.Browser.safari?q.extend(bk,{distCursor:"url("+bk.imgPath+"ruler.cur) 2 6,crosshair",defaultCursor:"url("+bk.imgPath+"openhand.cur) 8 8,default",draggingCursor:"url("+bk.imgPath+"closedhand.cur) 8 8,move"}):q.extend(bk,{distCursor:"url("+bk.imgPath+"ruler.cur),crosshair",defaultCursor:"url("+bk.imgPath+"openhand.cur),default",draggingCursor:"url("+bk.imgPath+"closedhand.cur),move"});
var bO=bO||{version:"1.1",_register:new Array,register:function(e){this._register[this._register.length]=e}};aO.inherits(aJ,"Map"),q.extend(aO.prototype,{render:function(){var e=I("div",{id:"platform"}),t=e.style;t.overflow="visible",t.position="absolute",t.zIndex=5,t.top=t.left="0px";var i=I("div",{id:"mask","class":"BMap_mask"}),n=i.style;return n.position="absolute",n.top=n.left="0px",n.zIndex="9",n.overflow="hidden",n.WebkitUserSelect="none",e.appendChild(i),e},_setStyle:function(e){var t=e.style;t.overflow="hidden","absolute"!=ah(e).position&&(t.position="relative"),t.backgroundImage="url("+bk.imgPath+"bg.png)",t.textAlign="left"},_bind:function(){var e=this;e._watchSize=function(){var t=e.getSize();if(e.width!=t.width||e.height!=t.height){var i=(t.width-e.width)/2,n=(t.height-e.height)/2,o=e.getZoomUnits(),a=e.centerPoint;a&&!e.config.enableResizeOnCenter&&(e.centerPoint=new bl(a.lng+i*o,a.lat-n*o)),e.maskLayer.style.width=(e.width=t.width)+"px",e.maskLayer.style.height=(e.height=t.height)+"px";var r=new aH("onresize");r.size=t,e.dispatchEvent(r);var s=parseInt(e.platform.style.left)||0,l=parseInt(e.platform.style.top)||0;"undefined"==e.currentOperation||0==e.currentOperation||e.offsetX==s&&e.offsetY==l||e._setPlatformPosition(s,l)}},e._watchSize(),setInterval(e._watchSize,16)},_setPlatformPosition:function(e,t,i,n){if(!(isNaN(e)||isNaN(t)||this.offsetX==e&&this.offsetY==t)){var o=this.offsetX-e,a=this.offsetY-t,r=this.getZoomUnits(),s=this.centerPoint.lng,l=this.centerPoint.lat,h=new bl(s,l);if(this.centerPoint=new bl(h.lng+o*r,h.lat-a*r),i&&(this.centerPoint=i),this.zoomLevel>=10){var c=new a1(7704846.77,-361331.81,15502525.09,9137748.26);(this.centerPoint.lng-this.width/2*r<=c.minX&&0>o||this.centerPoint.lng+this.width/2*r>c.maxX&&o>=0)&&(e=this.offsetX),(this.centerPoint.lat-this.height/2*r<=c.minY&&a>=0||this.centerPoint.lat+this.height/2*r>c.maxY&&0>a)&&(t=this.offsetY),this.centerPoint=new bl(h.lng+(this.offsetX-e)*r,h.lat-(this.offsetY-t)*r);var p=new aH("onreachbounds");this.dispatchEvent(p)}else{var c=bE[this.mapType].bounds;this.mapType===BMAP_SATELLITE_MAP&&(this.centerPoint.lng-this.width/2*r<=c.minX&&0>o||this.centerPoint.lng+this.width/2*r>c.maxX&&o>=0)&&(e=this.offsetX),(this.centerPoint.lat-this.height/2*r<=c.minY&&a>=0||this.centerPoint.lat+this.height/2*r>c.maxY&&0>a)&&(t=this.offsetY),this.centerPoint=new bl(h.lng+(this.offsetX-e)*r,h.lat-(this.offsetY-t)*r);var p=new aH("onreachbounds");this.dispatchEvent(p)}e=Math.round(e),t=Math.round(t),this.offsetX=e,this.offsetY=t;var f=this.platform.style;f.left=e+"px",f.top=t+"px",this.maskLayer.style.left=-e+"px",this.maskLayer.style.top=-t+"px",n||this.dispatchEvent(new aH("onmoving"))}},zoomTo:function(e,t){if(this.mapType!==BMAP_EARTH_MAP){if("number"==typeof e){var i=bE[this.mapType];if(i){var n=e;if(e=this._getProperZoom(e).zoom,e==this.zoomLevel){var o=new aH("onzoomexceeded");return o.targetZoom=n,void this.dispatchEvent(o)}if(this.lastLevel=this.zoomLevel,t)this.temp._cPoint=t,this.temp._cPixel=this.pointToPixel(t);else if(this.getInfoWindow()){var a=this.getInfoWindow().getPoint();this.temp._cPixel=this.pointToPixel(a),this.temp._cPoint=a}if(t||this.temp.infoWin&&this.temp.infoWin.isOpen()){var r=this.temp._cPoint,s=this.temp._cPixel,l=this.getZoomUnits(e);this.centerPoint=new bl(r.lng+l*(this.width/2-s.x),r.lat-l*(this.height/2-s.y))}this.dispatchEvent(new aH("onzoomstart")),this.dispatchEvent(new aH("onzoomstartcode")),this.zoomLevel=e}}}else{var a=t;if(!a&&this.temp.infoWin&&this.temp.infoWin.isOpen()&&(a=this.getInfoWindow().getPoint()),a){var h=this.pointToPixel(a),c=this._earth._getEarthZoomByImgZoom(e);this._earth.zoomWithMousePosFix(c,h)}else this._earth.setImageZoom(e)}},deepZoomMedia:function(e){var t=this;t.temp.isStdCtrlBusy||(t.temp.isStdCtrlBusy=!0,t.deepZoomTo(t.zoomLevel+e),setTimeout(function(){t.temp.isStdCtrlBusy=!1},400))},deepZoomTo:function(e){var t=e-this.zoomLevel,i=this._getProperZoom(e);if(i.exceeded){var n=new aH("onzoomexceeded");return n.targetZoom=e,void this.dispatchEvent(n)}var o=new aM(this.width/2,this.height/2);this.lastLevel=this.zoomLevel,this.getInfoWindow()&&(o=this.pointToPixel(this.getInfoWindow().getPoint(),this.lastLevel));var a=this.deepZoom||new Y(this),r=new af(0,0),s=t>0?1:-1,l=!0;a.zoomMap(o,r,t,s,l)},zoomIn:function(e){this.zoomTo(this.zoomLevel+1,e)},zoomOut:function(e){this.zoomTo(this.zoomLevel-1,e)},panTo:function(e,t,i){if(e&&"Point"==e.toString()){if(this.mapType===BMAP_EARTH_MAP){var n=new aM(this.width/2,this.height/2),o=az.convertMC2LL(e);e._llPt=o;var a=this.pointToPixel(e);return void(Math.abs(n.x-a.x)>this.width||Math.abs(n.y-a.y)>this.height||1==t?this._earth.setCenter(o,{noAnimation:!0}):this._earth.setCenter(o))}var r=this.pointToPixel(e),s=Math.round(this.width/2),l=Math.round(this.height/2);Math.abs(s-r.x)>this.width||Math.abs(l-r.y)>this.height||1==t?this._panTo(s-r.x,l-r.y,e):this._panBy(s-r.x,l-r.y,{duration:i})}},_panTo:function(e,t,i){var n=this.temp;1!=n.operating&&(n.dragAni&&(n.dragAni.stop(),n.dragAni=null,this.dispatchEvent(new aH("onmoveend"))),this.dispatchEvent(new aH("onmovestart")),this._setPlatformPosition(this.offsetX+e,this.offsetY+t,i),this.dispatchEvent(new aH("onmoveend")))},panBy:function(e,t,i){if(this.mapType===BMAP_EARTH_MAP){var n,o=this._earth.getCenter(),a=this.getSize();if(i){var r=az.convertMC2LL(i),s=this._earth.fromLatLngToPixel(r);n=new aM(s.x+e,s.y+t),o=new at(r.lat,r.lng)}else n=new aM(a.width/2+e,a.height/2+t);var l=this._earth.fromPixelToLatLng(n),h=l.sub(o),c=this._earth.getCenter(),p=new at(c.lat-h.lat,c.lng-h.lng);return void this._earth.setCenter(p)}e=Math.round(e)||0,t=Math.round(t)||0,Math.abs(e)<=this.width&&Math.abs(t)<=this.height&&!arguments[3]?this._panBy(e,t,{fps:arguments[2]}):this._panTo(e,t)},_panBy:function(e,t,i){if(1!=this.temp.operating){i=i||{},this.dispatchEvent(new aH("onmovestart"));var n=this,o=n.temp;o.pl=n.offsetX,o.pt=n.offsetY,o.tlPan&&o.tlPan.cancel(),o.dragAni&&(o.dragAni.stop(),o.dragAni=null,this.dispatchEvent(new aH("onmoveend"))),o.tlPan=new k({fps:i.fps||n.config.fps,duration:i.duration||n.config.actionDuration,transition:i.transition||W.easeInOutQuad,render:function(i){this.terminative=n.temp.operating,n.temp.operating||n._setPlatformPosition(o.pl+Math.ceil(e*i),o.pt+Math.ceil(t*i))},finish:function(){n.dispatchEvent(new aH("onmoveend")),n.temp.tlPan=!1,1==n.temp.stopArrow&&(n.temp.stopArrow=!1,0!=n.temp.arrow&&n._arrow())}})}},addControl:function(e){e&&x(e._i)&&(e._i(this),this.dispatchEvent(new aH("onaddcontrol",e)))},removeControl:function(e){e&&x(e.remove)&&(e.remove(),this.dispatchEvent(new aH("onremovecontrol",e)))},addContextMenu:function(e){e&&"contextmenu"==e._type&&"function"==typeof e.initialize&&(e.initialize(this),this.dispatchEvent(new aH("onaddcontextmenu",e)))},removeContextMenu:function(e){e&&"contextmenu"==e._type&&"function"==typeof e.remove&&(this.dispatchEvent(new aH("onremovecontextmenu",e)),e.remove())},addOverlay:function(e){if(e&&x(e._i)){e._i(this);var t=new aH("onaddoverlay",e);t.overlay=e,this.dispatchEvent(t)}},removeOverlay:function(e){if(e&&x(e.remove)){var t=new aH("onremoveoverlay",e);t.overlay=e,e.remove(),this.dispatchEvent(t)}},clearOverlays:function(){this.dispatchEvent(new aH("onclearoverlays"))},addTileLayer:function(e){for(var t=0;t<this.tileMgr.tileLayers.length;t++){var i=this.tileMgr.tileLayers[t];if(i==e||i.getMapType()==e.getMapType())return}e&&"tilelayer"==e._type&&x(e.initialize)&&(e.initialize(this),this.dispatchEvent(new aH("onaddtilelayer",e)))},removeTileLayer:function(e){e&&"tilelayer"==e._type&&x(e.remove)&&(e.remove(),this.dispatchEvent(new aH("onremovetilelayer",e)))},getTileLayer:function(e){return this.tileMgr?this.tileMgr.getTileLayer(e):null},setMapType:function(e){var t=this;if(this.mapType!==e&&!this._mapTypeChanging&&!(e===BMAP_EARTH_MAP&&!this.config.enableEarth||this._earth&&this._earth.getLock()))if(this._mapTypeChanging=!0,this.preMapType=this.mapType,this._boundsInPreMapType=this.getBounds(),this.preMapType===BMAP_SATELLITE_MAP&&(this._preStreetLayerShow=this._isHybridShow),e===BMAP_EARTH_MAP){if(!bO.Earth)return void bL.load("earth",function(){t._changeEarthMapType(e)});t._changeEarthMapType(e)}else this.preMapType!==BMAP_EARTH_MAP?(this._changeFlatMapType(e),this._mapTypeChanging=!1):this._setMapTypeStatus(e,function(i,n){var o=t._earth.getEarthCanvas();t._changeFlatMapType(e,this.preMapType),t._mapTypeChangAni&&t._mapTypeChangAni.stop(),t._mapTypeChangAni=bS.start({el:o,style:"opacity",startValue:1,endValue:0,duration:400,callback:function(){t._mapTypeChangAni=null,t._mapTypeChanging=!1}}),i=az.convertLL2MC(i),t.centerAndZoom(i,n)})},_changeFlatMapType:function(e){if(e&&bE[e]){var t=this.preMapType;this.mapType=e;var i=this.getTileLayer(t);i&&this.removeTileLayer(i);var n=new a1(-21364736,-10616832,23855104,15859712),o=new V(n,"baidu",e),a=new p({mapType:e,copyright:o});a.baseLayer=!0,a._isInnerLayer=!0,this.addTileLayer(a),t==BMAP_SATELLITE_MAP?(this._preStreetLayerShow=this._isHybridShow,this._removeHybirdMap()):e==BMAP_SATELLITE_MAP&&(this._preStreetLayerShow===!0||"undefined"==typeof this._preStreetLayerShow)&&this._addHybirdMap();for(var r=this.tileMgr.tileLayers,s=0,l=r.length;l>s;s++){var h=r[s].tilesDiv;"hidden"===h.style.visibility&&(h.style.visibility="")}var c=new aH("onmaptypechange");c.zoomLevel=this.zoomLevel,c.mapType=e,c.exMapType=t,this.dispatchEvent(c)}},showStreetLayer:function(e){e?this._addHybirdMap():this._removeHybirdMap()},_addHybirdMap:function(){if("B_EARTH_MAP"===this.mapType)return void this._earth.showStreetLayer();if(this._hybridTileLayer){this._isHybridShow=!0,this.addTileLayer(this._hybridTileLayer);var e=new aH("onstreetlayer_show");return void this.dispatchEvent(e)}var t=new a1(-21364736,-10616832,23855104,15859712),i=new V(t,"",BMAP_HYBRID_MAP),n=new p({copyright:i,transparentPng:!0});n._isInnerLayer=!0,n.getTilesUrl=function(e,t){var i=bE[BMAP_HYBRID_MAP];if("object"!=typeof i)return null;var n=i.baseUnits*Math.pow(2,i.zoomLevelBase-t),o=parseInt(e.lng/n),a=parseInt(e.lat/n),r="015";"undefined"!=typeof TVC&&(r=TVC.ditu.satelliteStreet.version);var s="20130501";"undefined"!=typeof TVC&&(s=TVC.ditu.satelliteStreet.updateDate);var l=i.tileUrls[Math.abs(o+a)%i.tileUrls.length]+"?qt=tile&x="+(o+"").replace(/-/gi,"M")+"&y="+(a+"").replace(/-/gi,"M")+"&z="+t+"&styles=sl"+(6==q.Browser.ie?"&color_dep=32&colors=50":"")+"&v="+r+"&udt="+s;return l},this._isHybridShow=!0,this.addTileLayer(n),this._hybridTileLayer=n;var e=new aH("onstreetlayer_show");this.dispatchEvent(e)},_removeHybirdMap:function(){if("B_EARTH_MAP"===this.mapType)return void this._earth.hideStreetLayer();if(this._hybridTileLayer){this._isHybridShow=!1,this.removeTileLayer(this._hybridTileLayer);var e=new aH("onstreetlayer_hide");this.dispatchEvent(e)}},isStreetLayerShow:function(){return"B_SATELLITE_MAP"===this.mapType?this._isHybridShow:"B_EARTH_MAP"===this.mapType?this._earth._streetLayerVisible:void 0},getTileId:function(e,t){var i=bE[this.mapType];if("object"!=typeof i)return null;var n=i.baseUnits*Math.pow(2,i.zoomLevelBase-t),o=parseInt(e.lng/n),a=parseInt(e.lat/n);return{row:o,column:a,level:t}},setCenter:function(e){this.panTo(e)},centerAndZoom:function(e,t){var i=this;if(e||t){if(e=e||this.centerPoint,t=t||this.zoomLevel,this.mapType===BMAP_EARTH_MAP){var n=az.convertMC2LL(e);if(this._earth){var o=this._earth._getEarthZoomByImgZoom(t,n);return void this._earth.centerAndZoom(n,o)}this.mapType=BMAP_NORMAL_MAP,this.temp.originMapType=BMAP_EARTH_MAP,bL.load("earth",function(){i._earth=new bO.Earth(i);i._proxyEarthEvents(),i._changeEarthMapType(BMAP_EARTH_MAP),delete i.temp.originMapType})}t=this._getProperZoom(t).zoom,this.lastLevel=this.zoomLevel||t,this.zoomLevel=t;var a=new aH("onload");if(a.point=e,a.zoom=t,this.centerPoint=new bl(e.lng,e.lat),this.defaultZoomLevel=this.defaultZoomLevel||this.zoomLevel,this.defaultCenter=this.defaultCenter||this.centerPoint,!this.loaded&&this.temp.originMapType!==BMAP_EARTH_MAP){var r=this.config.defaultMaxBounds,s=new V(r,"baidu",this.mapType),l=new p({mapType:this.mapType,copyright:s});l._isInnerLayer=!0,l.baseLayer=!0,this.addTileLayer(l),this.mapType===BMAP_SATELLITE_MAP&&this._isHybridShow===!0&&this._addHybirdMap()}this.dispatchEvent(a),this.loaded=!0}},reset:function(){this.centerAndZoom(this.defaultCenter,this.defaultZoomLevel,!0)},enableDragging:function(){this.config.enableDragging=!0},disableDragging:function(){this.config.enableDragging=!1},enableInertialDragging:function(){this.config.enableInertialDragging=!0},disableInertialDragging:function(){this.config.enableInertialDragging=!1},enableScrollWheelZoom:function(){this.config.enableWheelZoom=!0},disableScrollWheelZoom:function(){this.config.enableWheelZoom=!1},enableContinuousZoom:function(){this.config.enableContinuousZoom=!0},disableContinuousZoom:function(){this.config.enableContinuousZoom=!1},enableResizeOnCenter:function(){this.config.enableResizeOnCenter=!0},disableResizeOnCenter:function(){this.config.enableResizeOnCenter=!1},enableClickPan:function(e){this.config.enableClickPan=!!e},enableDoubleClickZoom:function(){this.config.enableDblclickZoom=!0},disableDoubleClickZoom:function(){this.config.enableDblclickZoom=!1},enableKeyboard:function(){this.config.enableKeyboard=!0},disableKeyboard:function(){this.config.enableKeyboard=!1},getSize:function(){var e=new af(this.container.clientWidth,this.container.clientHeight);return e},getCenter:function(){if(this.mapType===BMAP_EARTH_MAP){var e=this._earth.getCenter();return az.convertLL2MC(e)}var t=this.centerPoint;return t},getZoom:function(){return"B_EARTH_MAP"===this.mapType?this._earth.getImageZoom():this.zoomLevel},_getProperZoom:function(e){var t=this.config.zoomLevelMin,i=this.config.zoomLevelMax,n=!1;return t>e&&(n=!0,e=t),e>i&&(n=!0,e=i),{zoom:e,exceeded:n}},getContainer:function(){return this.container},getZoomUnits:function(e){if(this.mapType===BMAP_EARTH_MAP)return Math.pow(2,18-this._earth.getImageZoom());var t=bE[this.mapType];if("object"!=typeof t)return null;var i=e||this.zoomLevel;return Math.pow(2,t.zoomLevelBase-i)},pointToPixel:function(e,t){if(e){if(this.mapType==BMAP_EARTH_MAP){var i;e._llPt||(i=az.convertMC2LL(e),e._llPt=i),i=e._llPt;var n=this._earth.fromLatLngToPixel(i,{useRound:!1,isCalcOnBack:!0});return n}var o=this.getZoomUnits(t),a=Math.round((e.lng-this.centerPoint.lng)/o+this.width/2),r=Math.round((this.centerPoint.lat-e.lat)/o+this.height/2);return new aM(a,r)}},pixelToPoint:function(e,t){if(e){if(this.mapType==BMAP_EARTH_MAP){var i=this._earth.fromPixelToLatLng(e);return az.convertLL2MC(i)}var n=this.getZoomUnits(t),o=this.centerPoint.lng+n*(e.x-this.width/2),a=this.centerPoint.lat-n*(e.y-this.height/2),r=new bl(o,a);return r}},pointToOverlayPixel:function(e,t){var i=this.pointToPixel(e,t);if(i)return i.x-=this.offsetX,i.y-=this.offsetY,i},overlayPixelToPoint:function(e,t){if(e){var i=new aM(e.x,e.y);return i.x+=this.offsetX,i.y+=this.offsetY,this.pixelToPoint(i,t)}},lnglatToMercator:function(e,t){var i=new bl(t,e),n=az.convertLL2MC(i);return[n.lng,n.lat]},mercatorToLnglat:function(e,t){if(isNaN(e)||isNaN(t))return[];e=parseFloat(e),t=parseFloat(t);var i=new bl(e,t),n=az.convertMC2LL(i);return[n.lng,n.lat]},getBounds:function(){if(this.mapType===BMAP_EARTH_MAP){var e=this._earth.getCustomBounds();if(!e)return this.config.defaultMaxBounds;var t=e.getSouthWest(),i=e.getNorthEast();t.lng>i.lng&&(i.lng=180);var n=az.convertLL2MC(t),o=az.convertLL2MC(i),a=this.config.defaultMaxBounds,r=Math.max(n.lng,a.minX),s=Math.max(n.lat,a.minY),l=Math.min(o.lng,a.maxX),h=Math.min(o.lat,a.maxY);return new a1(r,s,l,h)}if(!this.isLoaded())return new a1;var c=arguments[0]||{},p=c.margins||[0,0,0,0],f=c.level||null,u=this.pixelToPoint({x:p[3],y:this.height-p[2]},f,!0),d=this.pixelToPoint({x:this.width-p[1],y:p[0]},f,!0);return this._bounds=new a1(u.lng,u.lat,d.lng,d.lat),this._bounds},setConfig:function(e){if(e)for(var t in e)this.config[t]=e[t]},isLoaded:function(){return!!this.loaded},_getBestLevel:function(e,t){var i=bE[this.mapType];if(!i)return this.getZoom();for(var n=t.margins||[10,10,10,10],o=t.zoomFactor||0,a=n[1]+n[3],r=n[0]+n[2],s=i.zoomLevelMin,l=i.zoomLevelMax,h=l;h>=s;h--){var c=this.getZoomUnits(h);if((e.maxX-e.minX)/c<=this.width-a&&(e.maxY-e.minY)/c<=this.height-r)break}return h+=o,s>h&&(h=s),h>l&&(h=l),h},getViewport:function(e,t){if(this.mapType===BMAP_EARTH_MAP){e=e||[];for(var i=[],n=0;n<e.length;n++)i.push(az.convertMC2LL(e[n]));var o=this._earth.getViewport(i,t),a=o.center,r=o.zoom,s=az.convertLL2MC(a);return{center:s,zoom:r}}var l={center:this.getCenter(),zoom:this.getZoom()};if(!e||0==e.length)return l;t=t||{};var h;if(e instanceof a1)h=e;else{var c=e;h=new a1;for(var n=c.length-1;n>=0;n--)h.extend(c[n]);if(h.isEmpty())return l}var p=h.getCenter(),f=this._getBestLevel(h,t);if(t.margins){var u=t.margins,d=(u[1]-u[3])/2,m=(u[0]-u[2])/2,g=this.getZoomUnits(f);p.lng=p.lng+g*d,p.lat=p.lat+g*m}return{center:p,zoom:f}},setViewport:function(e,t){if(this.mapType===BMAP_EARTH_MAP){var i;if(e&&e.center){var n=az.convertMC2LL(e.center),o=this._earth._getEarthZoomByImgZoom(e.zoom,n);i={center:n,zoom:o}}else{i=[];for(var a=0;a<e.length;a++){var r=az.convertMC2LL(e[a]);i[a]=new at(r.lat,r.lng)}}return void this._earth.setViewport(i,t)}var s;s=e&&e.center?e:this.getViewport(e,t),t=t||{};var l=t.delay||200;if(s.zoom==this.zoomLevel&&0!=t.enableAnimation){var h=this;setTimeout(function(){h.panTo(s.center,!1,210)},l)}else this.centerAndZoom(s.center,s.zoom)},addSpots:function(e,t){if(e&&0!=e.length){t=t||{};var i=t.zIndex||0,n="undefined"==typeof t.enableMultiResponse?!0:!!t.enableMultiResponse;this.spotsPool=this.spotsPool||{};var o="sp"+this.temp.spotsGuid++;this.spotsPool[o]={spots:e.slice(0),zIndex:i,enableMultiResponse:n};var a=this;return bL.load("hotspot",function(){a._asyncRegister()}),o}},getSpots:function(e){return this.spotsPool[e]&&this.spotsPool[e].spots||[]},removeSpots:function(e){e&&this.spotsPool[e]&&delete this.spotsPool[e]},clearSpots:function(){delete this.spotsPool},setBounds:function(e){bE[this.mapType].bounds=new a1(e.minX,e.minY,e.maxX,e.maxY)},getCoordType:function(){return this.config.coordType},getPanes:function(){return this._panes},getInfoWindow:function(){return this.temp.infoWin&&this.temp.infoWin.isOpen()?this.temp.infoWin:null},getDistance:function(e,t){if(e&&t){if(this.mapType===BMAP_EARTH_MAP){var i=az.convertMC2LL(e),n=az.convertMC2LL(t);return this._earth.getDistance(i,n)}var o=az.getDistanceByMC(e,t);return o}},getOverlays:function(){var e=[],t=this._overlays,i=this._customOverlays;if(t)for(var n in t)t[n]instanceof H&&e.push(t[n]);if(i)for(var n=0,o=i.length;o>n;n++)e.push(i[n]);return e},getMapType:function(){return this.mapType},_asyncRegister:function(){for(var e=this.temp.registerIndex;e<bO._register.length;e++)bO._register[e](this);this.temp.registerIndex=e},setDefaultCursor:function(e){this.config.defaultCursor=e,this.platform&&(this.platform.style.cursor=this.config.defaultCursor)},getDefaultCursor:function(){return this.config.defaultCursor},setDraggingCursor:function(e){this.config.draggingCursor=e},getDraggingCursor:function(){return this.config.draggingCursor},detectModernBrowser:function(){return 9==q.Browser.ie?!1:ad("transform")},_changeEarthMapType:function(e){var t=this,i=t.tileMgr.tileLayers;if(this._mapTypeChangAni&&this._mapTypeChangAni.stop(),this._earth){var n=this._earth.getEarthCanvas();n.style.opacity=1}if(this._earth||(this.maskLayer.style.opacity=1,this.maskLayer.style.zIndex=999,this.maskLayer.style.background="#000"),this._mapTypeChangAni=new k({duration:400,render:function(e){if(t._earth)for(var n=i.length-1,o=n;o>=0;o--){var a=i[o].tilesDiv;a&&(a.style.opacity=1-e)}},finish:function(){for(var n=i.length-1,o=n;o>=0;o--){var a=i[o].tilesDiv;a&&(a.style.opacity=1,a.style.visibility="hidden"),i[o]._isInnerLayer&&t.removeTileLayer(i[o])}if(t._mapTypeChangAni=null,t._mapTypeChanging=!1,!t._earth){var r=t.getZoom()-2,s=t.getCenter(),l=az.convertMC2LL(s);t._earth=new bO.Earth(t,{center:l,zoom:r}),t._proxyEarthEvents();var h=t.mapType;t.mapType=e;var c=new aH("onmaptypechange");c.zoomLevel=this.zoomLevel,c.mapType=e,c.exMapType=h,t.dispatchEvent(c),t._setMapTypeStatus(e),this._firstEarthAniShow||(bO.EarthAnimation.startFirstAnimation(t._earth),this._firstEarthAniShow=!0),setTimeout(function(){t.maskLayer.style.zIndex=9,t.maskLayer.style.opacity=0},1e3)}}}),this._earth){var o=this.mapType;this.mapType=e;var a=new aH("onmaptypechange");a.zoomLevel=this.zoomLevel,a.mapType=e,a.exMapType=o,this.dispatchEvent(a),t._setMapTypeStatus(e)}},_setMapTypeStatus:function(e){var t=arguments[1];if(e===BMAP_EARTH_MAP){var i=this._earth.getEarthCanvas();i.style.display="";var n={noAnimation:!0};this._earth.setCenter(az.convertMC2LL(this.centerPoint),n),this._earth.setImageZoom(this.zoomLevel,n)}else if(this.preMapType===BMAP_EARTH_MAP&&this._earth){var o=this._earth,a=o.getImageZoom(),r=o._imageRawZoom||a,s=r-a,l=o.getCenter();if(.1>s&&0===o.getTilt()&&0===o.getHeading())return void(t&&t(l,a));o.setTilt(0),o.setHeading(0),o.setZoom(o.getZoom()-s,{callback:function(){t&&t(l,a)}})}},_proxyEarthEvents:function(){var e=this,t=this._earth,i=!1;t.on("click",function(t){var i=t.pixel,n=e.pixelToPoint(i);t.point=n,e.fire(t)}),t.on("clickex",function(t){var i=t.pixel,n=e.pixelToPoint(i);t.point=n,e.fire(t)}),t.on("dblclick",function(t){var i=t.pixel,n=e.pixelToPoint(i);t.point=n,e.fire(t)}),t.on("movestart",function(t){i||e.fire(t)}),t.on("moveend",function(t){i||e.fire(t)}),t.on("zoomstart",function(t){e.fire(t)}),t.on("zoomend",function(t){e.fire(t)}),t.on("dragstart",function(t){i=!0,e.fire(t)}),t.on("dragend",function(t){i=!1,e.fire(t)}),t.on("mousemove",function(t){if(!i){var n=t.pixel,o=e.pixelToPoint(n);t.point=o,e.fire(t)}}),t.on("tilesload",function(t){e.fire(t)}),t.on("sunlighttime_change",function(t){e.fire(t)}),t.on("sunlighttime_clear",function(t){e.fire(t)}),t.on("centerandzoom",function(t){e.fire(t)})},startSunLightAnimation:function(){this.mapType===BMAP_EARTH_MAP&&this._earth.startSunLightAnimation()},forceEnableEarth:function(){return this.config.forceEnableEarth=!0,this.config.enableEarth=N(!0),this.dispatchEvent(new aH("forceenableearth")),this.config.enableEarth},stopSunLightAnimation:function(e){this.mapType===BMAP_EARTH_MAP&&this._earth.stopSunLightAnimation(e)},getLock:function(){return this.mapType===BMAP_EARTH_MAP?this._earth.getLock():void 0},getEarth:function(){return this._earth}}),window.BMAP_NORMAL_MAP="B_NORMAL_MAP",window.BMAP_SATELLITE_MAP="B_SATELLITE_MAP",window.BMAP_HYBRID_MAP="B_STREET_MAP",window.BMAP_EARTH_MAP="B_EARTH_MAP",window.BMAP_COORD_MERCATOR=1,window.BMAP_SYS_DRAWER=0,window.BMAP_SVG_DRAWER=1,window.BMAP_VML_DRAWER=2,window.BMAP_CANVAS_DRAWER=3;var bE={B_NORMAL_MAP:{tileUrls:["http://online1.map.bdimg.com/onlinelabel/","http://online2.map.bdimg.com/onlinelabel/","http://online3.map.bdimg.com/onlinelabel/"],tileSize:256,baseUnits:256,zoomLevelMin:3,zoomLevelMax:19,zoomLevelBase:18,errorUrl:bk.imgPath+"bg.png",bounds:new a1(-21364736,-11708041.66,23855104,12474104.17),imgExtend:"png"},B_SATELLITE_MAP:{tileUrls:["http://shangetu0.map.bdimg.com/it/","http://shangetu1.map.bdimg.com/it/","http://shangetu2.map.bdimg.com/it/"],tileSize:256,baseUnits:256,zoomLevelMin:3,zoomLevelMax:19,zoomLevelBase:18,errorUrl:bk.imgPath+"bg.png",bounds:new a1(-21364736,-10616832,23855104,15859712),imgExtend:"png"},B_STREET_MAP:{tileUrls:["http://online0.map.bdimg.com/onlinelabel/","http://online1.map.bdimg.com/onlinelabel/","http://online2.map.bdimg.com/onlinelabel/"],tileSize:256,baseUnits:256,zoomLevelMin:3,zoomLevelMax:19,zoomLevelBase:18,errorUrl:bk.imgPath+"bg.png",bounds:new a1(-21364736,-10616832,23855104,15859712),imgExtend:"png"},BMAP_CUSTOM_LAYER:{tileUrls:[""],tileSize:256,baseUnits:256,zoomLevelMin:1,zoomLevelMax:19,zoomLevelBase:18,errorUrl:bk.imgPath+"blank.gif",bounds:new a1(-21364736,-10616832,23855104,15859712),imgExtend:"png"},B_EARTH_MAP:{tileUrls:[""],tileSize:256,baseUnits:256,zoomLevelMin:3,zoomLevelMax:19,zoomLevelBase:18,errorUrl:bk.imgPath+"blank.gif",bounds:new a1(-21364736,-10616832,23855104,15859712),imgExtend:"png"}},bJ={request:function(e,t){var i=I("script",{src:e,type:"text/javascript",charset:"utf-8"});i.addEventListener?(i.addEventListener("load",function(e){var t=e.target;t.parentNode.removeChild(t)},!1),i.addEventListener("error",function(){t&&t([,,,,,])},!1)):i.attachEvent&&i.attachEvent("onreadystatechange",function(){var e=window.event.srcElement;!e||"loaded"!=e.readyState&&"complete"!=e.readyState||e.parentNode.removeChild(e)}),document.getElementsByTagName("head")[0].appendChild(i),i=null}},W={};k.prototype._doStart=function(){if(window.requestAnimationFrame){var e=this;e._timer=window.requestAnimationFrame(function(t){e._loop(t)})}else this._beginTime=(new Date).getTime(),this._endTime=this._beginTime+this._options.duration,this._loop()},k.prototype._loop=function(e){var t=this;if(e=e||(new Date).getTime(),this._beginTime||(this._beginTime=e,this._endTime=this._beginTime+this._options.duration),e>=t._endTime){"function"==typeof t._options.render&&t._options.render(t._options.transition(1),1),"function"==typeof t._options.finish&&t._options.finish();for(var i=0,n=t._callbacks.length;n>i;i++)t._callbacks[i]()}else{var o=(e-t._beginTime)/t._options.duration;t.schedule=t._options.transition(o),"function"==typeof t._options.render&&t._options.render(t.schedule,o),t.terminative||(t._timer=window.requestAnimationFrame?requestAnimationFrame(function(e){t._loop(e)}):setTimeout(function(){t._loop()},1e3/t._options.fps))}},k.prototype.stop=function(e,t){this.terminative=!0,this._timer&&(window.cancelAnimationFrame?cancelAnimationFrame(this._timer):clearTimeout(this._timer),this._timer=null,"function"==typeof this._options.onStop&&this._options.onStop(t)),e&&(this._endTime=this._beginTime,this._loop())},k.prototype.cancel=function(){this.stop()},k.prototype.append=function(e){return this._callbacks.push(e),this},W={_p1:1,_p2:1.525,linear:function(e){return e},reverse:function(e){return 1-e},easeInQuad:function(e){return e*e},easeInCubic:function(e){return Math.pow(e,3)},easeInBiquad:function(e){return Math.pow(e,4)},easeInBack:function(e){return e*e*((W._p1+1)*e-W._p1)},easeOutQuad:function(e){return-(e*(e-2))},easeOutCubic:function(e){return Math.pow(e-1,3)+1},easeOutBiquad:function(e){return 1-Math.pow(e-1,4)},easeOutBack:function(e){return(e-=1)*e*((W._p1+1)*e+W._p1)+1},easeInOutQuad:function(e){return.5>e?e*e*2:-2*(e-2)*e-1},easeInOutCubic:function(e){return.5>e?4*Math.pow(e,3):4*Math.pow(e-1,3)+1},easeInOutBiquad:function(e){return.5>e?8*Math.pow(e,4):1-8*Math.pow(e-1,4)},easeInOutSine:function(e){return(1-Math.cos(Math.PI*e))/2}},W["ease-in"]=W.easeInQuad,W["ease-out"]=W.easeOutQuad;var bS={start:function(e){var t=e.el,i=e.style,n=e.startValue,o=e.endValue,a=e.duration||1400,r=e.transition||W.linear,s=e.callback,l=o-n,h=e.unit||"";return new k({fps:60,duration:a,transition:r,render:function(e){t.style[i]=n+l*e+h},finish:function(){s&&s()}})}};q.extend(bL,{Request:{INITIAL:-1,WAITING:0,COMPLETED:1},Dependency:{control:[],marker:[],poly:["marker"],infowindow:["marker"],hotspot:["poly"],menu:[],tools:["marker","poly"],oppc:[],markeranimation:[],earth:[]},MD5Mapping:{control:"elfw52",marker:"xvxmq3",poly:"iglsrb",infowindow:"ree1bd",hotspot:"5umpzi",menu:"v0ub4u",tools:"ynojfi",oppc:"1e55r1",markeranimation:"ixgjoi",earth:"lfurff"},Config:{_baseUrl:"/?qt=getmodules&v=1.1&sample=newui",_timeout:5e3},delayFlag:!1,Module:{_modules:{},_arrMdls:[]},_getMd5ModsStr:function(e){for(var t=[],i=0,n=e.length;n>i;i++){var o=e[i],a=this.MD5Mapping[o],r="$"+o+"$";a!=r&&(strTemp=o+"_"+a,t.push(strTemp))}return t.join(",")},load:function(e,t,i){var n=this.current(e);if(n._status==this.Request.COMPLETED)return void(i&&t());if(n._status==this.Request.INITIAL){this.combine(e),this.pushUniqueMdl(e);var o=this;0==o.delayFlag&&(o.delayFlag=!0,setTimeout(function(){var e=o.Config._baseUrl+"&mod="+o._getMd5ModsStr(o.Module._arrMdls);bJ.request(e),o.Module._arrMdls.length=0,o.delayFlag=!1},1)),n._status=this.Request.WAITING}n._callbacks.push(t)},combine:function(e){if(e&&this.Dependency[e])for(var t=this.Dependency[e],i=0;i<t.length;i++)this.combine(t[i]),this.Module._modules[t[i]]||this.pushUniqueMdl(t[i])},pushUniqueMdl:function(e){for(var t=0;t<this.Module._arrMdls.length;t++)if(this.Module._arrMdls[t]==e)return;this.Module._arrMdls.push(e)},run:function(bW,bY){var bV=this.current(bW);try{eval(bY)}catch(bZ){return void console.log(bZ)}bV._status=this.Request.COMPLETED;for(var bX=0,bU=bV._callbacks.length;bU>bX;bX++)bV._callbacks[bX]();bV._callbacks.length=0},current:function(e){var t;return this.Module._modules[e]||(this.Module._modules[e]={},this.Module._modules[e]._status=this.Request.INITIAL,this.Module._modules[e]._callbacks=[]),t=this.Module._modules[e]},remove:function(e){var t=this.current(e);delete t}}),window._jsload=function(e,t){bL.run(e,t)},bu.inherits(aJ,"Control"),q.extend(bu.prototype,{initialize:function(e){return this._map=e,this._container?(e.container.appendChild(this._container),this._container):void 0},_i:function(e){!this._container&&this.initialize&&x(this.initialize)&&(this._container=this.initialize(e)),this._opts=this._opts||{printable:!1},this._setStyle(),this._setPosition(),this._container&&(this._container._jsobj=this)},_setStyle:function(){var e=this._container;if(e){var t=e.style;t.position="absolute",t.zIndex=this._cZIndex||"10",t.MozUserSelect="none",this._opts.printable||q.ac(e,"BMap_noprint"),q.on(e,"contextmenu",bt)}},remove:function(){this._map=null,this._container&&(this._container.parentNode&&this._container.parentNode.removeChild(this._container),this._container._jsobj=null,this._container=null)},_render:function(){return this._container=T(this._map.container,"<div unselectable='on'></div>"),0==this._visible&&(this._container.style.display="none"),this._container},_setPosition:function(){this.setAnchor(this._opts.anchor)},setAnchor:function(e){(this.anchorFixed||"number"!=typeof e||isNaN(e)||BMAP_ANCHOR_TOP_LEFT>e||e>BMAP_ANCHOR_BOTTOM_RIGHT)&&(e=this.defaultAnchor),this._opts.offset=this._opts.offset||this.defaultOffset;var t=this._opts.anchor;if(this._opts.anchor=e,this._container){var i=this._container,n=this._opts.offset.width,o=this._opts.offset.height;switch(i.style.left=i.style.top=i.style.right=i.style.bottom="auto",e){case BMAP_ANCHOR_TOP_LEFT:i.style.top=o+"px",i.style.left=n+"px";break;case BMAP_ANCHOR_TOP_RIGHT:i.style.top=o+"px",i.style.right=n+"px";break;case BMAP_ANCHOR_BOTTOM_LEFT:i.style.bottom=o+"px",i.style.left=n+"px";break;case BMAP_ANCHOR_BOTTOM_RIGHT:i.style.bottom=o+"px",i.style.right=n+"px"}var a=["TL","TR","BL","BR"];q.rc(this._container,"anchor"+a[t]),q.ac(this._container,"anchor"+a[e])}},getAnchor:function(){return this._opts.anchor},setOffset:function(e){!e||e&&"Size"!=e.toString()||(this._opts.offset=new af(e.width,e.height),this._container&&this.setAnchor(this._opts.anchor))},getOffset:function(){return this._opts.offset},getDom:function(){return this._container},show:function(){1!=this._visible&&(this._visible=!0,this._container&&(this._container.style.display=""),this.dispatchEvent(new aH("onshow")))},hide:function(){0!=this._visible&&(this._visible=!1,this._container&&(this._container.style.display="none"),this.dispatchEvent(new aH("onhide")))},isPrintable:function(){return!!this._opts.printable},isVisible:function(){return this._container||this._map?!!this._visible:!1}}),window.BMAP_ANCHOR_TOP_LEFT=0,window.BMAP_ANCHOR_TOP_RIGHT=1,window.BMAP_ANCHOR_BOTTOM_LEFT=2,window.BMAP_ANCHOR_BOTTOM_RIGHT=3,Q.inherits(bu,"CopyrightControl"),q.extend(Q.prototype,{initialize:function(e){return this._map=e,this._container},addCopyright:function(e){var t={minZoom:0,bounds:null,content:"",mapType:""};for(var i in e)t[i]=e[i];if(this._map){var n=t.minZoom;(-1===n||n<bE[this._map.mapType].zoomLevelMin||n>bE[this._map.mapType].zoomLevelMax)&&(t.minZoom=bE[this._map.mapType].zoomLevelMin),""===t.mapType||bE[t.mapType]||(t.mapType=BMAP_NORMAL_MAP)
}var o=this.getCopyright(e.id);if(o)for(var a in t)o[a]=t[a];else this._copyrightCollection.push(t)},getCopyright:function(e){for(var t=0,i=this._copyrightCollection.length;i>t;t++)if(this._copyrightCollection[t].id===e)return this._copyrightCollection[t]},_asyncLoadCode:function(){var e=this;bL.load("control",function(){e._asyncDraw()})},addSateMapStyle:function(){this.sateMapStyle=!0,this._container&&q.ac(this._container,"BMap_cpyCtrl_w")},removeSateMapStyle:function(){this.sateMapStyle=!1,this._container&&q.rc(this._container,"BMap_cpyCtrl_w")}}),window.BMAP_UNIT_METRIC="metric",window.BMAP_UNIT_IMPERIAL="us",a0.inherits(bu,"ScaleControl"),q.extend(a0.prototype,{initialize:function(e){return this._map=e,this._container},setColor:function(e){this._opts.color=e+""},getColor:function(){return this._opts.color},setUnit:function(e){this._opts.unit=this._units[e]&&this._units[e].name||this._opts.unit},getUnit:function(){return this._opts.unit},_asyncLoadCode:function(){var e=this;bL.load("control",function(){e._asyncDraw()})},addSateMapStyle:function(){this.sateMapStyle=!0;var e=this._container;e&&(q.ac(e,"BMap_scaleCtrl_sate"),e.children[0].style.color="#FFF")},removeSateMapStyle:function(){this.sateMapStyle=!1;var e=this._container;e&&(q.rc(e,"BMap_scaleCtrl_sate"),e.children[0].style.color="#000")}}),window.BMAP_NAVIGATION_CONTROL_LARGE=0,window.BMAP_NAVIGATION_CONTROL_SMALL=1,window.BMAP_NAVIGATION_CONTROL_PAN=2,window.BMAP_NAVIGATION_CONTROL_ZOOM=3,window.BMAP_NAVIGATION_CONTROL_ANIM=4,B.inherits(bu,"NavigationControl"),q.extend(B.prototype,{initialize:function(e){return this._map=e,this._container},setType:function(e){this._opts.type="number"==typeof e&&e>=BMAP_NAVIGATION_CONTROL_LARGE&&BMAP_NAVIGATION_CONTROL_ANIM>=e?e:BMAP_NAVIGATION_CONTROL_LARGE},getType:function(){return this._opts.type},_asyncLoadCode:function(){var e=this;bL.load("control",function(){e._asyncDraw()})}}),ak.inherits(bu,"MapTypeControl"),q.extend(ak.prototype,{initialize:function(e){return this._map=e,this._container},showStreetLayer:function(e){this._map.showStreetLayer(e)}}),bK.inherits(aJ,"ContextMenu"),q.extend(bK.prototype,{initialize:function(e){this._map=e},remove:function(){this._map=null},addItem:function(e){if(e&&"menuitem"==e._type&&""!=e._text&&!(e._width<=0)){for(var t=0,i=this._items.length;i>t;t++)if(this._items[t]===e)return;this._items.push(e),this._rItems.push(e)}},removeItem:function(e){if(e&&"menuitem"==e._type){for(var t=0,i=this._items.length;i>t;t++)this._items[t]===e&&(this._items[t].remove(),this._items.splice(t,1),i--);for(var t=0,i=this._rItems.length;i>t;t++)this._rItems[t]===e&&(this._rItems[t].remove(),this._rItems.splice(t,1),i--)}},addSeparator:function(){this._items.push({_type:"divider",_dIndex:this._dividers.length}),this._dividers.push({dom:null})},removeSeparator:function(e){if(this._dividers[e]){for(var t=0,i=this._items.length;i>t;t++)this._items[t]&&"divider"==this._items[t]._type&&this._items[t]._dIndex==e&&(this._items.splice(t,1),i--),this._items[t]&&"divider"==this._items[t]._type&&this._items[t]._dIndex>e&&this._items[t]._dIndex--;this._dividers.splice(e,1)}},getDom:function(){return this._container},show:function(){1!=this._isOpen&&(this._isOpen=!0)},hide:function(){0!=this._isOpen&&(this._isOpen=!1)},setCursor:function(e){e&&(this._opts.cursor=e)},getItem:function(e){return this._rItems[e]},enable:function(){this._enable=!0},disable:function(){this._enable=!1}}),aG.inherits(aJ,"MenuItem"),q.extend(aG.prototype,{initialize:function(e,t){this._map=e,this._contextmenu=t},remove:function(){this._contextmenu=null,this._map=null},setText:function(e){e&&(this._text=e+"")},getDom:function(){return this._container},enable:function(){this._enabled=!0},disable:function(){this._enabled=!1}}),q.extend(a1.prototype,{isEmpty:function(){var e="number";return typeof this.minX!=e||typeof this.minY!=e||typeof this.maxX!=e||typeof this.maxY!=e},equals:function(e){return e&&"Bounds"==e.toString()?this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY:void 0},getMaxX:function(){return this.maxX},getMaxY:function(){return this.maxY},getMinX:function(){return this.minX},getMinY:function(){return this.minY},containsBounds:function(e){return e&&"Bounds"==e.toString()?e.minX>this.minX&&e.maxX<this.maxX&&e.minY>this.minY&&e.maxY<this.maxY:void 0},getCenterPoint:function(){return new bl((this.minX+this.maxX)/2,(this.minY+this.maxY)/2)},getCenter:function(){return this.getCenterPoint()},intersects:function(e){if(e&&"Bounds"==e.toString()){if(Math.max(e.minX,e.maxX)<Math.min(this.minX,this.maxX)||Math.min(e.minX,e.maxX)>Math.max(this.minX,this.maxX)||Math.max(e.minY,e.maxY)<Math.min(this.minY,this.maxY)||Math.min(e.minY,e.maxY)>Math.max(this.minY,this.maxY))return null;var t=Math.max(this.minX,e.minX),i=Math.min(this.maxX,e.maxX),n=Math.max(this.minY,e.minY),o=Math.min(this.maxY,e.maxY);return new a1(t,n,i,o)}},containsPoint:function(e){return e&&"Point"==e.toString()?e.lng>=this.minX&&e.lng<=this.maxX&&e.lat>=this.minY&&e.lat<=this.maxY:void 0},extend:function(e){if(e&&"Point"==e.toString()){var t=e.lng,i=e.lat;(!this.minX||this.minX>t)&&(this.minX=t),(!this.maxX||this.maxX<t)&&(this.maxX=t),(!this.minY||this.minY>i)&&(this.minY=i),(!this.maxY||this.maxY<i)&&(this.maxY=i)}},getIntersectLine:function(e){if(e&&"Line"==e.toString()){var t=e.sPoint,i=e.ePoint,n=[];if(t.lat==i.lat){if(t.lng==i.lng)return null;t.lat>this.minY&&t.lat<this.maxY;var e=new Line(n.lng,n.lat);return e}}},getMin:function(){return new bl(this.minX,this.minY)},getMax:function(){return new bl(this.maxX,this.maxY)},toString:function(){return"Bounds"}});var ax=bl.prototype;ax.equals=function(e){return e&&"Point"==e.toString()?this.lat==e.lat&&this.lng==e.lng:void 0},ax.toString=function(){return"Point"},q.extend(az,{EARTHRADIUS:6370996.81,MCBAND:[12890594.86,8362377.87,5591021,3481989.83,1678043.12,0],LLBAND:[75,60,45,30,15,0],MC2LL:[[1.410526172116255e-8,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,17337981.2],[-7.435856389565537e-9,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,10260144.86],[-3.030883460898826e-8,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,6856817.37],[-1.981981304930552e-8,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,4482777.06],[3.09191371068437e-9,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,2555164.4],[2.890871144776878e-9,8983055095805407e-21,-3.068298e-8,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],LL2MC:[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,647795574.6671607,-4082003173.641316,10774905663.51142,-15171875531.51559,12053065338.62167,-5124939663.577472,913311935.9512032,67.5],[.00337398766765,111320.7020202162,4481351.045890365,-23393751.19931662,79682215.47186455,-115964993.2797253,97236711.15602145,-43661946.33752821,8477230.501135234,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837.749470245,992013.7397791013,-1221952.21711287,1340652.697009075,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758.690035394,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],getDistanceByMC:function(e,t){if(!e||!t)return 0;var i,n,o,a;return(e=this.convertMC2LL(e))?(i=L(e.lng),n=L(e.lat),(t=this.convertMC2LL(t))?(o=L(t.lng),a=L(t.lat),this.getDistance(i,o,n,a)):0):0},getDistanceByLL:function(e,t){if(!e||!t)return 0;e.lng=this.getLoop(e.lng,-180,180),e.lat=this.getRange(e.lat,-74,74),t.lng=this.getLoop(t.lng,-180,180),t.lat=this.getRange(t.lat,-74,74);var i,n,o,a;return i=L(e.lng),o=L(e.lat),n=L(t.lng),a=L(t.lat),this.getDistance(i,n,o,a)},convertMC2LL:function(e){if(!e)return new bl(0,0);var t,i;t=new bl(Math.abs(e.lng),Math.abs(e.lat));for(var n=0;n<this.MCBAND.length;n++)if(t.lat>=this.MCBAND[n]){i=this.MC2LL[n];break}var o=this.convertor(e,i);return new at(o.lat,o.lng)},convertLL2MC:function(e){if(!e)return new at(0,0);for(var t,i=0;i<this.LLBAND.length;i++)if(e.lat>=this.LLBAND[i]){t=this.LL2MC[i];break}if(!t)for(i=this.LLBAND.length-1;i>=0;i--)if(e.lat<=-this.LLBAND[i]){t=this.LL2MC[i];break}var n=new bl(e.lng,e.lat),o=this.convertor(n,t);return new bl(o.lng,o.lat)},convertor:function(e,t){if(e&&t){var i=t[0]+t[1]*Math.abs(e.lng),n=Math.abs(e.lat)/t[9],o=t[2]+t[3]*n+t[4]*n*n+t[5]*n*n*n+t[6]*n*n*n*n+t[7]*n*n*n*n*n+t[8]*n*n*n*n*n*n;return i*=e.lng<0?-1:1,o*=e.lat<0?-1:1,new bl(i,o)}},getDistance:function(e,t,i,n){return this.EARTHRADIUS*Math.acos(Math.sin(i)*Math.sin(n)+Math.cos(i)*Math.cos(n)*Math.cos(t-e))},getRange:function(e,t,i){return null!=t&&(e=Math.max(e,t)),null!=i&&(e=Math.min(e,i)),e},getLoop:function(e,t,i){for(;e>i;)e-=i-t;for(;t>e;)e+=i-t;return e}}),q.extend(at.prototype,{equals:function(e){return this.lat===e.lat&&this.lng===e.lng},clone:function(){return new at(this.lat,this.lng)},getLngSpan:function(e){var t=this.lng,i=Math.abs(e-t);return i>180&&(i=360-i),i},sub:function(e){return new at(this.lat-e.lat,this.lng-e.lng)},toString:function(){return this.lat+", "+this.lng}}),q.extend(X.prototype,{isEmpty:function(){return!this._sw||!this._ne},equals:function(e){return this.isEmpty()?!1:this.getSouthWest().equals(e.getSouthWest())&&this.getNorthEast().equals(e.getNorthEast())},getSouthWest:function(){return this._sw},getNorthEast:function(){return this._ne},containsBounds:function(e){return this.isEmpty()||e.isEmpty()?!1:e._swLng>this._swLng&&e._neLng<this._neLng&&e._swLat>this._swLat&&e._neLat<this._neLat},getCenter:function(){return this.isEmpty()?null:new at((this._swLat+this._neLat)/2,(this._swLng+this._neLng)/2)},intersects:function(e){if(Math.max(e._swLng,e._neLng)<Math.min(this._swLng,this._neLng)||Math.min(e._swLng,e._neLng)>Math.max(this._swLng,this._neLng)||Math.max(e._swLat,e._neLat)<Math.min(this._swLat,this._neLat)||Math.min(e._swLat,e._neLat)>Math.max(this._swLat,this._neLat))return!1;var t=Math.max(this._swLng,e._swLng),i=Math.min(this._neLng,e._neLng),n=Math.max(this._swLat,e._swLat),o=Math.min(this._neLat,e._neLat);return this._sw=new at(n,t),this._ne=new at(o,i),this._swLng=t,this._swLat=n,this._neLng=i,this._neLat=o,!0},containsPoint:function(e){return this.isEmpty()?!1:e.lng>=this._swLng&&e.lng<=this._neLng&&e.lat>=this._swLat&&e.lat<=this._neLat},extend:function(e){var t=e.lng,i=e.lat;this._sw||(this._sw=new at(0,0)),this._ne||(this._ne=new at(0,0)),(!this._swLng||this._swLng>t)&&(this._sw.lng=this._swLng=t),(!this._neLng||this._neLng<t)&&(this._ne.lng=this._neLng=t),(!this._swLat||this._swLat>i)&&(this._sw.lat=this._swLat=i),(!this._neLat||this._neLat<i)&&(this._ne.lat=this._neLat=i)},toSpan:function(){return this.isEmpty()?new at(0,0):new at(Math.abs(this._neLat-this._swLat),Math.abs(this._neLng-this._swLng))},union:function(e){if(e.isEmpty())return!1;var t=e.getSouthWest(),i=e.getNorthEast();return this._swLat>t.lat&&(this._swLat=t.lat),this._swLng>t.lng&&(this._swLng=t.lng),this._neLat<i.lat&&(this._neLat=i.lat),this._neLng<i.lng&&(this._neLng=i.lng),this._sw=new at(this._swLat,this._swLng),this._ne=new at(this._neLat,this._neLng),!0},toString:function(){return this._swLat+", "+this._swLng+", "+this._neLat+", "+this._neLng}});var aI={undo:1,redo:2,zoom:4,drag:8,move:16,mousewheel:32,toolbarOperation:64,stdMapCtrlDrag:128,dblclick:256},g={_map:null,_html:"<div class='BMap_opMask' unselectable='on'></div>",_maskElement:null,_cursor:"default",inUse:!1,show:function(e){this._map||(this._map=e),this.inUse=!0,this._maskElement||this._createMask(e),this._maskElement.style.display="block"},_createMask:function(e){if(this._map||(this._map=e),this._map){var t=this._maskElement=T(this._map.container,this._html);q.on(t,"mouseup",function(e){2==e.button&&bt(e)}),q.on(t,"contextmenu",bt),t.style.display="none"}},getDrawPoint:function(e,t,i){e=window.event||e;var n=e.offsetX||e.layerX||0,o=parseInt(e.offsetY)||parseInt(e.layerY)||0,a=e.target||e.srcElement;if(a!=g.getDom(this._map)&&1==t)for(;a&&a!=this._map.container;)0==a.clientWidth&&0==a.clientHeight&&a.offsetParent&&"td"==a.offsetParent.nodeName.toLowerCase()||(n+=a.offsetLeft,o+=a.offsetTop),a=a.offsetParent;return a!=g.getDom(this._map)&&a!=this._map.container||"undefined"==typeof n||"undefined"==typeof o||isNaN(n)||isNaN(o)?void 0:(i&&(n+=i.x,o+=i.y),this._map.pixelToPoint(new aM(n,o)))},hide:function(){this._map&&(this.inUse=!1,this._maskElement&&(this._maskElement.style.display="none"))},getDom:function(e){return this._maskElement||this._createMask(e),this._maskElement},setCursor:function(e){this._cursor=e||"default",this._maskElement&&(this._maskElement.style.cursor=this._cursor)}};aT.inherits(q.BaseClass,"Overlay"),aT.getZIndex=function(e,t){return(e=1*e)?(t&&(e=az.convertMC2LL(new bO.Point(0,e)).lat),-1e5*e<<1):0},q.extend(aT.prototype,{_i:function(e){!this.domElement&&x(this.initialize)&&(this.domElement=this.initialize(e),this.domElement&&(this.domElement.style.WebkitUserSelect="none")),this.draw()},initialize:function(){throw"initialize方法未实现"},draw:function(){throw"draw方法未实现"},remove:function(){this.domElement&&this.domElement.parentNode&&this.domElement.parentNode.removeChild(this.domElement),this.domElement=null,this.dispatchEvent(new aH("onremove"))},hide:function(){q.hide(this.domElement)},show:function(){q.show(this.domElement)},dispose:function(){q.BaseClass.prototype.decontrol.call(this)}}),H.inherits(aT,"OverlayInternal"),q.extend(H.prototype,{initialize:function(e){return this.map=e,q.BaseClass.call(this,this.hashCode),null},draw:function(){},remove:function(){this.map=null,this.decontrol(),aT.prototype.remove.call(this)},hide:function(){0!=this._visible&&(this._visible=!1)},show:function(){1!=this._visible&&(this._visible=!0)},getDom:function(){return this.domElement},setConfig:function(e){e=e||{};for(var t in e)typeof this._config[t]==typeof e[t]&&(this._config[t]=e[t])},getPoint:function(e,t){if(!e)return this.point;var i=t?t.width:0,n=t?t.height:0;if(this.map){var o=this.map.pointToPixel(this.point);return this._config&&this._config.offset?(o.x=o.x+this._config.offset.width+i,o.y=o.y+this._config.offset.height+n):(o.x=o.x+i,o.y=o.y+n),this.map.pixelToPoint(o)}},setZIndex:function(e){this.zIndex=e},isVisible:function(){return this.domElement?!!this._visible:!1},enableMassClear:function(){this._config.enableMassClear=!0},disableMassClear:function(){this._config.enableMassClear=!1}}),bC.prototype._init=function(){this._createOverlayContainers(),this._bind()},bC.prototype._createOverlayContainers=function(){var e=this.map;e.temp.overlayDiv=e.overlayDiv=this._createOverlayDiv(e.platform,200),e._panes.floatPane=this._createOverlayDiv(e.temp.overlayDiv,800),e._panes.markerMouseTarget=this._createOverlayDiv(e.temp.overlayDiv,700),e._panes.floatShadow=this._createOverlayDiv(e.temp.overlayDiv,600),e._panes.labelPane=this._createOverlayDiv(e.temp.overlayDiv,500),e._panes.markerPane=this._createOverlayDiv(e.temp.overlayDiv,400),e._panes.mapPane=this._createOverlayDiv(e.temp.overlayDiv,200)},bC.prototype._createOverlayDiv=function(e,t){var i=I("div"),n=i.style;return n.position="absolute",n.top=n.left=n.width=n.height="0",n.zIndex=t,e.appendChild(i),i},bC.prototype._bind=function(){var e=this.map,t=this;e.addEventListener("load",function(e){t.draw(e)}),e.addEventListener("moveend",function(e){t.draw(e)}),e.addEventListener("resize",function(i){e.config.enableResizeOnCenter&&t.draw(i)}),q.Browser.ie&&q.Browser.ie<8||"BackCompat"===document.compatMode?e.addEventListener("zoomend",function(e){setTimeout(function(){t.draw(e)},20)}):(e.addEventListener("zoomend",function(e){t.draw(e),"B_EARTH_MAP"===this.mapType&&(this._earth.getZoom()<2?this.temp.overlayDiv.style.display="none":"none"===this.temp.overlayDiv.style.display&&(this.temp.overlayDiv.style.display="",this.temp.infoWin&&this.temp.infoWin.isOpen()&&this.temp.infoWin.redraw()))}),e.addEventListener("oncenterandzoom",function(e){t.draw(e),"B_EARTH_MAP"===this.mapType&&(this._earth.getZoom()<2?this.temp.overlayDiv.style.display="none":"none"===this.temp.overlayDiv.style.display&&(this.temp.overlayDiv.style.display="",this.temp.infoWin&&this.temp.infoWin.isOpen()&&this.temp.infoWin.redraw()))})),e.addEventListener("maptypechange",function(e){"B_EARTH_MAP"===this.mapType?(this._panes.mapPane.style.display="none",this._earth.getZoom()<2?this.temp.overlayDiv.style.display="none":"none"===this.temp.overlayDiv.style.display&&(this.temp.overlayDiv.style.display="",this.temp.infoWin&&this.temp.infoWin.isOpen()&&this.temp.infoWin.redraw())):(this._panes.mapPane.style.display="","none"===this.temp.overlayDiv.style.display&&(this.temp.overlayDiv.style.display="",this.temp.infoWin&&this.temp.infoWin.isOpen()&&this.temp.infoWin.redraw())),t.draw(e)}),e.on("earthstatuschange",function(){t.draw()}),e.addEventListener("addoverlay",function(e){var i=e.target;if(i instanceof H)t._overlays[i.hashCode]||(t._overlays[i.hashCode]=i);else{for(var n=!1,o=0,a=t._customOverlays.length;a>o;o++)if(t._customOverlays[o]===i){n=!0;break}n||t._customOverlays.push(i)}}),e.addEventListener("removeoverlay",function(e){var i=e.target;if(i instanceof H)delete t._overlays[i.hashCode];else for(var n=0,o=t._customOverlays.length;o>n;n++)if(t._customOverlays[n]===i){t._customOverlays.splice(n,1);break}}),e.addEventListener("clearoverlays",function(){this.closeInfoWindow();for(var e in t._overlays)t._overlays[e]._config.enableMassClear&&(t._overlays[e].remove(),delete t._overlays[e]);for(var i=0,n=t._customOverlays.length;n>i;i++)t._customOverlays[i].enableMassClear!==!1&&(t._customOverlays[i].remove(),t._customOverlays[i]=null,t._customOverlays.splice(i,1),i--,n--)}),e.addEventListener("infowindowopen",function(){var e=this.infoWindow;e&&(q.hide(e.popDom),q.hide(e.shadowDom))}),e.addEventListener("movestart",function(){this.getInfoWindow()&&this.getInfoWindow()._setOverflow()}),e.addEventListener("moveend",function(){this.getInfoWindow()&&this.getInfoWindow()._resetOverflow()})},bC.prototype.draw=function(){if("B_EARTH_MAP"===this.map.getMapType())for(var e in this._overlays)this._overlays[e]instanceof bP!=!0&&this._overlays[e].draw();else for(var e in this._overlays)this._overlays[e].draw();if(q.each(this._customOverlays,function(e){e.draw()}),this.map.temp.infoWin&&this.map.temp.infoWin.setPosition(),bO.DrawerSelector&&"B_EARTH_MAP"!==this.map.getMapType()){var t=bO.DrawerSelector.getDrawer(this.map);t.setPalette()}},bO.register(function(e){new bC(e)}),bP.inherits(H,"Graph"),bP.getGraphPoints=function(e){var t=[];if(!e||0===e.length)return t;if("string"==typeof e){var i=e.split(";");q.each(i,function(e){var i=e.split(",");t.push(new bl(i[0],i[1]))})}return e.constructor==Array&&e.length>0&&(t=e),t},bP.parseTolerance={0:[.09,.005,1e-4,1e-5],1:[9e3,500,10,1]},q.extend(bP.prototype,{initialize:function(e){return this.map=e,null},draw:function(){},setPoints:function(e){this._parseCache.length=0,this.points=bP.getGraphPoints(e).slice(0),this._calcBounds()},_calcBounds:function(){if(this.points){var e=this;e._bounds=new a1,q.each(this.points,function(t){e._bounds.extend(t)})}},getPoints:function(){return this.points},setPointAt:function(e,t){t&&this.points[e]&&(this._parseCache.length=0,this.points[e]=new bl(t.lng,t.lat),this._calcBounds())},setStrokeColor:function(e){this._config.strokeColor=e},getStrokeColor:function(){return this._config.strokeColor},setStrokeLineCap:function(e){this._config.strokeLineCap=e},getStrokeLineCap:function(){return this._config.strokeLineCap},setStrokeLineJoin:function(e){this._config.strokeLineJoin=e},getStrokeLineJoin:function(){return this._config.strokeLineJoin},setStrokeWeight:function(e){e>0&&(this._config.strokeWeight=e)},getStrokeWeight:function(){return this._config.strokeWeight},setStrokeOpacity:function(e){!e||e>1||0>e||(this._config.strokeOpacity=e)},getStrokeOpacity:function(){return this._config.strokeOpacity},setFillOpacity:function(e){e>1||0>e||(this._config.fillOpacity=e)},getFillOpacity:function(){return this._config.fillOpacity},setStrokeStyle:function(e){("solid"==e||"dashed"==e||"dotted"==e)&&(this._config.strokeStyle=e)},getStrokeStyle:function(){return this._config.strokeStyle},setFillColor:function(e){this._config.fillColor=e||""},getFillColor:function(){return this._config.fillColor},getBounds:function(){return this._bounds},remove:function(){this.map&&this.map.removeEventListener("onmousemove",this._graphMouseEvent),H.prototype.remove.call(this),this._parseCache.length=0},enableEditing:function(){this._config.enableEditing=!0},disableEditing:function(){this._config.enableEditing=!1},getParsedPoints:function(){var e,t=this.map,i=this.getParseCacheIndex(t.getZoom());if(this._parseCache[i])e=this._parseCache[i];else{var n=bn(this.points,this.getParseTolerance(t.getZoom(),t.config.coordType));e=this._parseCache[i]=n}return[e]}}),q.Browser.ie&&document.namespaces&&!document.namespaces.olv&&document.namespaces.add("olv","urn:schemas-microsoft-com:vml"),o.inherits(H,"Division"),q.extend(o.prototype,{_addDom:function(){var e=this._config,t=this.content,i=['<div class="BMap_Division" style="position:absolute;'];i.push("width:"+e.width+"px;display:block;"),i.push("overflow:hidden;"),"none"!=e.borderColor&&i.push("border:"+e.lineStroke+"px "+e.lineStyle+" "+e.lineColor+";"),i.push("opacity:"+e.opacity+"; filter:(opacity="+100*e.opacity+")"),i.push("background:"+e.background+";"),i.push('z-index:60;">'),i.push(t),i.push("</div>"),this.domElement=T(this.map.getPanes().markerMouseTarget,i.join(""))},initialize:function(e){return this.map=e,this._addDom(),this.domElement&&q.on(this.domElement,"mousedown",function(e){al(e)}),this.domElement},draw:function(){var e=this.map.pointToOverlayPixel(this._config.point);this._config.offset=new af(-Math.round(this._config.width/2)-Math.round(this._config.lineStroke),-Math.round(this._config.height/2)-Math.round(this._config.lineStroke)),this.domElement.style.left=e.x+this._config.offset.width+"px",this.domElement.style.top=e.y+this._config.offset.height+"px"},getPoint:function(){return this._config.point},_getPixel:function(){return this.map.pointToPixel(this.getPoint())},setPoint:function(e){this._config.point=e,this.draw()},setDimension:function(e,t){this._config.width=Math.round(e),this._config.height=Math.round(t),this.domElement&&(this.domElement.style.width=this._config.width+"px",this.domElement.style.height=this._config.height+"px",this.draw())}});var aR=C.prototype;aR.setImageUrl=function(e){e&&(this.imageUrl=e)},aR.setPrintImageUrl=function(e){e&&(this.printImageUrl=e)},aR.setSize=function(e){e&&(this.size=new af(e.width,e.height))},aR.setOffset=function(e){e&&(this.offset=new af(e.width,e.height))},aR.setImageOffset=function(e){e&&(this.imageOffset=new af(e.width,e.height))},aR.setInfoWindowOffset=function(e){e&&(this.infoWindowOffset=new af(e.width,e.height))},aR.toString=function(){return"Icon"},aR.setImageSize=function(e){e&&(this.imageSize=new af(e.width,e.height))},aR.setImageSrcset=function(e){var t="";if(e){for(var i in e)e.hasOwnProperty(i)&&(t=e[i]+" "+i+",");this.srcSet=t}},a2.inherits(q.BaseClass,"InfoWindow"),q.extend(a2.prototype,{setWidth:function(e){e=1*e,!e&&0!=e||isNaN(e)||0>e||(0!=e&&(220>e&&(e=220),e>730&&(e=730)),this._config.width=e)},setHeight:function(e){e=1*e,!e&&0!=e||isNaN(e)||0>e||(0!=e&&(60>e&&(e=60),e>650&&(e=650)),this._config.height=e)},setMaxWidth:function(e){e=1*e,!e&&0!=e||isNaN(e)||0>e||(0!=e&&(220>e&&(e=220),e>730&&(e=730)),this._config.maxWidth=e)},setTitle:function(e){this._config.title=e||""},setContent:function(e){this.content=e||""},setMaxContent:function(e){this._config.maxContent=e||""},redraw:function(){},enableAutoPan:function(){this._config.enableAutoPan=!0},disableAutoPan:function(){this._config.enableAutoPan=!1},enableCloseOnClick:function(){this._config.enableCloseOnClick=!0},disableCloseOnClick:function(){this._config.enableCloseOnClick=!1},enableMaximize:function(){this._config.enableMaximize=!0},disableMaximize:function(){this._config.enableMaximize=!1},show:function(){this._visible=!0},hide:function(){this._visible=!1},close:function(){this.hide()},dispose:function(){q.BaseClass.prototype.decontrol.call(this)},maximize:function(){this.isWinMax=!0},restore:function(){this.isWinMax=!1},setConfig:function(e){if(e)for(var t in e)typeof this._config[t]==typeof e[t]&&(this._config[t]=e[t])},isVisible:function(){return this.isOpen()},isOpen:function(){return!1},getPoint:function(){return this.overlay&&this.overlay.getPoint?this.overlay.getPoint():void 0},getOffset:function(){return this._config.offset},dispose:function(){q.BaseClass.prototype.decontrol.call(this)},toString:function(){return"InfoWindow"}}),aO.prototype.openInfoWindow=function(e,t){if(e&&"InfoWindow"==e.toString()&&t&&"Point"==t.toString()){var i=this.temp;if(i.marker)i.marker.setPoint(t);else{var n=new C(bk.imgPath+"blank.gif",{width:1,height:1});i.marker=new K(t,{icon:n,width:1,height:1,offset:new af(0,0),infoWindowOffset:new af(0,0),clickable:!1}),i.marker._fromMap=1}this.addOverlay(i.marker),i.marker.show(),i.marker.openInfoWindow(e)}},aO.prototype.closeInfoWindow=function(){var e=this.temp.infoWin||this.temp._infoWin;e&&e.overlay&&e.overlay.closeInfoWindow()},H.prototype.openInfoWindow=function(e){this.map&&(this.map.closeInfoWindow(),e._visible=!0,this.map.temp._infoWin=e,e.overlay=this,q.BaseClass.call(e,e.hashCode))},H.prototype.closeInfoWindow=function(){this.map&&this.map.temp._infoWin&&(this.map.temp._infoWin._visible=!1,this.map.temp._infoWin.decontrol(),this.map.temp._infoWin=null)},M.inherits(H,"Label"),q.extend(M.prototype,{setPoint:function(e){e&&"Point"==e.toString()&&!this.getMarker()&&(this.point=this._config.point=new bl(e.lng,e.lat))},setContent:function(e){this.content=e},setOpacity:function(e){e>=0&&1>=e&&(this._config.opacity=e)},setOffset:function(e){e&&"Size"==e.toString()&&(this._config.offset=new af(e.width,e.height))},getOffset:function(){return this._config.offset},setStyle:function(e){e=e||{},this._config.styles=q.extend(this._config.styles,e)},setStyles:function(e){return this.setStyle(e)},setTitle:function(e){this._config.title=e||""},getTitle:function(){return this._config.title},setMarker:function(e){this._marker=e,this.point=this._config.point=e?e.getPoint():null},getMarker:function(){return this._marker||null}}),window.BMAP_ANIMATION_DROP=1,window.BMAP_ANIMATION_BOUNCE=2,K.TOP_ZINDEX=aT.getZIndex(-90)+1e6,K.DRAG_ZINDEX=K.TOP_ZINDEX+1e6,K.inherits(H,"Marker"),q.extend(K.prototype,{setIcon:function(e){e&&"Icon"==e.toString()&&(this._config.icon=e)},getIcon:function(){return this._config.icon},setLabel:function(e){e&&"Label"==e.toString()&&(this._config.label=e)},getLabel:function(){return this._config.label},enableDragging:function(){this._config.enableDragging=!0},disableDragging:function(){this._config.enableDragging=!1},setPoint:function(e){e&&"Point"==e.toString()&&(this.point=this._config.point=new bl(e.lng,e.lat))},setTop:function(e,t){this._config.isTop=!!e,e&&(this._addi=t||0)},setTitle:function(e){this._config.title=e},getTitle:function(){return this._config.title||""},setOffset:function(e){e&&"Size"==e.toString()&&(this._config.offset=e)},getOffset:function(){return this._config.offset},setAnimation:function(e){this._animation=e}}),j.inherits(bP,"Polyline"),ae.inherits(j,"PolylineMultipart"),q.extend(ae.prototype,{setPoints:function(e){this._parseCache.length=0;var t=[];e&&e.constructor===Array&&(q.each(e,function(e){t.push(bP.getGraphPoints(e))}),this.points=t,this._calcBounds())},_calcBounds:function(){if(this.points){var e=this;e._bounds=new a1,q.each(this.points,function(t){q.each(t,function(t){e._bounds.extend(t)})})}}}),bs.inherits(bP,"Polygon"),q.extend(bs.prototype,{setPoints:function(e,t){this._userPoints=bP.getGraphPoints(e).slice(0);var i=bP.getGraphPoints(e).slice(0);i.length>1&&!i[0].equals(i[i.length-1])&&i.push(new bl(i[0].lng,i[0].lat)),bP.prototype.setPoints.call(this,i,t)},setPointAt:function(e,t){this._userPoints[e]&&(this._userPoints[e]=new bl(t.lng,t.lat),this.points[e]=new bl(t.lng,t.lat),0!=e||this.points[0].equals(this.points[this.points.length-1])||(this.points[this.points.length-1]=new bl(t.lng,t.lat)),this._calcBounds())},getPoints:function(){var e=this._userPoints;return 0==e.length&&(e=this.points),e}}),a.parseTolerance={0:[.01,1e-4,1e-5,4e-6],1:[1e3,10,1,.4]},a.inherits(bs,"Circle"),q.extend(a.prototype,{initialize:function(e){return this.map=e,this.points=this._getPerimeterPoints(this.point,this.radius),this._calcBounds(),null},getPoint:function(){return this.point},getCenter:function(){return this.point},setPoint:function(e){e&&(this.point=e)},setCenter:function(e,t){this.setPoint(e,t)},getRadius:function(){return this.radius},setRadius:function(e){this.radius=Math.abs(e)},_getPerimeterPoints:function(e,t){if(!e||!t||!this.map)return[];var i=(this.map,e.lng),n=e.lat,o=az.convertMC2LL(e);i=o.lng,n=o.lat;for(var a=[],r=t/6370996.81,s=Math.PI/180*n,l=Math.PI/180*i,h=0;360>h;h+=9){var c=Math.PI/180*h,p=Math.asin(Math.sin(s)*Math.cos(r)+Math.cos(s)*Math.sin(r)*Math.cos(c)),f=Math.atan2(Math.sin(c)*Math.sin(r)*Math.cos(s),Math.cos(r)-Math.sin(s)*Math.sin(p)),u=(l-f+Math.PI)%(2*Math.PI)-Math.PI,d=new at(p*(180/Math.PI),u*(180/Math.PI));a.push(az.convertLL2MC(d))}var m=a[0];return a.push(new bl(m.lng,m.lat)),a}}),bh.inherits(bs,"Rectangle"),q.extend(bh.prototype,{setPoints:function(e){if(e){var t=e[0],i=e[1];if(t&&i&&"Point"==t.toString()&&"Point"==i.toString()){var n=t,o=i,a=new bl(n.lng,o.lat),r=new bl(o.lng,n.lat),s=t;this.points=[n,a,o,r,s],this._calcBounds()}}},getPoints:function(){return[this.points[0],this.points[2]]}});var bg={};aM.prototype.equals=function(e){return e?e.x==this.x&&e.y==this.y:!1},aM.prototype.toString=function(){return"Pixel"},af.prototype.equals=function(e){return!(!e||this.width!=e.width||this.height!=e.height)},af.prototype.toString=function(){return"Size"},a8.prototype._addLoadCbk=function(e){this._cbks.push(e)},a8.prototype._load=function(){this.img.src=FeBrowser.ie<=6&&FeBrowser.ie>0&&this._transparentPng?bk.imgPath+"blank.gif":this.src},a8.prototype._callCbks=function(){for(var e=this,t=0;t<e._cbks.length;t++)e._cbks[t]();e._cbks.length=0};var v=!q.Browser.ie||q.Browser.ie>8;bO.register(function(e){var t=e.tileMgr=new a4(e);e.addEventListener("dragstart",function(e){t.dragStart(e)}),e.addEventListener("dragend",function(e){t.dragEnd(e)}),e.addEventListener("click",function(e){t.click(e)}),e.addEventListener("mousewheel",function(e){t.mouseWheel(e)}),e.addEventListener("dblclick",function(e){t.dblClick(e)}),e.addEventListener("rightdblclick",function(e){t.dblClick(e)}),e.addEventListener("minuspress",function(e){t.keypress(e)}),e.addEventListener("pluspress",function(e){t.keypress(e)}),e.addEventListener("load",function(){this.mapType!==BMAP_EARTH_MAP&&t.loadTiles()}),e.addEventListener("zoomstartcode",function(e){this.mapType!==BMAP_EARTH_MAP&&t._zoom(e)}),e.addEventListener("moving",function(e){this.mapType!==BMAP_EARTH_MAP&&t.mend(e)}),e.addEventListener("resize",function(e){this.mapType!==BMAP_EARTH_MAP&&t.resizeMap(e)}),e.addEventListener("addtilelayer",function(e){t.addTileLayer(e)}),e.addEventListener("removetilelayer",function(e){t.removeTileLayer(e)})}),q.extend(a4.prototype,{addTileLayer:function(e){var t=this,i=e.target;
t.tileLayers.push(i),t.moveGridTiles()},removeTileLayer:function(e){var t=this,i=e.target,n=i.mapType,o=t.mapTiles,a=t.bufferTiles;for(var r in a){var s=r.split("-")[1];s==n&&delete a[r]}for(var r in o){var s=r.split("-")[1];s==n&&delete o[r]}t.zoomsDiv&&t.zoomsDiv.parentNode&&(t.zoomsDiv.parentNode.removeChild(t.zoomsDiv),t.zoomsDiv.innerHTML="");var l=t.map;if(l.deepZoom){var h=l.deepZoom.preDeepZoomDiv;h&&h.parentNode&&h.parentNode.removeChild(h)}for(var c=0,p=t.tileLayers.length;p>c;c++)i==t.tileLayers[c]&&t.tileLayers.splice(c,1);t.moveGridTiles()},hideDeepZoomDiv:function(){var e=this,t=e.map;if(t.deepZoom){var i=t.deepZoom.preDeepZoomDiv;i&&"none"!=i.style.display&&(i.style.display="none")}},getTileLayer:function(e){for(var t=this,i=0,n=t.tileLayers.length;n>i;i++)if(tilelayer=t.tileLayers[i],tilelayer.mapType==e)return tilelayer;return null},mend:function(){this.moveGridTiles()},_zoom:function(){var e=this;e.zoomsDiv&&"none"!=e.zoomsDiv.style.display&&(e.zoomsDiv.style.display="none"),e.hideDeepZoomDiv(),setTimeout(function(){e.moveGridTiles(),e.map.dispatchEvent(new aH("onzoomend"))},10)},resizeMap:function(){this.loaded=!1,this.moveGridTiles()},_checkTilesLoaded:function(){this.numLoading--;var e=this;0==this.numLoading&&(this._checkLoadedTimer&&(clearTimeout(this._checkLoadedTimer),this._checkLoadedTimer=null),this._checkLoadedTimer=setTimeout(function(){0==e.numLoading&&e.map.dispatchEvent(new aH("ontilesloaded")),e._checkLoadedTimer=null},80))},getTileName:function(e,t){var i=t.mapType,n="TILE-"+i+"-"+e[0]+"-"+e[1]+"-"+e[2];return n},hideTile:function(e,i){var n=e.img;t(n)&&(e.loaded&&this.imgNumber--,n.parentNode&&(z(n),n.parentNode.removeChild(n)));var o=new aH("onimagechange");o.tile=this.getTileName(e.info,i),o.action="hide",delete this.mapTiles[e.name],e.loaded||(z(n),e._callCbks(),n=null,e.img=null,e.mgr=null),this.map.dispatchEvent(o)},loadTiles:function(){var e=this;if(q.Browser.ie)try{document.execCommand("BackgroundImageCache",!1,!0)}catch(t){}this.zoomsDiv&&"none"!=this.zoomsDiv.style.display&&(this.zoomsDiv.style.display="none"),e.hideDeepZoomDiv(),e.moveGridTiles()},getCell:function(e,t){var i=this.baseUnits*Math.pow(2,this.baseZoomLevel-t),n=parseInt(e.lng/i),o=parseInt(e.lat/i);return[n,o,i*(n+.5),i*(o+.5)]},calcLoopParam:function(e,t){for(var i=0,n=3,o=6,a=o*Math.pow(2,t-n),r=a/2-1,s=-a/2;e>r;)e-=a,i-=this._loopOffset;for(;s>e;)e+=a,i+=this._loopOffset;return i=Math.round(i/Math.pow(2,18-t)),{offsetX:i,col:e}},calcLoopCenterPoint:function(e){for(var t=e.lng;t>this._mc180X;)t-=this._mcTSpan;for(;t<this._mcM180X;)t+=this._mcTSpan;return e.lng=t,e},calcLoopTiles:function(e,t){for(var i=256*Math.pow(2,18-t),n=Math.floor(this._mc180X/i),o=Math.floor(this._mcM180X/i),a=Math.floor(this._loopOffset/i),r=[],s=0;s<e.length;s++){var l=e[s],h=l[0],c=l[1];if(h>=n){var p=h+a,f="id_"+p+"_"+c+"_"+t;e[f]||(e[f]=!0,r.push([p,c]))}else if(o>=h){var p=h-a,f="id_"+p+"_"+c+"_"+t;e[f]||(e[f]=!0,r.push([p,c]))}}for(var s=0;s<r.length;s++)e.push(r[s]);return e},moveGridTiles:function(){var e=this.map,t=e.getMapType(),i=this.tileLayers.length,n=e.centerPoint;t!==BMAP_SATELLITE_MAP&&(n=this.calcLoopCenterPoint(n));for(var o=0;i>o;o++){var a=this.tileLayers[o];(a.baseLayer||1==i)&&(this.tilesDiv=a.tilesDiv);var r=bE[a.mapType],s=e.zoomLevel,l=e.getZoomUnits(e.zoomLevel),h=r.baseUnits*Math.pow(2,r.zoomLevelBase-s),c=parseInt(n.lng/h);n.lng<0&&(c-=1);var p=parseInt(n.lat/h);n.lat<0&&(p-=1);var f=r.tileSize,u=[c,p,(n.lng-c*h)/h*f,(n.lat-p*h)/h*f],d=e.width/2*1.5,m=u[0]-Math.ceil((d-u[2])/f),g=u[1]-Math.ceil((e.height/2-u[3])/f),_=u[0]+Math.ceil((d+u[2])/f),v=u[1]+Math.ceil((e.height/2+u[3])/f),y=[];this.imgTotalNumber=0;for(var b=m;_>b;b++)for(var w=g;v>w;w++){y.push([b,w]);var M="id_"+b+"_"+w+"_"+s;y[M]=!0,this.imgTotalNumber++}a.mapType!==BMAP_SATELLITE_MAP&&(y=this.calcLoopTiles(y,s)),y.sort(function(e){return function(t,i){return.4*Math.abs(t[0]-e[0])+.6*Math.abs(t[1]-e[1])-(.4*Math.abs(i[0]-e[0])+.6*Math.abs(i[1]-e[1]))}}([u[0],u[1]]));var x=this.mapTiles,L=-n.lng/l,T=n.lat/l,P=[Math.round(L),Math.round(T)];for(var C in x){var A=x[C],E=A.info;if(E){var M="id_"+E[0]+"_"+E[1]+"_"+E[2];y[M]||this.hideTile(A,a)}}var O=-e.offsetX+e.width/2,S=-e.offsetY+e.height/2;if(a.tilesDiv.style.left=Math.round(L+O)-P[0]+"px",a.tilesDiv.style.top=Math.round(T+S)-P[1]+"px",!this.map.enableLoadTiles)return;this.numLoading+=y.length;for(var b=0,z=y.length;z>b;b++)this.showTile([y[b][0],y[b][1],e.zoomLevel],P,a,b)}},showTile:function(e,t,i,n){this.centerPos=t;var o=bE[i.mapType],a=this.getTileName(e,i),r=e[0]*o.tileSize+t[0],s=(-1-e[1])*o.tileSize+t[1],l=[r,s];if(i.mapType!==BMAP_SATELLITE_MAP){var h=this.calcLoopParam(e[0],e[2]).offsetX;l[0]+=h,l._offsetX=h}var c=this,p=this.mapTiles[a];if(p)return aV(p.img,l),void(p.loaded?this._checkTilesLoaded():p._addLoadCbk(function(){c._checkTilesLoaded()}));if(p=this.bufferTiles[a]){this.imgNumber++,i.tilesDiv.insertBefore(p.img,i.tilesDiv.lastChild),this.mapTiles[a]=p,aV(p.img,l),p.loaded?this._checkTilesLoaded():p._addLoadCbk(function(){c._checkTilesLoaded()});var f=new aH("onimagechange");f.action="cache",f.tile=this.getTileName(e,i),this.map.dispatchEvent(f)}else{var u=o.baseUnits*Math.pow(2,o.zoomLevelBase-e[2]),d=new bl(e[0]*u,e[1]*u),m=i.getTilesUrl(d,e[2]);if(p=new a8(this,m,l,e,i),p._addLoadCbk(function(){c._checkTilesLoaded()}),0===n&&(i.mapType==window.BMAP_NORMAL_MAP||i.opts.requestMonitor)){var g=(new Date).getTime();p._addLoadCbk(function(){var e=(new Date).getTime(),t=e-g,n={value:t,detail:m,unique:!0};p.error?(n.type="fail",n.subvalue="fail"):t>=2e3?(n.type="slow",n.subvalue=4e3>t?"req_slow2":6e3>t?"req_slow4":"req_slow6"):(n.type="succ",n.subvalue="succ");var o="tile",a=.02;i.mapType!==window.BMAP_NORMAL_MAP&&i.opts.monitorOpts&&(o=i.opts.monitorOpts.name||"tile",a=i.opts.monitorOpts.seed||.02),bO.Utils.ErrorMonitor(o,a,n)})}p._load(),this.mapTiles[a]=p}},dragStart:function(){this.temp.pps={x:this.map.offsetX,y:this.map.offsetY}},dragEnd:function(){this.temp.ppe={x:this.map.offsetX,y:this.map.offsetY},(q.Platform.iphone||q.Platform.ipad||q.Platform.android)&&(this.zoomsDiv&&"none"!=this.zoomsDiv.style.display&&(this.zoomsDiv.style.display="none"),this.hideDeepZoomDiv())},click:function(e){if(this.map.config.enableClickPan){var t=this.temp;(0==this.map.currentOperation&&!t.ppe&&!t.pps||t.ppe&&t.pps&&t.ppe.x-t.pps.x==0&&t.ppe.y-t.pps.y==0)&&this.map.panBy(this.map.width/2-e.offsetX,this.map.height/2-e.offsetY),t.pps=null,t.ppe=null}},mouseWheel:function(e){var t=this.map;if(t.config.enableWheelZoom){var i=t.zoomLevel+(1==e.trend?1:-1),n=t._getProperZoom(i);if(n.exceeded){var o=new aH("onzoomexceeded");return o.targetZoom=i,void t.dispatchEvent(o)}t.dispatchEvent(new aH("onzoomstart")),t.lastLevel=t.zoomLevel,t.zoomLevel=n.zoom;var a=e.pixel,r=t.pixelToPoint(a,t.lastLevel,!0),s=t.getZoomUnits(t.zoomLevel);t.centerPoint=new bl(r.lng+s*(t.width/2-a.x),r.lat-s*(t.height/2-a.y)),this.zoom(a)}},dblClick:function(e){var t=this.map;if(t.config.enableDblclickZoom&&"B_EARTH_MAP"!==t.mapType){var i=e.pixel,n=t.pixelToPoint(i,null,!0),o=1,a=i,r=new af(0,0);"onrightdblclick"==e.type&&(o=-1);var s=t.zoomLevel+o,l=t._getProperZoom(s);if(l.exceeded){var h=new aH("onzoomexceeded");h.targetZoom=s,t.dispatchEvent(h)}else{t.dispatchEvent(new aH("onzoomstart"));var c=t.deepZoom;if(c)c.zoomMap(a,r,o,o);else{t.lastLevel=t.zoomLevel,t.zoomLevel=l.zoom;var p=t.getZoomUnits(t.zoomLevel);t.centerPoint=new bl(n.lng+p*(t.width/2-i.x),n.lat-p*(t.height/2-i.y)),this.zoom(i)}}}},keypress:function(e){var t=this.map;if(!t.config.enableContinuousZoom)return void("onpluspress"==e.type?t.zoomIn():t.zoomOut());if(!this._zTimeLine){var i=t.deepZoom;if(i){var n="onpluspress"==e.type?1:-1;t.deepZoomMedia(n)}else{var o=t.zoomLevel+("onpluspress"==e.type?1:-1),a=t._getProperZoom(o);if(a.exceeded){var r=new aH("onzoomexceeded");return r.targetZoom=o,void t.dispatchEvent(r)}t.dispatchEvent(new aH("onzoomstart"));var s=new aM(t.width/2,t.height/2);if(t.lastLevel=t.zoomLevel,t.zoomLevel=a.zoom,t.getInfoWindow()){s=t.pointToPixel(t.getInfoWindow().getPoint(),t.lastLevel);var l=t.pixelToPoint(s,t.lastLevel,!0),h=t.getZoomUnits(t.zoomLevel);t.centerPoint=new bl(l.lng+h*(t.width/2-s.x),l.lat-h*(t.height/2-s.y))}this.zoom(s)}}}}),p.inherits(aJ,"TileLayer"),q.extend(p.prototype,{isTransparentPng:function(){return this.transparentPng},getTilesUrl:function(e,t){var i=bE[this.mapType];if("object"!=typeof i)return null;var n=i.baseUnits*Math.pow(2,i.zoomLevelBase-t),o=parseInt(e.lng/n)-this.offset[0],a=parseInt(e.lat/n-this.offset[1]);if(this.mapType!==BMAP_SATELLITE_MAP)var o=this.map.tileMgr.calcLoopParam(o,t).col;var r="";if(this.opts.tileUrlTemplate)r=this.opts.tileUrlTemplate,r=r.replace(/\{X\}/,o),r=r.replace(/\{Y\}/,a),r=r.replace(/\{Z\}/,t);else{if(this.mapType==BMAP_NORMAL_MAP){var s="015";"undefined"!=typeof TVC&&(s=TVC.ditu.normal.version);var l="20130501";"undefined"!=typeof TVC&&(l=TVC.ditu.normal.updateDate),r=i.tileUrls[Math.abs(o+a)%i.tileUrls.length]+"?qt=tile&x="+o+"&y="+a+"&z="+t+"&styles=pl&udt="+l+"&scaler="+this.scaler,r=r.replace(/-(\d+)/gi,"M$1")}if(this.mapType==BMAP_SATELLITE_MAP){var s="009";"undefined"!=typeof TVC&&(s=TVC.ditu.satellite.version);var l="20130501";"undefined"!=typeof TVC&&(l=TVC.ditu.satellite.updateDate),r=i.tileUrls[Math.abs(o+a)%i.tileUrls.length]+"u=x="+o+";y="+a+";z="+t+";v="+s+";type=sate&fm=46&udt="+l,r=r.replace(/-(\d+)/gi,"M$1")}}return r},initialize:function(e){e.temp.layerZIndex||(e.temp.layerZIndex=0),this.zIndex=this.zIndex||-1,this.baseLayer&&(this.zIndex=-1),e.temp.layid||(e.temp.layid=0),this.opts.mapType?this.mapType=this.opts.mapType:(this.mapType="BMAP_CUSTOM_LAYER_"+e.temp.layid,e.temp.layid++);var t=bE[this.mapType];t||(bE[this.mapType]={tileUrls:[],tileSize:256,baseUnits:256,zoomLevelMin:1,zoomLevelMax:19,zoomLevelBase:18,errorUrl:bk.imgPath+"/blank.gif",bounds:new a1(-21364736,-10616832,23855104,15859712),imgExtend:"png"});var i=T(e.platform,'<div style="position:absolute;z-index:'+this.zIndex+'"></div>');i.style.display="",i.style.left=Math.ceil(-e.offsetX+e.width/2)+"px",i.style.top=Math.ceil(-e.offsetY+e.height/2)+"px",this.tilesDiv=i,this.map=e},remove:function(){this.tilesDiv&&this.tilesDiv.parentNode&&(this.tilesDiv.innerHTML="",this.tilesDiv.parentNode.removeChild(this.tilesDiv)),delete this.tilesDiv},getCopyright:function(){return this.copyright},getMapType:function(){return this.mapType},setZIndex:function(e){this.zIndex=e,this.tilesDiv&&(this.tilesDiv.style.zIndex=e)}}),V.inherits(aJ,"Copyright"),w.inherits(aJ,"ToolbarItem"),q.extend(w.prototype,{open:function(){return 1==this._isOpen?!0:this._map._toolInUse?!1:(this._map._toolInUse=!0,this._isOpen=!0,!0)},close:function(){this._isOpen&&(this._map._toolInUse=!1,this._isOpen=!1)},_checkStr:function(e){return e?e.replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}}),aX.inherits(w,"PolylineTItem"),q.extend(aX.prototype,{setLineColor:function(e){this._opts.lineColor=e},setLineStroke:function(e){Math.round(e)>0&&(this._opts.lineStroke=Math.round(e))},setOpacity:function(e){e>=0&&1>=e&&(this._opts.opacity=e)},setLineStyle:function(e){("solid"==e||"dashed"==e)&&(this._opts.lineStyle=e)},clear:function(){for(var e=0,t=this._overlays.length;t>e;e++)this._overlays[e]&&this._map.removeOverlay(this._overlays[e]);this._overlays.length=0;for(var e=0,t=this._dots.length;t>e;e++)this._dots[e]&&this._dots[e].parentNode&&this._dots[e].parentNode.removeChild(this._dots[e]);this._dots.length=0},setCursor:function(e){1==this._opts.showResult||(this._opts.cursor=e)},getCursor:function(){if(1==this._opts.showResult)return this._dCursor;var e=this._opts.cursor.match(/^url\((.+)\)(,.*)?/);return null!=e?e[1]:this._opts.cursor},showResult:function(e){this._opts.showResult=!!e},toString:function(){return"DistanceTool"}});var bm="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";!function(e){e||(e=window.BMap={}),e.Utils||(e.Utils={});var t=e.Utils;t.format=function(){function e(e,t,i){var n=i[+t];return"function"==typeof n?n(t):n}function t(e,t,i){var n=t,o=[],a=t.split(":");2===a.length&&(n=a[0],o.push(a[1]));var r=typeof i[n];return"function"===r?i[n].apply(void 0,o):"undefined"===r?e:String(i[n])}return function(i,n){var o=n.splice?e:t,a=i.splice?i.join(""):i;return a.replace(/{([a-zA-Z0-9_$:.]+)}/g,function(e,t){return o(e,t,n)})}}(),t.IE={getAlphaFilterCSS:function(e,i){return t.format("progid:DXImageTransform.Microsoft.AlphaImageLoader(src='{src}',{method});",{src:e,method:i?"sizingMethod="+i.toString():""})},fixPNGs:function(e,i,n){if(e){n=n||{};var o=e.length,a=null;if(0!==o)for(var r=0;o>r;++r)a=e[r],a.style.cssText="FILTER:"+t.IE.getAlphaFilterCSS(a.src,n.sizingMethod||"crop")+a.style.cssText,a.src=i}}},t.isAncestor=function(e,t,i){var n=!1;if(i&&e===t)return!0;if(e.constains)return e.constains(t);if(e.compareDocumentPosition)return n=!!(16&e.compareDocumentPosition(t));for(;(t=t.parentNode)&&!n;)n=e===t||n;return!0};var i={};t.ErrorMonitor=function(e,t,n){var o=Math.floor(.001*(new Date).getTime());n=n||{};var a=t;if("succ"==n.type&&(a=.01*t),"map.baidu.com"==location.host&&Math.random()<a){if(n.unique){if(i[e])return;i[e]=!0}var r="http://log.map.baidu.com/tn.gif?module="+e+"&time="+o+"&value="+n.value+"&detail="+encodeURIComponent(n.detail)+"&subtype="+n.type+"&subvalue="+n.subvalue+"&represent="+a,s=new Image;s.src=r}}}(bO),function(e){Array.prototype.map||(Array.prototype.map=function(e,t){var i,n,o;if(null==this)throw new TypeError(" this is null or not defined");var a=Object(this),r=a.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(t&&(i=t),n=Array(r),o=0;r>o;){var s,l;o in a&&(s=a[o],l=e.call(i,s,o,a),n[o]=l),o++}return n});var t=e.detect=function(){var e=function(){},t={browser_parsers:[{regex:"^(Opera)/(\\d+)\\.(\\d+) \\(Nintendo Wii",family_replacement:"Wii",manufacturer:"Nintendo"},{regex:"(SeaMonkey|Camino)/(\\d+)\\.(\\d+)\\.?([ab]?\\d+[a-z]*)",family_replacement:"Camino",other:!0},{regex:"(Pale[Mm]oon)/(\\d+)\\.(\\d+)\\.?(\\d+)?",family_replacement:"Pale Moon (Firefox Variant)",other:!0},{regex:"(Fennec)/(\\d+)\\.(\\d+)\\.?([ab]?\\d+[a-z]*)",family_replacement:"Firefox Mobile"},{regex:"(Fennec)/(\\d+)\\.(\\d+)(pre)",family_replacment:"Firefox Mobile"},{regex:"(Fennec)/(\\d+)\\.(\\d+)",family_replacement:"Firefox Mobile"},{regex:"Mobile.*(Firefox)/(\\d+)\\.(\\d+)",family_replacement:"Firefox Mobile"},{regex:"(Namoroka|Shiretoko|Minefield)/(\\d+)\\.(\\d+)\\.(\\d+(?:pre)?)",family_replacement:"Firefox ($1)"},{regex:"(Firefox)/(\\d+)\\.(\\d+)(a\\d+[a-z]*)",family_replacement:"Firefox Alpha"},{regex:"(Firefox)/(\\d+)\\.(\\d+)(b\\d+[a-z]*)",family_replacement:"Firefox Beta"},{regex:"(Firefox)-(?:\\d+\\.\\d+)?/(\\d+)\\.(\\d+)(a\\d+[a-z]*)",family_replacement:"Firefox Alpha"},{regex:"(Firefox)-(?:\\d+\\.\\d+)?/(\\d+)\\.(\\d+)(b\\d+[a-z]*)",family_replacement:"Firefox Beta"},{regex:"(Namoroka|Shiretoko|Minefield)/(\\d+)\\.(\\d+)([ab]\\d+[a-z]*)?",family_replacement:"Firefox ($1)"},{regex:"(Firefox).*Tablet browser (\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"MicroB",tablet:!0},{regex:"(MozillaDeveloperPreview)/(\\d+)\\.(\\d+)([ab]\\d+[a-z]*)?"},{regex:"(Flock)/(\\d+)\\.(\\d+)(b\\d+?)",family_replacement:"Flock",other:!0},{regex:"(RockMelt)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Rockmelt",other:!0},{regex:"(Navigator)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Netscape"},{regex:"(Navigator)/(\\d+)\\.(\\d+)([ab]\\d+)",family_replacement:"Netscape"},{regex:"(Netscape6)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Netscape"},{regex:"(MyIBrow)/(\\d+)\\.(\\d+)",family_replacement:"My Internet Browser",other:!0},{regex:"(Opera Tablet).*Version/(\\d+)\\.(\\d+)(?:\\.(\\d+))?",family_replacement:"Opera Tablet",tablet:!0},{regex:"(Opera)/.+Opera Mobi.+Version/(\\d+)\\.(\\d+)",family_replacement:"Opera Mobile"},{regex:"Opera Mobi",family_replacement:"Opera Mobile"},{regex:"(Opera Mini)/(\\d+)\\.(\\d+)",family_replacement:"Opera Mini"},{regex:"(Opera Mini)/att/(\\d+)\\.(\\d+)",family_replacement:"Opera Mini"},{regex:"(Opera)/9.80.*Version/(\\d+)\\.(\\d+)(?:\\.(\\d+))?",family_replacement:"Opera"},{regex:"(webOSBrowser)/(\\d+)\\.(\\d+)",family_replacement:"webOS"},{regex:"(webOS)/(\\d+)\\.(\\d+)",family_replacement:"webOS"},{regex:"(wOSBrowser).+TouchPad/(\\d+)\\.(\\d+)",family_replacement:"webOS TouchPad"},{regex:"(luakit)",family_replacement:"LuaKit",other:!0},{regex:"(Lightning)/(\\d+)\\.(\\d+)([ab]?\\d+[a-z]*)",family_replacement:"Lightning",other:!0},{regex:"(Firefox)/(\\d+)\\.(\\d+)\\.(\\d+(?:pre)?) \\(Swiftfox\\)",family_replacement:"Swiftfox",other:!0},{regex:"(Firefox)/(\\d+)\\.(\\d+)([ab]\\d+[a-z]*)? \\(Swiftfox\\)",family_replacement:"Swiftfox",other:!0},{regex:"rekonq",family_replacement:"Rekonq",other:!0},{regex:"(conkeror|Conkeror)/(\\d+)\\.(\\d+)\\.?(\\d+)?",family_replacement:"Conkeror",other:!0},{regex:"(konqueror)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Konqueror",other:!0},{regex:"(WeTab)-Browser",family_replacement:"WeTab",other:!0},{regex:"(Comodo_Dragon)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Comodo Dragon",other:!0},{regex:"(YottaaMonitor)",family_replacement:"Yottaa Monitor",other:!0},{regex:"(Kindle)/(\\d+)\\.(\\d+)",family_replacement:"Kindle"},{regex:"(Symphony) (\\d+).(\\d+)",family_replacement:"Symphony",other:!0},{regex:"Minimo",family_replacement:"Minimo",other:!0},{regex:"(CrMo)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Chrome Mobile"},{regex:"(CriOS)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Chrome Mobile iOS"},{regex:"(Chrome)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+) Mobile",family_replacement:"Chrome Mobile"},{regex:"(chromeframe)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Chrome Frame"},{regex:"(UC Browser)(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"UC Browser",other:!0},{regex:"(SLP Browser)/(\\d+)\\.(\\d+)",family_replacement:"Tizen Browser",other:!0},{regex:"(Epiphany)/(\\d+)\\.(\\d+).(\\d+)",family_replacement:"Epiphany",other:!0},{regex:"(SE 2\\.X) MetaSr (\\d+)\\.(\\d+)",family_replacement:"Sogou Explorer",other:!0},{regex:"(Pingdom.com_bot_version_)(\\d+)\\.(\\d+)",family_replacement:"PingdomBot",other:!0},{regex:"(facebookexternalhit)/(\\d+)\\.(\\d+)",family_replacement:"FacebookBot"},{regex:"(Twitterbot)/(\\d+)\\.(\\d+)",family_replacement:"TwitterBot"},{regex:"(AdobeAIR|Chromium|FireWeb|Jasmine|ANTGalio|Midori|Fresco|Lobo|PaleMoon|Maxthon|Lynx|OmniWeb|Dillo|Camino|Demeter|Fluid|Fennec|Shiira|Sunrise|Chrome|Flock|Netscape|Lunascape|WebPilot|NetFront|Netfront|Konqueror|SeaMonkey|Kazehakase|Vienna|Iceape|Iceweasel|IceWeasel|Iron|K-Meleon|Sleipnir|Galeon|GranParadiso|Opera Mini|iCab|NetNewsWire|ThunderBrowse|Iron|Iris|UP\\.Browser|Bunjaloo|Google Earth|Raven for Mac)/(\\d+)\\.(\\d+)\\.(\\d+)"},{regex:"(Bolt|Jasmine|IceCat|Skyfire|Midori|Maxthon|Lynx|Arora|IBrowse|Dillo|Camino|Shiira|Fennec|Phoenix|Chrome|Flock|Netscape|Lunascape|Epiphany|WebPilot|Opera Mini|Opera|NetFront|Netfront|Konqueror|Googlebot|SeaMonkey|Kazehakase|Vienna|Iceape|Iceweasel|IceWeasel|Iron|K-Meleon|Sleipnir|Galeon|GranParadiso|iCab|NetNewsWire|Iron|Space Bison|Stainless|Orca|Dolfin|BOLT|Minimo|Tizen Browser|Polaris)/(\\d+)\\.(\\d+)"},{regex:"(iRider|Crazy Browser|SkipStone|iCab|Lunascape|Sleipnir|Maemo Browser) (\\d+)\\.(\\d+)\\.(\\d+)"},{regex:"(iCab|Lunascape|Opera|Android|Jasmine|Polaris|BREW) (\\d+)\\.(\\d+)\\.?(\\d+)?"},{regex:"(MSIE) (\\d+)\\.(\\d+).*XBLWP7",family_replacement:"IE Large Screen"},{regex:"(Firefox)/(\\d+)\\.(\\d+)\\.(\\d+)"},{regex:"(Firefox)/(\\d+)\\.(\\d+)(pre|[ab]\\d+[a-z]*)?"},{regex:"(Obigo)InternetBrowser",other:!0},{regex:"(Obigo)\\-Browser",other:!0},{regex:"(Obigo|OBIGO)[^\\d]*(\\d+)(?:.(\\d+))?",other:!0},{regex:"(MAXTHON|Maxthon) (\\d+)\\.(\\d+)",family_replacement:"Maxthon",other:!0},{regex:"(Maxthon|MyIE2|Uzbl|Shiira)",v1_replacement:"0",other:!0},{regex:"(PLAYSTATION) (\\d+)",family_replacement:"PlayStation",manufacturer:"Sony"},{regex:"(PlayStation Portable)[^\\d]+(\\d+).(\\d+)",manufacturer:"Sony"},{regex:"(BrowseX) \\((\\d+)\\.(\\d+)\\.(\\d+)",other:!0},{regex:"(POLARIS)/(\\d+)\\.(\\d+)",family_replacement:"Polaris",other:!0},{regex:"(Embider)/(\\d+)\\.(\\d+)",family_replacement:"Polaris",other:!0},{regex:"(BonEcho)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Bon Echo",other:!0},{regex:"(AvantGo) (\\d+).(\\d+)",other:!0},{regex:"(Avant)",v1_replacement:"1",other:!0},{regex:"(OmniWeb)/v(\\d+)\\.(\\d+)",other:!0},{regex:"(Blazer)/(\\d+)\\.(\\d+)",family_replacement:"Palm Blazer",manufacturer:"Palm"},{regex:"(Pre)/(\\d+)\\.(\\d+)",family_replacement:"Palm Pre",manufacturer:"Palm"},{regex:"(Links) \\((\\d+)\\.(\\d+)",other:!0},{regex:"(QtWeb) Internet Browser/(\\d+)\\.(\\d+)",other:!0},{regex:"(Silk)/(\\d+)\\.(\\d+)(?:\\.([0-9\\-]+))?",other:!0,tablet:!0},{regex:"(AppleWebKit)/(\\d+)\\.?(\\d+)?\\+ .* Version/\\d+\\.\\d+.\\d+ Safari/",family_replacement:"WebKit Nightly"},{regex:"(Version)/(\\d+)\\.(\\d+)(?:\\.(\\d+))?.*Safari/",family_replacement:"Safari"},{regex:"(Safari)/\\d+"},{regex:"(OLPC)/Update(\\d+)\\.(\\d+)",other:!0},{regex:"(OLPC)/Update()\\.(\\d+)",v1_replacement:"0",other:!0},{regex:"(SEMC\\-Browser)/(\\d+)\\.(\\d+)",other:!0},{regex:"(Teleca)",family_replacement:"Teleca Browser",other:!0},{regex:"Trident(.*)rv.(\\d+)\\.(\\d+)",family_replacement:"IE"},{regex:"(MSIE) (\\d+)\\.(\\d+)",family_replacement:"IE"}],os_parsers:[{regex:"(Windows (?:NT 5\\.2|NT 5\\.1))",os_replacement:"Windows XP"},{regex:"(XBLWP7)",os_replacement:"Windows Phone OS"},{regex:"(Windows NT 6\\.1)",os_replacement:"Windows 7"},{regex:"(Windows NT 6\\.0)",os_replacement:"Windows Vista"},{regex:"(Windows 98|Windows XP|Windows ME|Windows 95|Windows CE|Windows 7|Windows NT 4\\.0|Windows Vista|Windows 2000)"},{regex:"(Windows NT 6\\.2)",os_replacement:"Windows 8"},{regex:"(Windows NT 6\\.3)",os_replacement:"Windows 8.1"},{regex:"(Windows NT 10\\.0)",os_replacement:"Windows 10"},{regex:"(WinNT4.0)",os_replacement:"Windows NT 4.0"},{regex:"(Win98)",os_replacement:"Windows 98"},{regex:"(Tizen)/(\\d+)\\.(\\d+)",other:!0},{regex:"(Mac OS X) (\\d+)[_.](\\d+)(?:[_.](\\d+))?",manufacturer:"Apple"},{regex:"(?:PPC|Intel) (Mac OS X)",manufacturer:"Apple"},{regex:"(CPU OS|iPhone OS) (\\d+)_(\\d+)(?:_(\\d+))?",os_replacement:"iOS",manufacturer:"Apple"},{regex:"(iPhone|iPad|iPod).*Mac OS X.*Version/(\\d+)\\.(\\d+)",os_replacement:"iOS",manufacturer:"Apple"},{regex:"(CrOS) [a-z0-9_]+ (\\d+)\\.(\\d+)(?:\\.(\\d+))?",os_replacement:"Chrome OS"},{regex:"(Debian)-(\\d+)\\.(\\d+)\\.(\\d+)(?:\\.(\\d+))?",other:!0},{regex:"(Linux Mint)(?:/(\\d+))?",other:!0},{regex:"(Mandriva)(?: Linux)?/(\\d+)\\.(\\d+)\\.(\\d+)(?:\\.(\\d+))?",other:!0},{regex:"(Symbian[Oo][Ss])/(\\d+)\\.(\\d+)",os_replacement:"Symbian OS"},{regex:"(Symbian/3).+NokiaBrowser/7\\.3",os_replacement:"Symbian^3 Anna"},{regex:"(Symbian/3).+NokiaBrowser/7\\.4",os_replacement:"Symbian^3 Belle"},{regex:"(Symbian/3)",os_replacement:"Symbian^3"},{regex:"(Series 60|SymbOS|S60)",os_replacement:"Symbian OS"},{regex:"(MeeGo)",other:!0},{regex:"Symbian [Oo][Ss]",os_replacement:"Symbian OS"},{regex:"(Black[Bb]erry)[0-9a-z]+/(\\d+)\\.(\\d+)\\.(\\d+)(?:\\.(\\d+))?",os_replacement:"BlackBerry OS",manufacturer:"RIM"},{regex:"(Black[Bb]erry).+Version/(\\d+)\\.(\\d+)\\.(\\d+)(?:\\.(\\d+))?",os_replacement:"BlackBerry OS",manufacturer:"RIM"},{regex:"(RIM Tablet OS) (\\d+)\\.(\\d+)\\.(\\d+)",os_replacement:"BlackBerry Tablet OS",tablet:!0,manufacturer:"RIM"},{regex:"(Play[Bb]ook)",os_replacement:"BlackBerry Tablet OS",tablet:!0,manufacturer:"RIM"},{regex:"(Black[Bb]erry)",os_replacement:"Blackberry OS",manufacturer:"RIM"},{regex:"(webOS|hpwOS)/(\\d+)\\.(\\d+)(?:\\.(\\d+))?",os_replacement:"webOS"},{regex:"(SUSE|Fedora|Red Hat|PCLinuxOS)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)",other:!0},{regex:"(SUSE|Fedora|Red Hat|Puppy|PCLinuxOS|CentOS)/(\\d+)\\.(\\d+)\\.(\\d+)",other:!0},{regex:"(Ubuntu|Kindle|Bada|Lubuntu|BackTrack|Red Hat|Slackware)/(\\d+)\\.(\\d+)"},{regex:"(Windows|OpenBSD|FreeBSD|NetBSD|Ubuntu|Kubuntu|Android|Arch Linux|CentOS|WeTab|Slackware)"},{regex:"(Linux|BSD)",other:!0}],mobile_os_families:["Windows Phone 6.5","Windows CE","Symbian OS"],device_parsers:[{regex:"HTC ([A-Z][a-z0-9]+) Build",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC ([A-Z][a-z0-9 ]+) \\d+\\.\\d+\\.\\d+\\.\\d+",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC_Touch_([A-Za-z0-9]+)",device_replacement:"HTC Touch ($1)",manufacturer:"HTC"},{regex:"USCCHTC(\\d+)",device_replacement:"HTC $1 (US Cellular)",manufacturer:"HTC"},{regex:"Sprint APA(9292)",device_replacement:"HTC $1 (Sprint)",manufacturer:"HTC"},{regex:"(ADR[A-Za-z0-9]+)",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"(HTC)",manufacturer:"HTC"},{regex:"(PlayBook).+RIM Tablet OS",device_replacement:"Blackberry Playbook",tablet:!0,manufacturer:"RIM"},{regex:"(Pre)/(\\d+)\\.(\\d+)",device_replacement:"Palm Pre",manufacturer:"Palm"},{regex:"(Pixi)/(\\d+)\\.(\\d+)",device_replacement:"Palm Pixi",manufacturer:"Palm"},{regex:"(Touchpad)/(\\d+)\\.(\\d+)",device_replacement:"HP Touchpad",manufacturer:"HP"},{regex:"HPiPAQ([A-Za-z0-9]+)/(\\d+).(\\d+)",device_replacement:"HP iPAQ $1",manufacturer:"HP"},{regex:"webOS.*(P160UNA)/(\\d+).(\\d+)",device_replacement:"HP Veer",manufacturer:"HP"},{regex:"(Silk)/(\\d+)\\.(\\d+)(?:\\.([0-9\\-]+))?",device_replacement:"Kindle Fire",tablet:!0,manufacturer:"Amazon"},{regex:"acer_([A-Za-z0-9]+)_",device_replacement:"Acer $1",manufacturer:"Acer"},{regex:"acer_([A-Za-z0-9]+)_",device_replacement:"Acer $1",manufacturer:"Acer"},{regex:"Amoi\\-([A-Za-z0-9]+)",device_replacement:"Amoi $1",other:!0,manufacturer:"Amoi"},{regex:"AMOI\\-([A-Za-z0-9]+)",device_replacement:"Amoi $1",other:!0,manufacturer:"Amoi"},{regex:"Asus\\-([A-Za-z0-9]+)",device_replacement:"Asus $1",manufacturer:"Asus"},{regex:"ASUS\\-([A-Za-z0-9]+)",device_replacement:"Asus $1",manufacturer:"Asus"},{regex:"BIRD\\-([A-Za-z0-9]+)",device_replacement:"Bird $1",other:!0},{regex:"BIRD\\.([A-Za-z0-9]+)",device_replacement:"Bird $1",other:!0},{regex:"BIRD ([A-Za-z0-9]+)",device_replacement:"Bird $1",other:!0},{regex:"Dell ([A-Za-z0-9]+)",device_replacement:"Dell $1",manufacturer:"Dell"},{regex:"DoCoMo/2\\.0 ([A-Za-z0-9]+)",device_replacement:"DoCoMo $1",other:!0},{regex:"([A-Za-z0-9]+)\\_W\\;FOMA",device_replacement:"DoCoMo $1",other:!0},{regex:"([A-Za-z0-9]+)\\;FOMA",device_replacement:"DoCoMo $1",other:!0},{regex:"vodafone([A-Za-z0-9]+)",device_replacement:"Huawei Vodafone $1",other:!0},{regex:"i\\-mate ([A-Za-z0-9]+)",device_replacement:"i-mate $1",other:!0},{regex:"Kyocera\\-([A-Za-z0-9]+)",device_replacement:"Kyocera $1",other:!0},{regex:"KWC\\-([A-Za-z0-9]+)",device_replacement:"Kyocera $1",other:!0},{regex:"Lenovo\\-([A-Za-z0-9]+)",device_replacement:"Lenovo $1",manufacturer:"Lenovo"},{regex:"Lenovo\\_([A-Za-z0-9]+)",device_replacement:"Lenovo $1",manufacturer:"Levovo"},{regex:"LG/([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LG-LG([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LGE-LG([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LGE VX([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LG ([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LGE LG\\-AX([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LG\\-([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LGE\\-([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LG([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"(KIN)\\.One (\\d+)\\.(\\d+)",device_replacement:"Microsoft $1"},{regex:"(KIN)\\.Two (\\d+)\\.(\\d+)",device_replacement:"Microsoft $1"},{regex:"(hiptop|avantgo|plucker|xiino|blazer|elaine|up.browser|up.link|mmp|smartphone|midp|wap|vodafone|o2|pocket|mobile|pda)",device_replacement:"Generic Smartphone"},{regex:"^(1207|3gso|4thp|501i|502i|503i|504i|505i|506i|6310|6590|770s|802s|a wa|acer|acs\\-|airn|alav|asus|attw|au\\-m|aur |aus |abac|acoo|aiko|alco|alca|amoi|anex|anny|anyw|aptu|arch|argo|bell|bird|bw\\-n|bw\\-u|beck|benq|bilb|blac|c55/|cdm\\-|chtm|capi|comp|cond|craw|dall|dbte|dc\\-s|dica|ds\\-d|ds12|dait|devi|dmob|doco|dopo|el49|erk0|esl8|ez40|ez60|ez70|ezos|ezze|elai|emul|eric|ezwa|fake|fly\\-|fly\\_|g\\-mo|g1 u|g560|gf\\-5|grun|gene|go.w|good|grad|hcit|hd\\-m|hd\\-p|hd\\-t|hei\\-|hp i|hpip|hs\\-c|htc |htc\\-|htca|htcg)",device_replacement:"Generic Feature Phone"},{regex:"^(htcp|htcs|htct|htc\\_|haie|hita|huaw|hutc|i\\-20|i\\-go|i\\-ma|i230|iac|iac\\-|iac/|ig01|im1k|inno|iris|jata|java|kddi|kgt|kgt/|kpt |kwc\\-|klon|lexi|lg g|lg\\-a|lg\\-b|lg\\-c|lg\\-d|lg\\-f|lg\\-g|lg\\-k|lg\\-l|lg\\-m|lg\\-o|lg\\-p|lg\\-s|lg\\-t|lg\\-u|lg\\-w|lg/k|lg/l|lg/u|lg50|lg54|lge\\-|lge/|lynx|leno|m1\\-w|m3ga|m50/|maui|mc01|mc21|mcca|medi|meri|mio8|mioa|mo01|mo02|mode|modo|mot |mot\\-|mt50|mtp1|mtv |mate|maxo|merc|mits|mobi|motv|mozz|n100|n101|n102|n202|n203|n300|n302|n500|n502|n505|n700|n701|n710|nec\\-|nem\\-|newg|neon)",device_replacement:"Generic Feature Phone"},{regex:"^(netf|noki|nzph|o2 x|o2\\-x|opwv|owg1|opti|oran|ot\\-s|p800|pand|pg\\-1|pg\\-2|pg\\-3|pg\\-6|pg\\-8|pg\\-c|pg13|phil|pn\\-2|pt\\-g|palm|pana|pire|pock|pose|psio|qa\\-a|qc\\-2|qc\\-3|qc\\-5|qc\\-7|qc07|qc12|qc21|qc32|qc60|qci\\-|qwap|qtek|r380|r600|raks|rim9|rove|s55/|sage|sams|sc01|sch\\-|scp\\-|sdk/|se47|sec\\-|sec0|sec1|semc|sgh\\-|shar|sie\\-|sk\\-0|sl45|slid|smb3|smt5|sp01|sph\\-|spv |spv\\-|sy01|samm|sany|sava|scoo|send|siem|smar|smit|soft|sony|t\\-mo|t218|t250|t600|t610|t618|tcl\\-|tdg\\-|telm|tim\\-|ts70|tsm\\-|tsm3|tsm5|tx\\-9|tagt)",device_replacement:"Generic Feature Phone"},{regex:"^(talk|teli|topl|tosh|up.b|upg1|utst|v400|v750|veri|vk\\-v|vk40|vk50|vk52|vk53|vm40|vx98|virg|vite|voda|vulc|w3c |w3c\\-|wapj|wapp|wapu|wapm|wig |wapi|wapr|wapv|wapy|wapa|waps|wapt|winc|winw|wonu|x700|xda2|xdag|yas\\-|your|zte\\-|zeto|aste|audi|avan|blaz|brew|brvw|bumb|ccwa|cell|cldc|cmd\\-|dang|eml2|fetc|hipt|http|ibro|idea|ikom|ipaq|jbro|jemu|jigs|keji|kyoc|kyok|libw|m\\-cr|midp|mmef|moto|mwbp|mywa|newt|nok6|o2im|pant|pdxg|play|pluc|port|prox|rozo|sama|seri|smal|symb|treo|upsi|vx52|vx53|vx60|vx61|vx70|vx80|vx81|vx83|vx85|wap\\-|webc|whit|wmlb|xda\\-|xda\\_)",device_replacement:"Generic Feature Phone"},{regex:"(bot|borg|google(^tv)|yahoo|slurp|msnbot|msrbot|openbot|archiver|netresearch|lycos|scooter|altavista|teoma|gigabot|baiduspider|blitzbot|oegp|charlotte|furlbot|http%20client|polybot|htdig|ichiro|mogimogi|larbin|pompos|scrubby|searchsight|seekbot|semanticdiscovery|silk|snappy|speedy|spider|voila|vortex|voyager|zao|zeal|fast\\-webcrawler|converacrawler|dataparksearch|findlinks)",device_replacement:"Spider"}],mobile_browser_families:["Firefox Mobile","Opera Mobile","Opera Mini","Mobile Safari","webOS","IE Mobile","Playstation Portable","Nokia","Blackberry","Palm","Silk","Android","Maemo","Obigo","Netfront","AvantGo","Teleca","SEMC-Browser","Bolt","Iris","UP.Browser","Symphony","Minimo","Bunjaloo","Jasmine","Dolfin","Polaris","BREW","Chrome Mobile","Chrome Mobile iOS","UC Browser","Tizen Browser"]};e.parsers=["device_parsers","browser_parsers","os_parsers","mobile_os_families","mobile_browser_families"],e.types=["browser","os","device"],e.regexes=t||function(){var t={};return e.parsers.map(function(e){t[e]=[]}),t}(),e.families=function(){var t={};return e.types.map(function(e){t[e]=[]}),t}();var i=Array.prototype,n=(Object.prototype,Function.prototype,i.forEach);i.indexOf;var o=function(e,t){for(var i={},n=0;t.length>n&&!(i=t[n](e));n++);return i},a=function(e,t){r(e,function(e){r(t,function(t){delete e[t]})})},r=forEach=function(e,t,i){if(null!=e)if(n&&e.forEach===n)e.forEach(t,i);else if(e.length===+e.length)for(var o=0,a=e.length;a>o;o++)t.call(i,e[o],o,e);else for(var r in e)_.has(e,r)&&t.call(i,e[r],r,e)},s=function(e){return!(!e||void 0===e||null==e)},l=function(e){var t="";return e=e||{},s(e)&&s(e.major)&&(t+=e.major,s(e.minor)&&(t+="."+e.minor,s(e.patch)&&(t+="."+e.patch))),t},h=function(e){e=e||{};var t=l(e);return t&&(t=" "+t),e&&s(e.family)?e.family+t:""
};return e.parse=function(t){var i=function(t){return e.regexes[t+"_parsers"].map(function(e){function i(t){var i=t.match(n);if(!i)return null;var r={};return r.family=(o?o.replace("$1",i[1]):i[1])||"other",r.major=parseInt(a?a:i[2])||null,r.minor=i[3]?parseInt(i[3]):null,r.patch=i[4]?parseInt(i[4]):null,r.tablet=e.tablet,r.man=e.manufacturer||null,r}var n=RegExp(e.regex),o=e[("browser"===t?"family":t)+"_replacement"],a=e.major_version_replacement;return i})},n=function(){},r=i("browser"),c=i("os"),p=i("device"),f=new n;f.source=t,f.browser=o(t,r),s(f.browser)?(f.browser.name=h(f.browser),f.browser.version=l(f.browser)):f.browser={},f.os=o(t,c),s(f.os)?(f.os.name=h(f.os),f.os.version=l(f.os)):f.os={},f.device=o(t,p),s(f.device)?(f.device.name=h(f.device),f.device.version=l(f.device)):f.device={tablet:!1,family:"Other"};var u={};return e.regexes.mobile_browser_families.map(function(e){u[e]=!0}),e.regexes.mobile_os_families.map(function(e){u[e]=!0}),f.device.type="Spider"===f.browser.family?"Spider":f.browser.tablet||f.os.tablet||f.device.tablet?"Tablet":u.hasOwnProperty(f.browser.family)?"Mobile":"Desktop",f.device.manufacturer=f.browser.man||f.os.man||f.device.man||null,a([f.browser,f.os,f.device],["tablet","man"]),f},e}();"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports.detect=t):e.detect=t,"function"==typeof define&&define.amd&&define(function(){return t})}(window),window.BMap=bO,bO.Map=aO,bO.MapType=bE,bO.Point=bl,bO.Pixel=aM,bO.Size=af,bO.Bounds=a1,bO.TileLayer=p,bO.Copyright=V,bO.Projection=bO.Project=az,bO.Overlay=aT,bO.Label=M,bO.Marker=K,bO.Icon=C,bO.Polyline=j,bO.PolylineMultipart=ae,bO.Polygon=bs,bO.Rectangle=bh,bO.InfoWindow=a2,bO.Circle=a,bO.Control=bu,bO.NavigationControl=B,bO.CopyrightControl=Q,bO.ScaleControl=a0,bO.MapTypeControl=ak,bO.DistanceTool=aX,bO.ContextMenu=bK,bO.MenuItem=aG,bO.OperationMask=g,bO.Animation=k,bO.Transitions=W}();
;!function(e){var n=50,t=25,a={},l=[].slice,r={},o={},c=function(e,l,c,f){function i(){var e=+new Date;do{var a=s.shift();try{c&&c.call(f,a.type,a.data)}catch(l){}}while(s.length&&+new Date-e<n);s.length>0&&setTimeout(arguments.callee,t)}"string"!=typeof l&&(f=c,c=l,l="overall");var u=r[e];u||(u=r[e]={}),u[l]=u[l]||[],u[l].push({func:c,context:f||a});var h=o[e],s=[];if(h){if("overall"===l)for(var g in h)s=s.concat(h[g]);else h[l]&&h[l].length&&(s=h[l]);s.length&&i()}},f=function(e,n,t,l){var r=function(){return a.off(e,n,r),t.apply(l||a,arguments)};c(e,n,r,l)},i=function(e,a,c){if(r[e]&&r[e][a]&&r[e][a].length||r[e]&&r[e].overall){var f=r[e].overall,i=r[e][a]||[];f&&(i=f.concat(i));for(var u=[],h=i.length;h--;)u.push({handler:i[h],args:l.call(arguments,1)});!function(){var e=+new Date;do{var a=u.shift(),l=a.handler;l&&l.func&&l.func.apply(l.context,a.args)}while(u.length&&+new Date-e<n);u.length>0&&setTimeout(arguments.callee,t)}()}else{var s=o[e]||(o[e]={}),i=s[a]||(s[a]=[]);c&&i.push({type:a,data:c})}},u=function(e,n,t,l){if(l=l||a,r[e]&&r[e][n]&&r[e][n].length)for(var o,c=r[e][n],f=c.length;f--;)o=c[f],o.func===t&&o.context===l&&c.splice(f,1)};a.on=c,a.once=f,a.trigger=i,a.off=u,e.listener=e.listener||a}(window);
;!function(window){function geoToPoint(e){var o=e.split("|");if("1"===o[0]){var a=o[1].split(","),t=new BMap.Point(parseFloat(a[0]),parseFloat(a[1]));return t}}function getParam(e){if(e.indexOf("?")>-1)var o=e.slice(e.indexOf("?")+1);else{if(!(e.indexOf("#")>-1))return;var o=e.slice(e.indexOf("#")+1)}if(""!=o){for(var a={},t=o.split("&"),n=0;n<t.length;n++){var l=t[n].split("=");if(l[1]){var i=l[1].indexOf("#");l[1]=i>-1?l[1].slice(0,i):l[1],a[l[0]]=l[1]}}return a}}function sendEarthClickStat(e){addStat("earth."+e.type,"click",{da_e_name:"pcmapearth"}),e.opMethod&&addStat("earth."+e.type+"."+e.opMethod,"click",{da_e_name:"pcmapearth"})}function addMapCtrls(e){window.stdMapCtrl=new BMap.NavigationControl(isPrint?{from:"MAP_INDEX",type:BMAP_NAVIGATION_CONTROL_ZOOM}:{from:"MAP_INDEX",offset:new BMap.Size(10,20),type:BMAP_NAVIGATION_CONTROL_LARGE,anchor:BMAP_ANCHOR_BOTTOM_RIGHT}),window.stdMapCtrl._cZIndex="10",e.addControl(window.stdMapCtrl),e.addEventListener("onmaptypechange",function(e){var o=e.mapType;o===BMAP_EARTH_MAP?(this.removeControl(window.scaleCtrl),window.fullScreenCtrl&&window.fullScreenCtrl.exitFull(!0),window.allControlsBundleTool&&window.allControlsBundleTool.hide(),window.earthTools&&window.earthTools.show()):(this.addControl(window.scaleCtrl),window.allControlsBundleTool&&window.allControlsBundleTool.show(),window.earthTools&&window.earthTools.hide())}),window.maptypeCtrl=new BMap.MapTypeControl({offset:new BMap.Size(9,100),anchor:BMAP_ANCHOR_TOP_RIGHT}),e.addControl(window.maptypeCtrl),isPrint||(window.scaleCtrl=new BMap.ScaleControl({offset:new BMap.Size(5,20),printable:!0}),e.addControl(window.scaleCtrl),window.stopEarthClockAnimation=function(){var o=window.earthTools;e.getMapType()===BMAP_EARTH_MAP&&o&&(o.isEarthClockOpened()||o.isEarthClockOpening())&&o.stopEarth(!0)})}var PanoLoading=require("pano:widget/module/PanoLoading/PanoLoading.js"),isPrint=window.isPrint=location.href.indexOf("pw=2")>0;if(window.BMAP_TYPE_HYBIRD="B_SATELLITE_STREET",BMap.PolylineTItem=BMap.DistanceTool,!isPrint){var mc=document.getElementById("MapHolder"),mapInfoTab=document.getElementById("MapInfoTab"),mi=document.getElementById("MapInfo"),mch=document.body.clientHeight-98;mch=0>mch?0:mch,mc.style.height=mch+"px",mi.style.height=mch+"px",mapInfoTab.style.top=parseInt((mch-64)/2)+"px",PanoLoading.createMask(getParam(location.href),location.href)}var mapType=BMAP_NORMAL_MAP,param=getParam(location.href);param&&(param.tn||param.mt)&&(mapType=param.tn||param.mt);var map=window.map=new BMap.Map("MapHolder",{coordType:BMAP_COORD_MERCATOR,zoomLevelMin:3,mapType:mapType});map.enableLoadTiles=!0,map.enableKeyboard(),map.enableScrollWheelZoom(),map.enableInertialDragging(),map.enableContinuousZoom();var COUNTRY_LEVEL=4,point=new BMap.Point(12957320,4825100),level=COUNTRY_LEVEL,cityType=[4,11,12,15];if(null!=window._OLR&&(eval("var json ="+window._OLR.index),window._OLR.hot_city=json.hot_city,point=geoToPoint(json.content.geo),level=cityType[json.content.city_type]),param&&param.c){var p=param.c.split(",");if(2==p.length){var lng=parseFloat(p[0]),lat=parseFloat(p[1]);"number"==typeof lng&&"number"==typeof lat&&(point=new BMap.Point(lng,lat))}param.l&&"number"==typeof parseInt(param.l)&&(level=parseInt(param.l))}window.corePerfMonitor&&map.addEventListener("tilesloaded",window.corePerfMonitor.onTilesLoad),map.addEventListener("earthload",function(e){for(var o=e.earth,a=["rotatecwclick","rotateccwclick","compassclick","zoominclick","zoomoutclick","tiltmsdown","ontiltclick","earthkeyboardmove","earthkeyboardzoomin","earthkeyboardzoomout","earthdragend","earthrightdragend","earthwheelzoom","earthdblclickzoom","onearthrightdblclickzoom"],t=0;t<a.length;t++)o.on(a[t],sendEarthClickStat);o.on("fpsdata_ready",function(e){var o={};o.z_fps=e.fps,o.z_fps_higher=e.fpsH,alog("cus.fire","time",o)}),o.on("earthtilesloaded",function(e){var a={};a.z_earth_init_time=e.initTime,a.z_earth_tilesload_time=e.loadTime,alog("cus.fire","time",a),o.off("earthtilesloaded",arguments.callee)}),o.on("layertilesload",function(e){var a={};a.z_earth_layerload_time=e.layersLoadTime,alog("cus.fire","time",a),o.off("layertilesload",arguments.callee)}),o.on("earthlabelloaded",function(e){var a={};a.z_earth_labelload_time=e.loadTime,alog("cus.fire","time",a),o.off("earthlabelloaded",arguments.callee)}),o.on("webglcontextlost",function(){alog("cus.fire","count","z_webgl_context_lost")}),o.on("webglcontextrestored",function(){alog("cus.fire","count","z_webgl_context_restored")}),o.on("onsatelayerloaderror",function(){alog("cus.fire","count","z_satelayer_load_error")}),o.on("onstreetlayerloaderror",function(){alog("cus.fire","count","z_streetlayer_load_error")}),o.on("tilemodelcache_full",function(e){var o={};o.z_tilemodelcache_usage=1e3*e.cacheUsage,alog("cus.fire","time",o),alog("cus.fire","count","z_tilemodelcache_full")})}),map.centerAndZoom(point,level),addMapCtrls(map),require.async(["common:widget/ui/tangram/tangram.js","common:widget/ui/stat/statCode.js","common:widget/ui/init/init.js","common:widget/ui/stat/CodeStat.js"],function(e,o,a){a.init()})}(window);